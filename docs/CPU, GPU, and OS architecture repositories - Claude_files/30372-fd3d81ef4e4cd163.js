try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="c90efae4-ff12-415d-9afb-af39f15d9fbc",e._sentryDebugIdIdentifier="sentry-dbid-c90efae4-ff12-415d-9afb-af39f15d9fbc")}catch(e){}{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=Object.assign({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:anthropic-apps":!0})}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[30372],{0x224a0d05:(e,t,s)=>{s.d(t,{G:()=>a});var i=s(0x22102fd88),l=s(0x38e6572);function a(e){let{showPDFWarning:t=!1,metaData:s}=e;return(0,i.jsxs)("span",{className:"text-text-500 mb-3 mt-0.5 flex flex-wrap gap-y-2 items-start items-center text-xs",children:[(0,i.jsx)("span",{children:s}),(0,i.jsx)("span",{className:"mx-1.5 opacity-50 hidden lg:inline",children:"•"}),t?(0,i.jsx)("span",{children:(0,i.jsx)(l.A,{defaultMessage:"This PDF was converted to text due to its large size",id:"o/G2cAuU9n"})}):(0,i.jsx)("span",{children:(0,i.jsx)(l.A,{defaultMessage:"Formatting may be inconsistent from source",id:"9NeTb00/cM"})})]})}},0x53e6c5ac:(e,t,s)=>{s.d(t,{S:()=>l,d:()=>i});let i=e=>"https://docs.google.com/document/d/".concat(e),l=e=>"https://outline.ant.dev/doc/".concat(e)},0x609a9c34:(e,t,s)=>{s.d(t,{E:()=>d});var i=s(0x52e2618c),l=s(0x22102fd88),a=s(0x7422d213),r=s(0x14fe1b2a5),n=s(0xfc89b4a4);function o(){let e=(0,i._)(["",""]);return o=function(){return e},e}let d=e=>{let{hideBottomShadow:t,scrollContainerRef:s,persistedScrollToRef:i,...a}=e,r=(null==i?void 0:i.current)!==void 0,o=(0,n.useRef)(null),d=s||o,u=(0,n.useCallback)(()=>{let e=d.current;if(e&&!t){let{scrollTop:t,offsetHeight:s,scrollHeight:l}=e;t+s>=l?e.classList.remove("has-bottom-scroll"):e.classList.add("has-bottom-scroll"),r&&0!==t&&Math.abs(t-i.current)>10&&(i.current=t)}},[t,d,r,i]);return u(),(0,n.useEffect)(()=>{let e=d.current;requestAnimationFrame(()=>{r&&e&&(null==e||e.scrollTo({top:i.current,behavior:"instant"}))})},[d,r,i]),(0,n.useEffect)(()=>{let e=d.current;return null==e||e.addEventListener("scroll",u),()=>null==e?void 0:e.removeEventListener("scroll",u)},[u,d]),(0,l.jsx)(c,{ref:d,...a,children:a.children})},c=r.J.div(o(),a.M)},0x6389c291:(e,t,s)=>{s.d(t,{mq:()=>a,t1:()=>n,wC:()=>o});var i=s(0x22102fd88),l=s(0xfc89b4a4),a=function(e){return e.IDLE="IDLE",e.DRAGGING_OFF_TARGET="DRAGGING_OFF_TARGET",e.DRAGGING_ON_TARGET="DRAGGING_ON_TARGET",e.DROPPED="DROPPED",e}({});let r=(0,l.createContext)(void 0),n=()=>{let e=(0,l.useContext)(r);if(!e)throw Error("useDropZone must be used within a DropZoneProvider");return e},o=e=>{let{onDrop:t,children:s,className:a,disabled:n=!1,enableScreenDrop:o=!1}=e,[d,c]=(0,l.useState)("IDLE"),u=l.useRef(null),x=(0,l.useCallback)(e=>{var t;e.preventDefault(),e.stopPropagation(),(null==(t=u.current)?void 0:t.contains(e.target))?c("DRAGGING_ON_TARGET"):c("DRAGGING_OFF_TARGET")},[]),h=(0,l.useCallback)(e=>{var t;e.preventDefault(),e.stopPropagation(),(null==(t=u.current)?void 0:t.contains(e.relatedTarget))||e.target!==document.body&&null!==e.relatedTarget||c("IDLE")},[]),p=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),t(e),c("DROPPED"),setTimeout(()=>{c("IDLE")},500)},[t]),f=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),p(e),c("DROPPED"),setTimeout(()=>{c("IDLE")},500)},[p]),m=(0,l.useCallback)(e=>{var t;(null==(t=u.current)?void 0:t.contains(e.target))||(o?p(e):(e.preventDefault(),c("IDLE")))},[o,p]);return(0,l.useEffect)(()=>(n?c("IDLE"):(document.body.addEventListener("dragover",x),document.body.addEventListener("dragleave",h),document.body.addEventListener("drop",m)),()=>{document.body.removeEventListener("dragover",x),document.body.removeEventListener("dragleave",h),document.body.removeEventListener("drop",m)}),[x,h,m,f,n]),(0,i.jsx)(r.Provider,{value:{dragState:d,setDragState:c},children:(0,i.jsx)("div",{ref:u,className:a,onDrop:n?void 0:f,children:s})})}},0x865afcc2:(e,t,s)=>{s.d(t,{$:()=>r});var i=s(0x22102fd88),l=s(0xa6a34c14),a=s(0x1a1f6dda6);let r=e=>{let{icon:t,title:s,subtitles:r,tag:n,disabled:o,url:d,isError:c,handleClick:u}=e,x=(0,a.A)("flex flex-row gap-4 items-center justify-between rounded-md shrink-0 h-[2rem] px-1.5 mx-0.5 w-full min-w-0",!o&&(u||d)?"cursor-pointer hover:bg-bg-200":"cursor-default"),h=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex flex-row items-center gap-2 min-w-0",children:[(!!t||c)&&(0,i.jsx)("div",{className:"h-5 w-5 flex items-center justify-center shrink-0",children:c?(0,i.jsx)(l.N,{size:12,className:"text-danger-000"}):t}),(0,i.jsx)("p",{className:(0,a.A)("relative text-[0.875rem] whitespace-nowrap overflow-hidden text-ellipsis shrink",c?"text-text-500":"text-text-000"),children:s}),!!(null==r?void 0:r.length)&&r.map((e,t)=>(0,i.jsx)("p",{className:"relative bottom-[1px] text-[0.75rem] text-text-500 line-clamp-1 shrink-0",children:e},t))]}),!!n&&(0,i.jsx)("div",{className:"shrink-0 flex items-center",children:(0,i.jsx)("div",{className:"text-[0.625rem] text-text-300 border-border-400 border-0.5 rounded px-1 h-[1.125rem] inline-flex items-center justify-center uppercase font-medium shrink-0",children:n})})]});return d?(0,i.jsx)("a",{target:"_blank",href:o?void 0:d,tabIndex:-1,children:(0,i.jsx)("button",{disabled:o,className:x,onClick:u,children:h})}):u?(0,i.jsx)("button",{disabled:o,className:x,onClick:u,children:h}):(0,i.jsx)("div",{className:x,children:h})}},0x8daa74e8:(e,t,s)=>{s.d(t,{T:()=>i});function i(e){let{organizationUuid:t,filePath:s}=e;return e.isShared?"/api/organizations/".concat(t,"/snapshots/").concat(e.snapshotUuid,"/wiggle/download-file?path=").concat(encodeURIComponent(s)):"/api/organizations/".concat(t,"/conversations/").concat(e.conversationUuid,"/wiggle/download-file?path=").concat(encodeURIComponent(s))}},0xae0386ed:(e,t,s)=>{s.d(t,{c:()=>i,q:()=>l});let i=e=>e?e.startsWith("Google ")?e.substring(7):e:"MCP",l=e=>{try{let t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(e){return!1}}},0x13c38b3e7:(e,t,s)=>{s.d(t,{B:()=>r,E:()=>a});var i=s(0x22102fd88),l=s(0x38e6572);function a(e){return{title:(()=>{if("html"===e.file_type){let t=e.extracted_content.match(/<title>(.*?)<\/title>/);return t?t[1]:e.file_name}return"paste.txt"===e.file_name?(0,i.jsx)(l.A,{defaultMessage:"Pasted content",id:"okKwHjIO0b"}):e.file_name})(),metaData:(()=>{let t=(0,i.jsx)(l.A,{defaultMessage:"{count, plural, one {# line} other {# lines}}",id:"AFTxeGB4qO",values:{count:e.extracted_content.split("\n").length}}),s=r(e.file_size);if("html"!==e.file_type)return(0,i.jsxs)("span",{children:[s,"\xa0",(0,i.jsx)("span",{className:"opacity-50 mx-1",children:"•"}),t]});{let s=e.file_name,l=e.file_name.match(/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:\\/\n?]+)/gim);return l&&(s=l[0].replace("www.","")),(0,i.jsxs)("span",{children:[t,"\xa0",(0,i.jsx)("span",{className:"opacity-50 mx-1",children:"•"}),s]})}})()}}function r(e){return e<1048576?(0,i.jsx)(l.A,{defaultMessage:"{size} KB",id:"/hgypvsrtJ",description:"File size in kilobytes",values:{size:(e/1024).toFixed(2)}}):(0,i.jsx)(l.A,{defaultMessage:"{size} MB",id:"8amcCGO7ya",description:"File size in megabytes",values:{size:(e/1048576).toFixed(2)}})}},0x195e308ca:(e,t,s)=>{s.d(t,{v:()=>o});var i=s(0x1b813d90),l=s(0x1334f6ecc),a=s(0xe0c26d90),r=s(0x4d9fc74e),n=s(0x1065e58a2);let o=()=>{let{initGithubAuth:e}=(0,a.nB)(),{initDriveAuth:t}=(0,l.cI)(),s=(0,r.Q)();return(l,a)=>{l===i.v8.GITHUB?e():l===i.v8.GDRIVE?t():l===i.v8.OUTLINE?(0,n.so)():l===i.v8.MCP_RESOURCES&&a&&s(a)}}},0x1a2392a8c:(e,t,s)=>{s.d(t,{Iq:()=>el,jP:()=>W,NM:()=>Q,M1:()=>er,NG:()=>en,G:()=>ec});var i=s(0x52e2618c),l=s(0x22102fd88),a=s(0x597e433e),r=s(0x6fe0a7f6),n=s(0x14fe1b2a5),o=s(0xbb84ce70),d=s(0x1b370f49d),c=s(0xb844abc8),u=s(0x1a3383306),x=s(0xa6a34c14),h=s(0x1ab362a20),p=s(0x1a1f6dda6),f=s(0x1dc411c0f),m=s(0x160045b25),g=s(0xfc89b4a4),b=s(0x38e6572),v=s(0x13c38b3e7),j=s(0x4d348f95),y=s(0xfd34bc37),w=s(0x8daa74e8),N=s(0x12c9046cd),C=s(0x14de19ae8),S=s(0x14023fbb8),k=s(0x183548b63),_=s(0x609a9c34),A=s(0x1d8fb0954),E=s(0x1e6127894),M=s(0x49fac030),I=function(e){return e.Generic="generic",e.Csv="csv",e.Excel="excel",e}({}),L=s(0x224a0d05);function D(e){let{isOpen:t,setIsOpen:s,fileName:i,fileUuid:a,filePath:r,fileSize:n}=e,o=i.includes("pasted-content")&&i.endsWith(".txt"),d=function(){let e=(0,j.useParams)(),[t]=(0,y.d)();return(null==e?void 0:e.uuid)||t}(),{activeOrganization:c}=(0,C.YL)(),u=r||(o?"/mnt/user-data/uploads/".concat(i):null),x=!!u,h=c&&d&&u?(0,w.T)({organizationUuid:c.uuid,conversationUuid:d,filePath:u,isShared:!1}):"",{data:p,isLoading:f}=(0,N.Sk)(h,{responseType:"text",enabled:t&&x&&!!h}),{data:m,isLoading:g}=function(e){let{fileUuid:t,enabled:s}=e,{activeOrganization:i}=(0,C.YL)(),l=null==i?void 0:i.uuid;return(0,N.Sk)("/api/organizations/".concat(l,"/files/").concat(t,"/content_preview"),{queryKey:[M.aI,{orgUuid:l,fileUuid:t}],enabled:!!i&&s})}({fileUuid:a,enabled:t&&!x}),D=x?f:g,z=x&&p?(0,l.jsxs)(l.Fragment,{children:[(0,v.B)(n||p.length),(0,l.jsx)("span",{className:"mx-1",children:"•"}),(0,l.jsx)(b.A,{defaultMessage:"{count, plural, one {# line} other {# lines}}",id:"AFTxeGB4qO",values:{count:p.split("\n").length}})]}):null,T=null;return T=D?(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,l.jsx)(S.Loading,{size:"md"})}):x&&p?(0,l.jsx)("div",{className:"bg-bg-000 rounded-lg border-0.5 border-border-300 shadow-sm whitespace-pre-wrap break-words overflow-x-auto text-xs p-4 font-mono",children:p}):m?m.file_type===I.Csv?(0,l.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center",children:[(0,l.jsxs)("div",{className:"bg-bg-100 w-[15rem] h-[12.5rem] rounded-lg border border-border-400 mb-5",children:[(0,l.jsxs)("div",{className:"h-[2.25rem] text-text-100 font-medium border-b border-border-400 px-3 flex items-center",children:[(0,l.jsx)(A.o,{className:"mr-2",size:16}),(0,l.jsx)("div",{children:(0,l.jsx)(b.A,{defaultMessage:"Columns",id:"SUa8mpheAG"})})]}),(0,l.jsx)(_.E,{className:"h-[10.25rem] w-[15rem] pt-3 px-3 pb-1 text-text-200",children:m.column_names.map((e,t)=>(0,l.jsx)("div",{className:"truncate mb-2",children:e},t))})]}),(0,l.jsx)("div",{className:"text-lg text-text-100 mb-2",children:(0,l.jsx)(b.A,{defaultMessage:"{columnCount, plural, one {# column} other {# columns}}, {rowCount, plural, one {# row} other {# rows}}",id:"wvGBF/FvBd",values:{columnCount:m.column_count,rowCount:m.row_count}})}),(0,l.jsxs)("div",{className:"flex items-center text-text-300 text-xs",children:[(0,l.jsx)(E.R,{className:"mr-2",size:12}),(0,l.jsx)("div",{children:(0,l.jsx)(b.A,{defaultMessage:"Claude can analyze CSVs with the Analysis tool.",id:"gtvz8LDd6q"})})]})]}):(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,l.jsx)(b.A,{defaultMessage:"File previews are not supported for this file type",id:"99ghrgx5j8"})}):(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,l.jsx)(b.A,{defaultMessage:"Could not load file preview",id:"ATy/CxAxS4"})}),(0,l.jsx)(k.aF,{isOpen:t,hasCloseButton:!0,title:o?(0,l.jsx)(b.A,{defaultMessage:"Pasted content",id:"okKwHjIO0b"}):i,subtitle:x&&z?(0,l.jsx)(L.G,{showPDFWarning:!1,metaData:z}):void 0,onClose:()=>s(!1),className:"w-[40rem] h-[24rem]",modalSize:"xl",children:T})}let z=e=>{let{file:t,isOpen:s,onClose:i}=e,a=(0,g.useMemo)(()=>(0,v.E)(t),[t]);return(0,l.jsx)("div",{children:(0,l.jsx)(k.aF,{modalSize:"xl",isOpen:!!s,onClose:i,hasCloseButton:!0,title:a.title,subtitle:(0,l.jsx)(L.G,{showPDFWarning:"pdf"===t.file_type,metaData:a.metaData}),children:(0,l.jsx)("div",{className:"bg-bg-000 rounded-lg border-0.5 border-border-300 shadow-sm whitespace-pre-wrap break-all text-xs p-4 font-mono",children:t.extracted_content})})})};var T=s(0x225bae024),P=s(0x1ab0d1ca1);function G(){let e=(0,i._)(["\n  rounded-md\n  overflow-hidden\n  shadow-[0_4px_32px_hsl(var(--always-black)/30%),_0_0_0_0.5px_hsl(var(--always-black)/25%)]\n"]);return G=function(){return e},e}let O=e=>{let{file:t,isOpen:s,onClose:i}=e,a=(0,P.A)();return(0,l.jsx)(k.I_,{isOpen:!!s,onClose:i,className:"max-w-[40rem] px-3 pb-14 pt-3",children:(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(T.$,{className:"hover:!text-text-100 !ring-border-200 !absolute left-full top-0 ml-1.5 !text-always-white !ring-offset-0",variant:"ghost",size:"icon_sm","aria-label":a.formatMessage({defaultMessage:"Close image preview",id:"gylVBxmE7Z"}),onClick:e=>{e.preventDefault(),e.stopPropagation(),i()},option:"rounded","data-testid":"close-file-preview",children:(0,l.jsx)(h.X,{size:"16"})}),(0,l.jsx)(F,{children:(0,l.jsx)("img",{src:t.preview_asset.url,width:t.preview_asset.image_width,height:t.preview_asset.image_height,onClick:e=>{e.preventDefault(),e.stopPropagation(),i()},alt:a.formatMessage({defaultMessage:"Preview of {fileName}",id:"djtHiJ5aej"},{fileName:t.file_name}),onDragStart:e=>e.preventDefault(),className:"block w-full max-h-[calc(100vh-4rem)]"})}),(0,l.jsx)("div",{style:{textShadow:"0 0 8px hsl(var(--always-black)/25%)"},className:"pt-1.5 text-center text-always-white",children:t.file_name})]})})},F=n.J.div(G());var R=s(0x1474caf99),U=s(0x1147b5496);function H(e){let{isOpen:t,setIsOpen:s,documentFile:i}=e,a=(0,P.A)();return(0,l.jsx)(k.aF,{isOpen:t,hasCloseButton:!0,title:i.file_name,onClose:()=>s(!1),children:(0,l.jsxs)("a",{className:"self-center group text-center",...(0,R.useDesktopSafeAnchorProps)({href:"".concat(i.document_asset.url,"/").concat(i.file_name),webBehavior:"new-tab",desktopBehavior:"open-in-browser"}),children:[(0,l.jsxs)("div",{className:"w-fit rounded-lg relative m-2 mt-8",children:[(0,l.jsx)("img",{className:"bg-always-white rounded-lg border border-border-300 group-hover:border-accent-secondary-000/70 shadow-sm group-hover:-rotate-1 transition",alt:a.formatMessage({defaultMessage:"{fileName} thumbnail",id:"1bEhiGnHtL"},{fileName:i.file_name}),src:i.thumbnail_asset.url,style:{width:i.thumbnail_asset.image_width/1.5,height:i.thumbnail_asset.image_height/1.5}}),(0,l.jsx)("div",{className:"absolute w-full h-full inset-0 group-hover:bg-gradient-to-t from-accent-secondary-200/5 to-60% group-hover:-rotate-1 transition rounded-lg"}),(0,l.jsx)(e=>{let{pageCount:t}=e;return t<=1?null:(0,l.jsxs)("div",{className:"*:absolute *:w-full *:bg-always-white *:rounded-lg *:group-hover:border-accent-secondary-100/50 *:transition-all *:border *:border-border-300",children:[(0,l.jsx)("div",{className:"h-[98%] ml-1 group-hover:ml-[5px] group-hover:rotate-2 -z-10 shadow-sm top-[1%] opacity-70"}),(0,l.jsx)("div",{className:"h-[96%] ml-2 group-hover:ml-[10px] group-hover:rotate-3 group-hover:top-[2%]  -z-20 shadow top-[2%] opacity-50"})]})},{pageCount:i.document_asset.page_count})]}),(0,l.jsxs)("div",{className:"relative text-center inline-flex items-center justify-center text-pretty gap-2 p-1 text-sm text-text-300 *:transition",children:[(0,l.jsx)("p",{className:"group-hover:opacity-0 group-hover:scale-75",children:(0,l.jsx)(b.A,{defaultMessage:"{count, plural, one {# page} other {# pages}}",id:"RyCW0gT/7M",values:{count:i.document_asset.page_count}})}),(0,l.jsxs)("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 inline-flex items-center justify-center gap-1 text-accent-secondary-000",children:[(0,l.jsx)(U.K,{size:16,weight:"fill",className:"scale-50 group-hover:scale-100 transition-all "}),(0,l.jsx)("p",{children:(0,l.jsx)(b.A,{defaultMessage:"Download",id:"5q3qC0sC3r"})})]})]})]})})}function B(){let e=(0,i._)(["\n  min-w-0\n  h-[18px] \n  flex \n  flex-row \n  items-center \n  justify-center\n  gap-0.5\n  px-1 \n  border-0.5\n  border-border-300/25\n  shadow-sm\n  rounded\n  bg-bg-000/70\n  backdrop-blur-sm\n  font-medium\n"]);return B=function(){return e},e}let W="excerpt_from_previous_claude_message.txt";function K(e){return""===e.file_name||e.file_name.match(/paste(-\d+)?\.txt/)}function q(e){return e.file_name===W}function V(e){if("file_kind"in e){if(!e.file_name)return;let t=e.file_name.split(".");return t.length>1?t[t.length-1]:void 0}if(e.displayOnly)return"";{if(K(e))return"pasted";if(q(e))return"";if("text/plain"===e.file_type)return"txt";if("text/html"===e.file_type)return"html";let t=e.file_name.match(/\.[^.]+$/);return t&&(0,a.cm)({imagesEnabled:!0}).includes(t[0].toLowerCase())?t[0].slice(1):"text"}}let J=e=>{let{handleClick:t,isInSelectionMode:s,handleSelect:i,isSelected:l}=e,[a,r]=(0,g.useState)(!1);return{onClick:()=>{s&&i?i(!l,!1):t?t():r(!0)},isPreviewOpen:a,setIsPreviewOpen:r}},Z={icon:{height:28,width:28},normal:{height:120,width:120},stretch:{height:120,width:"100%"}},$=e=>e&&Z[e]?Z[e]:Z.normal,Q=e=>{let{file:t,isEditable:s,showWarnings:i,...a}=e;if("file_kind"in t)switch(t.file_kind){case u.M.Image:return(0,l.jsx)(Y,{...a,file:t,showWarnings:i,isEditable:s});case u.M.Blob:return(0,l.jsx)(X,{...a,file:t,isEditable:s});case u.M.SanitizedDocument:return(0,l.jsx)(et,{...a,file:t,isEditable:s});case u.M.WiggleVM:return(0,l.jsx)(es,{...a,file:t,isEditable:s})}return(0,l.jsx)(ee,{...a,file:t,isEditable:s})},Y=e=>{let{disabled:t,size:s,file:i,showWarnings:a,handleRemove:r,handleClick:n,isSelected:o,handleSelect:d,isInSelectionMode:c,isEditable:u}=e,{height:x,width:h}=$(s),{onClick:f,isPreviewOpen:m,setIsPreviewOpen:g}=J({handleClick:n,isInSelectionMode:c,handleSelect:d,isSelected:o}),b=a&&(e=>{if(!e.preview_asset)return!1;let{image_width:t,image_height:s}=e.preview_asset;return t<200||s<200})(i);return(0,l.jsxs)("div",{className:"relative group/thumbnail",children:[(0,l.jsxs)("div",{"data-testid":i.file_name,style:{width:h,height:x,minWidth:h,minHeight:x},className:(0,p.A)("rounded-lg overflow-hidden can-focus-within rounded-lg border-0.5 border-border-300/25 hover:border-border-200/50 hover:shadow-always-black/10 shadow-sm shadow-always-black/5",!t&&"cursor-pointer"),children:[(0,l.jsx)(ei,{"data-testid":"file-thumbnail",disabled:t,width:h,height:x,fileName:i.file_name,src:i.preview_asset.url,onClick:f}),(0,l.jsx)(eu,{isAbsolute:!0,right:b?(0,l.jsx)(eh,{type:"warning",tooltipText:"Attach a higher resolution image for better results"}):void 0,isSelected:o,handleSelect:d,isEditable:u}),(0,l.jsx)(O,{file:i,isOpen:m,onClose:()=>g(!1)})]}),(0,l.jsx)(ep,{disabled:t,handleRemove:r,isEditable:u,isInSelectionMode:c})]})},X=e=>{let{file:t,handleClick:s,...i}=e,{onClick:a,isPreviewOpen:r,setIsPreviewOpen:n}=J({handleClick:s,isInSelectionMode:i.isInSelectionMode,handleSelect:i.handleSelect,isSelected:i.isSelected}),o=V(t);return(0,l.jsxs)("div",{children:[(0,l.jsx)(el,{...i,"data-testid":t.file_name,title:t.file_name,handleClick:a,tag:!!o&&(0,l.jsx)(ex,{tagName:o,tooltipText:o?"Claude can analyze ".concat(o.toUpperCase()," files with the analysis tool."):"Claude can analyze this file with the Analysis tool."})}),(0,l.jsx)(D,{isOpen:r,setIsOpen:n,fileName:t.file_name,fileUuid:t.file_uuid,filePath:t.path,fileSize:"file_size"in t?t.file_size:void 0})]})},ee=e=>{let{file:t,handleClick:s,...i}=e,{onClick:a,isPreviewOpen:r,setIsPreviewOpen:n}=J({handleClick:s,isInSelectionMode:i.isInSelectionMode,handleSelect:i.handleSelect,isSelected:i.isSelected}),o=K(t),d=q(t),c=o?"Pasted Text":d?"Excerpt Text":t.file_name,u=t.extracted_content.split("\n").length,x=(0,l.jsx)(b.A,{defaultMessage:"{count, plural, one {# line} other {# lines}}",id:"AFTxeGB4qO",values:{count:u}}),h=t.extracted_content.substring(0,300),p=V(t);return(0,l.jsxs)("div",{children:[(0,l.jsx)(el,{...i,"data-testid":t.file_name,...o||d?{text:h}:{title:c,subtitle:x},handleClick:a,textSize:d?"medium":"small",showLeftBorder:d,tag:!!p&&(0,l.jsx)(ex,{tagName:p,tooltipText:"pdf"===t.file_type?"PDF converted to text":void 0})}),(0,l.jsx)(z,{file:t,isOpen:r,onClose:()=>n(!1)})]})},et=e=>{let{disabled:t,size:s,file:i,handleRemove:a,handleClick:r,isSelected:n,handleSelect:o,isInSelectionMode:d,isEditable:c}=e,{height:u,width:x}=$(s),{onClick:h,isPreviewOpen:f,setIsPreviewOpen:m}=J({handleClick:r,isInSelectionMode:d,handleSelect:o,isSelected:n}),g=V(i);return(0,l.jsxs)("div",{className:"group/thumbnail relative",children:[(0,l.jsxs)("div",{"data-testid":i.file_name,style:{width:x,height:u,minWidth:x,minHeight:u},className:(0,p.A)("rounded-lg overflow-hidden border-0.5 border-border-300/25 shadow-sm shadow-always-black/5 can-focus-within rounded-lg",!t&&"cursor-pointer hover:border-border-200/50 hover:shadow-always-black/10"),children:[(0,l.jsx)(ei,{disabled:t,width:"100%",height:"100%",fileName:i.file_name,src:i.thumbnail_asset.url,onClick:h}),(0,l.jsx)(eu,{isSelected:n,handleSelect:o,isAbsolute:!0,left:g?(0,l.jsx)(ex,{tagName:g}):void 0,isEditable:c}),(0,l.jsx)(H,{isOpen:f,setIsOpen:m,documentFile:i})]}),(0,l.jsx)(ep,{disabled:t,handleRemove:a,isEditable:c,isInSelectionMode:d})]})},es=e=>{let{file:t,...s}=e,i=V(t);return(0,l.jsx)("div",{children:(0,l.jsx)(el,{...s,"data-testid":t.file_name,title:t.file_name,handleClick:s.handleClick?()=>{var e;null==(e=s.handleClick)||e.call(s)}:void 0,tag:!!i&&(0,l.jsx)(ex,{tagName:i})})})},ei=e=>{let{disabled:t,width:s,height:i,fileName:a,src:r,onClick:n}=e,[o,d]=(0,g.useState)(!1);return(0,l.jsx)("button",{className:"relative bg-bg-000",style:{width:s,height:i},disabled:t,onClick:n,children:(0,l.jsx)("img",{className:(0,p.A)("w-full h-full object-cover transition duration-400",o?"opacity-1":"opacity-0 blur-sm"),onLoad:()=>d(!0),alt:a,src:r,onDragStart:e=>e.preventDefault()})})},el=e=>{let{disabled:t,size:s,handleClick:i,url:a,title:r,subtitle:n,text:o,isLoading:d=!1,tag:c,actions:u,isError:x,handleRemove:h,isEditable:m,isSyncing:g,handleSelect:b,isSelected:v,isInSelectionMode:j,textSize:y="small",showLeftBorder:w=!1}=e,N=!!(i||a),{height:C,width:S}=$(s);return(0,l.jsx)("div",{className:"relative",children:(0,l.jsxs)(f.P.div,{className:"group/thumbnail",whileHover:m||g||j?"actionsVisible":void 0,animate:j||g?"actionsVisible":"initial","data-testid":"file-thumbnail",children:[(0,l.jsxs)(ea,{url:a,handleClick:i,disabled:t,width:S,height:C,isClickable:N,isLoading:d,isError:x,children:[(0,l.jsxs)("div",{className:"relative flex flex-col gap-1 min-h-0",children:[o?(0,l.jsxs)("div",{className:"flex-1 min-h-0 flex flex-row gap-2 overflow-hidden [mask-image:linear-gradient(to_bottom,hsl(var(--always-black)/80%)_0%,_hsl(var(--always-black)/10%)_100%)]",children:[w&&(0,l.jsx)("div",{className:"w-[3px] mt-0.5 shrink-0 bg-border-400 rounded-full"}),(0,l.jsx)(f.P.p,{initial:{opacity:0},animate:{opacity:1},className:(0,p.A)("text-text-100 break-words flex-1 min-w-0","medium"===y?"text-[10px]":"text-[8px]"),children:o})]}):x||r&&!d?(0,l.jsx)(f.P.h3,{initial:{opacity:0},animate:{opacity:1},inherit:!1,className:(0,p.A)("text-[12px] break-words",x?"text-text-500":"text-text-100",n?"line-clamp-3":"line-clamp-4"),children:r}):(0,l.jsx)(eo,{}),!!n&&!d&&!x&&(0,l.jsx)(f.P.p,{initial:{opacity:0},animate:{opacity:1},inherit:!1,className:"text-[10px] line-clamp-1 break-words text-text-500",children:n})]}),d?(0,l.jsx)(ed,{}):(0,l.jsx)(eu,{isSelected:v,handleSelect:b,left:c,right:x&&(0,l.jsx)(eh,{type:"error"}),actions:u,isEditable:m})]}),(0,l.jsx)(ep,{disabled:t,handleRemove:h,isEditable:m,isInSelectionMode:j})]})})},ea=e=>{let{children:t,disabled:s,width:i,height:a,handleClick:r,url:n,isClickable:o,isLoading:d,isError:c}=e;return r?(0,l.jsx)("button",{disabled:s,style:{width:i,height:a,minWidth:i},className:(0,p.A)("rounded-lg text-left block",!s&&"cursor-pointer","font-ui transition-all rounded-lg border-0.5 border-border-300/25 flex flex-col justify-between gap-2.5 overflow-hidden px-2.5 py-2",c?"bg-danger-200/5":d?"bg-bg-100":"bg-bg-000",o&&!d&&!s&&"hover:border-border-200/50 hover:shadow-always-black/10",!d&&"shadow-sm shadow-always-black/5"),onClick:r,children:t}):n?(0,l.jsx)("a",{style:{width:i,height:a,minWidth:i},className:(0,p.A)("rounded-lg text-left block",!s&&"cursor-pointer","font-ui transition-all rounded-lg border-0.5 border-border-300/25 flex flex-col justify-between gap-2.5 overflow-hidden px-2.5 py-2",c?"bg-danger-200/5":d?"bg-bg-100":"bg-bg-000",o&&!d&&!s&&"hover:border-border-200/50 hover:shadow-always-black/10",!d&&"shadow-sm shadow-always-black/5"),href:s?void 0:n,target:"_blank",children:t}):(0,l.jsx)("div",{style:{width:i,height:a,minWidth:i},className:(0,p.A)("rounded-lg text-left block",!s&&o&&"cursor-pointer","font-ui transition-all rounded-lg border-0.5 border-border-300/25 flex flex-col justify-between gap-2.5 overflow-hidden px-2.5 py-2",c?"bg-danger-200/5":d?"bg-bg-100":"bg-bg-000",o&&!d&&!s&&"hover:border-border-200/50 hover:shadow-always-black/10",!d&&"shadow-sm shadow-always-black/5"),children:t})},er=e=>{let{file:t}=e,s=V(t);return(0,l.jsx)("div",{className:"w-[38px] h-[38px] min-w-[38px] font-ui rounded-lg border-0.5 border-border-300/25 shadow-sm shadow-always-black/5 flex items-center justify-center overflow-hidden bg-bg-000",children:!!s&&(0,l.jsx)("p",{className:"font-bold uppercase font-ui text-text-300 text-[9px] pt-0.5",children:s})})},en=e=>{let{size:t,tag:s,isShown:i=!0}=e,{width:a}=$(t);return(0,l.jsx)(m.N,{children:!!i&&(0,l.jsx)(f.P.div,{initial:{opacity:0,maxWidth:0},animate:{opacity:1,maxWidth:a},children:(0,l.jsx)(el,{isLoading:!0,tag:s,size:t})})})},eo=()=>(0,l.jsxs)(f.P.div,{initial:{opacity:0},animate:{opacity:1},className:"w-full flex flex-col",children:[(0,l.jsx)(o.j,{width:"100%",height:"12px",className:"mt-1 !bg-border-400 !rounded after:!via-always-white/50"}),(0,l.jsx)(o.j,{width:"66%",height:"12px",className:"mt-1 !bg-border-400 !rounded after:!via-always-white/50"})]}),ed=()=>(0,l.jsx)(f.P.div,{initial:{opacity:0},animate:{opacity:1},children:(0,l.jsx)(o.j,{width:"48px",height:"18px",className:"mt-1 !bg-border-400 !rounded after:!via-always-white/50"})}),ec=n.J.div(B()),eu=e=>{let{isAbsolute:t=!1,left:s,right:i,actions:a,handleSelect:n,isSelected:o,isEditable:d}=e,c=!!s,u=!!i||!!n;return c||u?(0,l.jsx)("div",{className:(0,p.A)(t&&"absolute bottom-2 left-0 right-0 px-2.5 overflow-x-hidden overflow-y-visible"),children:(0,l.jsxs)("div",{className:(0,p.A)("relative flex flex-row items-center gap-1",u&&!c?"justify-end":"justify-between"),children:[c&&(0,l.jsx)(f.P.div,{initial:{opacity:0},animate:{opacity:1},className:"flex flex-row gap-1 shrink min-w-0",children:s}),u&&(0,l.jsxs)("div",{className:"flex flex-row gap-1 shrink-0",children:[i,!!n&&!!d&&(0,l.jsxs)(f.P.div,{variants:{actionsVisible:{opacity:1,position:"relative"},initial:{opacity:0,position:"absolute"}},className:"flex flex-row gap-1 h-[18px] right-0 top-0",onClick:e=>e.stopPropagation(),transition:{ease:"easeOut",duration:.2},children:[a,(0,l.jsx)(r.Sc,{checked:o,onChange:n,label:"Select file",hideLabel:!0,className:(0,p.A)("!w-[18px] !h-[18px] !border-0.5 !border-border-300/25 !shadow-sm !rounded"),size:12})]})]})]})}):null},ex=e=>{let{tagName:t,tooltipText:s,className:i}=e,a=(0,l.jsx)(ec,{className:i,children:(0,l.jsx)("p",{className:"uppercase truncate font-ui text-text-300 text-[11px] leading-[13px]",children:t})});return s?(0,l.jsx)(d.Tooltip,{tooltipContent:s,children:a}):a},eh=e=>{let{type:t,tooltipText:s,className:i}=e,a=(0,l.jsx)(ec,{className:(0,p.A)("shrink-0","error"===t?"text-danger-000 border-danger-200/50 bg-danger-900":"text-warning-200 border-warning-200/50 bg-bg-000/70",i),children:(0,l.jsx)(x.N,{size:12})});return s?(0,l.jsx)(d.Tooltip,{tooltipContent:s,children:a}):a},ep=e=>{let{disabled:t,handleRemove:s,isEditable:i,isInSelectionMode:a}=e;return!s||!i||a||t?null:(0,l.jsx)(d.Tooltip,{tooltipContent:(0,l.jsx)(b.A,{defaultMessage:"Remove",id:"G/yZLul6P1"}),side:"bottom",children:(0,l.jsx)("button",{className:(0,p.A)("transition-all hover:bg-bg-000/50 text-text-500 hover:text-text-200 group-focus-within/thumbnail:opacity-100 group-hover/thumbnail:opacity-100 opacity-0 w-5 h-5 absolute -top-2 -left-2 rounded-full border-0.5 border-border-300/25 bg-bg-000/90 backdrop-blur-sm flex items-center justify-center",(0,c.Fr)()&&"!opacity-100 !bg-bg-000/50"),onClick:e=>{e.stopPropagation(),e.preventDefault(),s()},children:(0,l.jsx)(h.X,{size:12,weight:"bold"})})})}},0x1a28f0915:(e,t,s)=>{s.d(t,{s:()=>ep});var i=s(0x22102fd88),l=s(0x183548b63),a=s(0x20e00cddd),r=s(0x1b813d90),n=s(0xfc89b4a4),o=s(0x1e841cc7d),d=s(0x1bd42f6d2),c=s(0x218bd2f97),u=s(0x226530adf),x=s(0xdd4f13c7),h=s(0x14de19ae8),p=s(0x53bbc52f),f=s(0xac309a83),m=s(0x17f3a2521);let g={raven:{hardLimit:19e4,output:16384},pro:{hardLimit:19e4,output:8192},max:{hardLimit:19e4,output:16384},free:{hardLimit:30500,output:8192}},b={default:g};var v=s(0x1d0c32e96),j=s(0x225bae024),y=s(0x1d4204d53),w=s(0x14023fbb8),N=s(0x22fc8d729),C=s(0x1b370f49d),S=s(0x1016c6ed2),k=s(0x151b261be),_=s(0x214c6246e),A=s(0x18f9bc151),E=s(0x1023bd896),M=s(0xcea5e4c1),I=s(0x174350552),L=s(0x1ab362a20),D=s(0xa7346e51),z=s(0xa6a34c14),T=s(0x10e578383),P=s(0x12a3a86b6),G=s(0x1a1f6dda6),O=s(0x160045b25),F=s(0x1dc411c0f),R=s(0x16ab3413b),U=s.n(R),H=s(0x31828b6a),B=s(0x38e6572),W=s(0x1ab0d1ca1),K=s(0xe0c26d90);function q(e,t){if(!t.startsWith("/"))throw Error("absolute path required");let s=t;for(;null!==s;){let t=e[s];if("include"===t)return!0;if("exclude"===t)break;s=$(s)}return!1}function V(e,t){if(!t.startsWith("/"))throw Error("absolute path required");return q(e=Z(e,t),t)&&(e={...e,[t]:"exclude"}),e}function J(e,t){if(!t.startsWith("/"))throw Error("absolute path required");return q(e=Z(e,t),t)||(e={...e,[t]:"include"}),e}function Z(e,t){let s={...e};for(let i of Object.keys(e))(t.endsWith("/")&&t===i||i.startsWith(t))&&delete s[i];return s}function $(e){if(!e.startsWith("/"))throw Error("absolute path required");if("/"===e)return null;let t=e.endsWith("/")?e.lastIndexOf("/",e.length-2):e.lastIndexOf("/");return t<=0?"/":e.slice(0,t+1)}let Q="lastSelectedRepo";function Y(e,t){return{name:e,path:t.endsWith("/")?t:t+"/",size:0,children:new Map}}function X(e){var t,s;let{initialConfig:l,tokenLimit:r,alreadyUsedTokens:o,onSubmit:d,isSubmitting:c}=e,[u,x]=(0,n.useState)("/"),h=void 0===l,p=r*a.Pu,[f,m]=(0,n.useState)(()=>{if(l)return l;let e=function(){let e=localStorage.getItem(Q);if(e){var t;let s=JSON.parse(e);if(s&&"object"==typeof(t=s)&&null!==t&&"string"==typeof t.owner&&"string"==typeof t.repo&&"string"==typeof t.branch)return s}return null}();return e?{owner:e.owner,repo:e.repo,branch:e.branch,filters:{filters:{}}}:{}}),{owner:g,repo:b,branch:v,filters:j}=f;(0,n.useEffect)(()=>{x("/")},[b]);let y=e=>{m({owner:g,repo:b,branch:v,filters:{filters:e}})},w=(0,n.useMemo)(()=>!U()(null==l?void 0:l.filters,j),[l,j]),{data:N,isFetching:C,error:S}=(0,K.tn)({owner:g,repo:b,branch:v}),k=(0,n.useMemo)(()=>(function(e,t){if(!t||!e)return[];let s=[];for(let i of t.tree)"blob"===i.type&&q(e,"/"+i.path)&&s.push(i);return s})(null==j?void 0:j.filters,N.tree),[null==j?void 0:j.filters,N.tree]),_=Math.ceil(100*k.map(e=>e.size).reduce((e,t)=>e+t,0)/p)+Math.ceil(100*o/r),A=(0,n.useMemo)(()=>N.tree?function(e){let t={name:"",path:"/",size:0,children:new Map};for(let s of e.tree){let e=s.path.split("/"),i=e.pop(),l=t;for(let t=0;t<e.length;t++){let i=e[t];if(!l.children.has(i)){let s="/"+e.slice(0,t+1).join("/");l.children.set(i,Y(i,s))}"blob"===s.type&&(l.size+=s.size),l=l.children.get(i)}if("blob"===s.type)l.children.set(i,{name:i,path:"/"+s.path,size:s.size}),l.size+=s.size;else l.children.set(i,Y(i,"/"+s.path))}return t}(N.tree):null,[N.tree]);(0,n.useEffect)(()=>{(null==N?void 0:N.repo)&&(null==N?void 0:N.repo.default_branch)&&!v&&m(e=>({...e,branch:N.repo.default_branch}))},[null==N?void 0:N.repo,v,m]),(0,n.useEffect)(()=>{g&&b&&v&&localStorage.setItem(Q,JSON.stringify({owner:g,repo:b,branch:v}))},[g,b,v]);let[E,M]=(0,n.useState)("");return(0,i.jsxs)("div",{className:"rounded-xl border-0.5 border-border-300 bg-bg-000 shadow-sm h-[600px] flex flex-col",children:[(0,i.jsx)(ei,{isCreating:h,config:f,setConfig:m,searchQuery:E,setSearchQuery:M,isSubmitting:c,percentUsed:_,onSubmit:d,areFiltersDirty:w,enforceSizeLimit:!0}),C?(0,i.jsx)(et,{}):null!==S?(0,i.jsx)(es,{error:S}):b&&g&&v?E?(0,i.jsx)(eo,{rootNode:A,searchQuery:E,filters:null!=(t=null==j?void 0:j.filters)?t:{},setFilters:y,sizeLimit:p,setCurrentDirectory:x,setSearchQuery:M,enforceSizeLimit:!0}):(0,i.jsx)(en,{repo:b,rootNode:A,filters:null!=(s=null==j?void 0:j.filters)?s:{},setFilters:y,sizeLimit:p,currentDirectory:u,setCurrentDirectory:x,enforceSizeLimit:!0}):(0,i.jsx)(ee,{}),(0,i.jsx)(ed,{percentUsed:_,selectedPaths:k,alreadyUsedTokens:o,tokenLimit:r,enforceSizeLimit:!0})]})}function ee(){return(0,i.jsx)("div",{className:"flex items-center justify-center h-full bg-bg-000 text-sm text-text-300 border-border-300 border-t-0.5",children:(0,i.jsx)(B.A,{defaultMessage:"Select a repository or paste a URL above to get started",id:"aGsfPG9sTD"})})}let et=()=>(0,i.jsxs)("div",{className:"flex items-center justify-center gap-3 h-full bg-bg-000 shadow-sm text-sm text-text-300",children:[(0,i.jsx)("div",{children:(0,i.jsx)(w.Loading,{size:"sm"})}),(0,i.jsx)(B.A,{defaultMessage:"Fetching repository...",id:"hnjVW1oRt2"})]});function es(e){let{error:t}=e,s=t instanceof S.LG&&404===t.statusCode,l=t instanceof S.LG&&"github_get_tree_api_call_limit_exceeded"===t.errorCode;return(0,i.jsx)("div",{className:"flex h-full bg-bg-000 text-sm text-text-300 border-border-300 border-t-0.5",children:(0,i.jsx)("div",{className:"flex items-center gap-2 m-6",children:s?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(k.t,{size:16}),(0,i.jsx)("span",{children:(0,i.jsx)(B.A,{defaultMessage:"Claude cannot access that resource. If you know that it exists, you may first need to grant or request access <link>here</link>.",id:"41xNOZpKM8",values:{link:e=>(0,i.jsx)(N.Y,{href:"".concat(function(e){if(e instanceof S.LG){var t,s;let i=null==(s=e.extra)||null==(t=s.details)?void 0:t.app_public_url;if(i)return i}return"https://github.com/apps/claude-for-github"}(t),"/installations/select_target"),target:"_blank",children:e})}})})]}):l?(0,i.jsx)("span",{className:"text-danger-000",children:(0,i.jsx)(B.A,{defaultMessage:"Please try a smaller repo.",id:"lvImCTHUvN"})}):(0,i.jsx)("span",{className:"text-danger-000",children:(0,i.jsx)(B.A,{defaultMessage:"An error occurred while fetching that resource. Please try again.",id:"u8OHhkIcYv"})})})})}function ei(e){var t,s;let{config:l,setConfig:a,isCreating:o,isSubmitting:d,percentUsed:c,searchQuery:u,setSearchQuery:x,onSubmit:h,areFiltersDirty:p,enforceSizeLimit:f}=e,[m,g]=(0,n.useState)(!1),[b,y]=(0,n.useState)(!1);return(0,i.jsxs)("div",{className:"flex flex-row gap-2 items-center py-2 min-h-14 px-4 font-base border-b-0.5 border-border-300",children:[(0,i.jsx)(v.A9,{size:18,type:r.v8.GITHUB,className:"flex-shrink-0"}),!m&&(0,i.jsx)(el,{config:l,setConfig:a,isCreating:o}),(0,i.jsxs)("div",{className:"inline-flex gap-0 items-center",children:[(0,i.jsx)(ea,{isCreating:o,isExpanded:m,setIsExpanded:g,setConfig:a,className:(0,G.A)({"flex-1 flex-shrink":o&&m})}),l.repo&&!m&&(0,i.jsx)(er,{isExpanded:b,setIsExpanded:y,searchQuery:u,setSearchQuery:x,className:"flex-1 flex-shrink"})]}),(0,i.jsx)(O.N,{children:!m&&l.repo&&0!==Object.keys(null!=(s=null==(t=l.filters)?void 0:t.filters)?s:{}).length&&(o||p)&&(0,i.jsx)(F.P.div,{className:"ml-auto",initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{type:"spring",damping:20,stiffness:400,delay:0},children:(0,i.jsx)(j.$,{disabled:d||f&&c>100||!l.owner||!l.repo||!l.branch,onClick:()=>h(l),children:d?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(_.N,{className:"animate-spin"})}):o?(0,i.jsx)(B.A,{defaultMessage:"Add files",id:"xrAjmQ72mN"}):(0,i.jsx)(B.A,{defaultMessage:"Update",id:"BWpuKlRSA1"})})})})]})}function el(e){let{config:t,setConfig:s,isCreating:l,className:a}=e,{data:r=[]}=(0,K.b4)(),o=r.map(e=>({owner:e.owner.login,repo:e.name,branch:e.default_branch}));t.owner&&t.repo&&t.branch&&!o.some(e=>e.repo===t.repo&&e.owner===t.owner&&e.branch===t.branch)&&o.unshift({owner:t.owner,repo:t.repo,branch:t.branch});let[d,c]=(0,n.useState)(void 0);return(0,n.useEffect)(()=>{t.owner&&t.repo&&t.branch?c(JSON.stringify({owner:t.owner,repo:t.repo,branch:t.branch})):c(void 0)},[t]),(0,i.jsx)("div",{className:a,children:(0,i.jsxs)(H.bL,{value:d,onValueChange:e=>{s({...JSON.parse(e),filters:{filters:{}}}),c(e)},disabled:!l,children:[(0,i.jsxs)(H.l9,{className:(0,G.A)("flex flex-row rounded-md border-0.5 px-2 border-border-300 py-1 items-center gap-1 text-nowrap overflow-x-hidden",{"max-w-96  pointer-cursor select-none hover:bg-bg-100 ":l,"bg-bg-100":!l}),children:[(0,i.jsx)(H.WT,{placeholder:"Select a repository"}),l&&(0,i.jsx)(H.In,{className:"pl-1",children:(0,i.jsx)(A.a,{})})]}),(0,i.jsx)(H.ZL,{children:(0,i.jsx)(H.UC,{className:"border-0.5 border-border-300 bg-bg-100 min-w-72 rounded-lg shadow-sm z-dropdown mt-1 p-1 max-h-96 overflow-y-auto",position:"popper",children:(0,i.jsx)(H.LM,{className:"overflow-auto",children:o.map((e,t)=>(0,i.jsx)(H.q7,{value:JSON.stringify(e),className:(0,G.A)("relative flex flex-row p-1.5 cursor-pointer hover:bg-bg-200 focus:outline-none focus:bg-bg-200 rounded-md"),children:(0,i.jsx)(H.p4,{children:(0,i.jsxs)("span",{className:"flex flex-row text-sm items-center ",children:[(0,i.jsxs)("span",{children:[(0,i.jsx)("span",{className:"text-text-300",children:e.owner}),"\xa0",(0,i.jsx)("span",{className:"text-text-500/50",children:"/"}),"\xa0",(0,i.jsx)("span",{className:"text-text-000",children:e.repo})]}),(!l||l&&"master"!==e.branch&&"main"!==e.branch)&&(0,i.jsxs)("span",{className:" flex flex-row font-mono text-xs text-text-300 rounded-full px-1.5 ml-2 gap-1 items-center bg-border-400/[0.03] border-border-300 border-0.5 ",children:[(0,i.jsx)(E.r,{}),e.branch]})]})})},t))})})})]})})}function ea(e){let{isCreating:t,isExpanded:s,setIsExpanded:l,setConfig:a,className:r}=e,o=(0,W.A)(),[d,c]=(0,n.useState)(""),u=()=>{let{owner:e,repo:t,branch:s}=function(e){let t;try{t=new URL(null!=e?e:"")}catch(e){return{}}if("github.com"!==t.hostname)return{};let[,s,i,l,...a]=t.pathname.split("/");return{owner:s,repo:i,location:l,branch:a.join("/").replace(/\/$/,"")}}(d);a({owner:e,repo:t,branch:s,filters:{filters:{}}}),l(!1),c("")};return t&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:(0,G.A)("flex flex-row gap-1 items-center text-sm px-0.5",{"border-0.5 border-border-300 rounded-md h-[29px] w-64 transition":s},r),children:[(0,i.jsx)(C.Tooltip,{tooltipContent:"Paste GitHub URL",children:!s&&(0,i.jsx)(j.$,{onClick:()=>l(!s),size:"icon_sm",variant:"ghost",disabled:s,children:(0,i.jsx)(M.X,{size:16})})}),s&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",{className:"flex-1 border-none bg-transparent bg-none px-0 focus:ring-0 p-0 text-sm ml-2",type:"text",value:d,onChange:e=>c(e.target.value),placeholder:o.formatMessage({defaultMessage:"Paste GitHub URL",id:"RobpzbjbFb"}),autoFocus:!0,onKeyDown:e=>{"Enter"===e.key&&u()}}),d&&(0,i.jsx)(O.N,{children:(0,i.jsx)(F.P.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},transition:{type:"spring",damping:20,stiffness:400,delay:0},children:(0,i.jsx)(j.$,{onClick:u,size:"icon_xs",children:(0,i.jsx)(I.y,{})})})})]})]}),s&&(0,i.jsx)(j.$,{onClick:()=>{l(!1),c("")},size:"icon_sm",variant:"ghost",className:"ml-2",children:(0,i.jsx)(L.X,{})})]})}function er(e){let{isExpanded:t,setIsExpanded:s,searchQuery:l,setSearchQuery:a,className:r}=e,n=(0,W.A)();return(0,i.jsxs)("div",{className:(0,G.A)("flex flex-row items-center text-sm pl-0 p-1",{"border-0.5 border-border-300 rounded-md h-[29px] transition":t},r),children:[(0,i.jsx)(C.Tooltip,{tooltipContent:"Search files",children:(0,i.jsx)(j.$,{onClick:()=>s(!t),size:"icon_sm",variant:"ghost",disabled:t,children:(0,i.jsx)(D.e,{size:"16"})})}),t&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",{type:"text",placeholder:n.formatMessage({defaultMessage:"Search files",id:"8xPuGUna7W"}),value:l,className:"flex-1 border-none bg-transparent bg-none px-0 focus:ring-0 p-0 text-sm ",onChange:e=>a(e.target.value),autoFocus:!0}),(0,i.jsx)(j.$,{onClick:()=>{a(""),s(!1)},size:"icon_xs",variant:"ghost",children:(0,i.jsx)(L.X,{})})]})]})}function en(e){let{repo:t,rootNode:s,filters:l,setFilters:a,sizeLimit:r,currentDirectory:o,setCurrentDirectory:d,enforceSizeLimit:c}=e,u=function(e,t){let s=t.split("/").slice(1,-1),i=e;for(let e of s){if(!i.children)return null;i=i.children.get(e)}return i}(s,o),x=(null==u?void 0:u.children)?[...u.children.values()].sort((e,t)=>e.children?t.children?e.path.localeCompare(t.path):-1:1):[],h=(0,n.useMemo)(()=>{let e=[],s=o;for(;s;){let i=s.slice(s.lastIndexOf("/",s.length-2)).slice(1,-1);e.unshift({name:i||t,path:s}),s=$(s)}return e},[t,o]),p=u?ec(u,l)?"partial":q(l,u.path)?"checked":"unchecked":"unchecked";return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"flex items-center gap-2 py-2 px-4 border-b-0.5 border-border-300 bg-bg-100/50 text-sm",children:[u&&(0,i.jsx)(y.f,{checkState:p,onClick:e=>{let{didCheck:t}=e;t?a(J(l,u.path)):a(V(l,u.path))}}),(0,i.jsx)("div",{className:"flex-row gap-1 ",children:h.map((e,t)=>{let{path:s,name:l}=e;return h.length===t+1?(0,i.jsx)("span",{children:l},t):(0,i.jsxs)("span",{className:"first-child:pointer-events-none",children:[(0,i.jsx)("button",{className:"hover:text-text-200 text-text-500 transition",onClick:()=>d(s),children:l}),t<h.length-1&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("span",{className:"mx-1 text-text-500/50",children:"/"})})]},t)})})]},"breadcrumbs")}),(0,i.jsx)("div",{className:"flex flex-col h-full overflow-y-scroll",children:x.map(e=>(0,i.jsx)(eu,{node:e,showPath:!1,filters:l,sizeLimit:r,onUpdateFilters:a,onClick:e.children?()=>d(e.path):void 0,enforceSizeLimit:c},e.path))},"rows")]})}function eo(e){let{rootNode:t,searchQuery:s,filters:l,setFilters:a,sizeLimit:r,setCurrentDirectory:o,setSearchQuery:d,enforceSizeLimit:c}=e,u=(0,n.useMemo)(()=>{let e=[],i=[t],l=s.toLowerCase();for(;i.length>0&&e.length<50;){let t=i.pop();t.children&&i.push(...t.children.values()),t.path.toLowerCase().includes(l)&&e.push(t)}return e},[s,t]);return(0,i.jsx)("div",{className:"flex flex-col h-full overflow-y-scroll",children:u.slice(0,100).map(e=>(0,i.jsx)(eu,{node:e,showPath:!0,filters:l,sizeLimit:r,onUpdateFilters:a,onClick:e.children?()=>{o(e.path),d("")}:void 0,onNavigate:e=>{o(e),d("")},enforceSizeLimit:c},e.path))},"rows")}function ed(e){let{percentUsed:t,selectedPaths:s,alreadyUsedTokens:l,tokenLimit:a,enforceSizeLimit:r}=e,{progressBarPercentPrimary:o,progressBarPercentSecondary:d}=(0,n.useMemo)(()=>{let e=Math.min(100,Math.ceil(100*l/a));return{progressBarPercentPrimary:Math.min(100,t-e),progressBarPercentSecondary:e}},[t,l,a]),c=r?(0,i.jsx)(B.A,{defaultMessage:"{percentUsed}% of capacity used",id:"1VbFlPsYRL",values:{percentUsed:ex(t)}}):null;return(0,i.jsxs)("div",{className:(0,G.A)("flex text-xs items-center justify-between border-border-300 border-t-0.5 py-2 px-4 rounded-b-lg transition",{"bg-danger-100 text-danger-900":r&&t>=100},{"text-text-300":!r||t<100}),children:[s.length&&(!r||t<100)?(0,i.jsx)("p",{children:(0,i.jsx)(B.A,{defaultMessage:"{selected, plural, one {# file} other {# files}} selected",id:"F7Bwhc8GRB",values:{selected:s.length}})}):!r||t<100?(0,i.jsx)("p",{children:(0,i.jsx)(B.A,{defaultMessage:"Select files to add to chat context",id:"t6XeSPdQqI"})}):(0,i.jsxs)("div",{className:"inline-flex gap-2 items-center ",children:[(0,i.jsx)(z.N,{className:"opacity-80",size:14}),(0,i.jsx)("p",{children:(0,i.jsx)(B.A,{defaultMessage:"Remove some files to stay within size limits",id:"k+ns1o6klw"})})]}),(0,i.jsxs)("div",{className:"flex gap-2 items-center",children:[r&&(0,i.jsx)(eh,{totalPercent:t,secondaryPercent:d}),r&&(0,i.jsx)("span",{className:"min-w-10 text-right",children:d>0?(0,i.jsx)(C.Tooltip,{tooltipContent:"".concat(ex(d),"% used by other knowledge + ").concat(ex(o),"% by this content"),children:(0,i.jsx)("span",{children:c})}):c})]})]})}function ec(e,t){if(void 0===e.children)return!1;if(q(t,e.path)){for(let s of e.children.values())if(!q(t,s.path)||ec(s,t))return!0}else for(let s of e.children.values())if(q(t,s.path)||ec(s,t))return!0;return!1}function eu(e){let{node:t,showPath:s,filters:l,sizeLimit:a,onUpdateFilters:r,onClick:n,onNavigate:o,enforceSizeLimit:d}=e,c=void 0!==t.children,u=q(l,t.path),x=ec(t,l);return(0,i.jsxs)("div",{onClick:n,className:(0,G.A)("group flex justify-start items-center gap-2 py-2 px-4 border-b-0.5 border-border-400 hover:bg-bg-100",{"cursor-pointer":n}),children:[(0,i.jsx)(y.f,{checkState:x?"partial":u?"checked":"unchecked",onClick:e=>{let{didCheck:s}=e;s?r(J(l,t.path)):r(V(l,t.path))}}),void 0===t.children?(0,i.jsx)(T.Z,{weight:"light",size:20,className:"flex-shrink-0 text-text-400"}):(0,i.jsx)(P.vd,{weight:"fill",className:"flex-shrink-0 text-accent-secondary-200",size:20}),(0,i.jsx)("div",{className:(0,G.A)("w-5/6 text-text-100 overflow-x-hidden text-ellipsis text-nowrap",{"text-text-200 group-hover:text-text-000":c}),onClick:e=>{c&&n&&(e.stopPropagation(),n())},children:s?(e=>{let t=e.replace(/^\/+|\/+$/g,"").split("/");return(0,i.jsx)("span",{children:t.map((e,s)=>{let l="/"+t.slice(0,s+1).join("/")+"/",a=s===t.length-1,r=!a&&o?e=>{e.stopPropagation(),o(l)}:void 0;return(0,i.jsxs)("span",{children:[(0,i.jsx)(a?"span":"button",{className:(0,G.A)(a?"text-text-000":"text-text-400",r?"hover:text-text-100 transition":""),onClick:r,children:e}),!a&&(0,i.jsx)("span",{className:"opacity-25 mx-1",children:"/"})]},s)})})})(t.path):t.name}),a&&d&&(0,i.jsxs)("span",{className:"w-1/6 text-text-400 text-xs text-right",children:[ex(100*t.size/a),"%"]})]})}function ex(e){let t;return 0===e?"0":e<1?"<1":(t=Math.ceil(e),new Intl.NumberFormat().format(t))}function eh(e){let{totalPercent:t,secondaryPercent:s=0}=e,l=t>=100,a=t-s;return(0,i.jsx)("div",{className:"bg-bg-100 border-0.5 border-border-300 w-24 h-2 rounded-full overflow-hidden relative",children:(0,i.jsxs)("div",{className:"absolute inset-0",children:[s>0?(0,i.jsx)("div",{style:{width:"".concat(Math.min(100,Math.max(0,s)),"%")},className:"absolute inset-y-0 left-0 bg-border-400"}):null,a>0?(0,i.jsx)("div",{style:{width:"".concat(Math.min(100-(s||0),Math.max(4*(a>0),a)),"%"),left:"".concat(s||0,"%")},className:(0,G.A)("absolute inset-y-0 transition-all",{"bg-danger-100":l,"bg-text-100":!l})}):null]})})}function ep(e){let{isOpen:t,onClose:s,onCreated:v,projectUuid:j,location:y,syncSource:w,setIsUploadingGithubSync:N}=e,{maxKbTokens:C}=(0,c.AO)(),S=((e,t)=>{let s=(0,u.Z3)(null),{stickyModelPreference:i}=(0,x.F)();return(e=>{var t,s,i,l,a,r;let n,o=(0,h.mV)(),d=(0,h.O9)(),u=(0,h.zc)(),{selectedTier:x,shouldOverrideTokenLimits:v,isTierSelectorEnabled:j}=(0,p.tg)(),y=j&&v&&!!x,w=(0,f.iW)("hatch_token_limits",b,c.RP),N=null!=(s=null!=(t=w[e])?t:w.default)?s:g;return null!=(n=(y?x===m.d7.MAX:u)?null==N||null==(i=N.max)?void 0:i.hardLimit:(y?x===m.d7.ENTERPRISE:o)?null==N||null==(l=N.raven)?void 0:l.hardLimit:(y?x===m.d7.PRO:d)?null==N||null==(a=N.pro)?void 0:a.hardLimit:null==N||null==(r=N.free)?void 0:r.hardLimit)?n:30500})(i||s)})(null),k="project"===y&&j?C:S,_=(0,c.ED)(j),A=(0,n.useMemo)(()=>{if(j&&void 0!==_){var e;return Math.max(0,_-((null==w||null==(e=w.status)?void 0:e.current_size_bytes)?w.type===r.v8.GITHUB?w.status.current_size_bytes/a.Pu:w.status.current_size_bytes/a.t2:0))}return 0},[j,_,w]),E=(0,n.useCallback)(e=>{null==v||v(e)},[v]),{mutate:M,isPending:I}=(0,d.pz)(j,{onSuccess:E,onError:()=>null==N?void 0:N(!1)}),{mutate:L,isPending:D}=(0,d.M3)(j,{onSuccess:s}),{mutate:z,isPending:T}=(0,o.EF)({onSuccess:E,onError:()=>null==N?void 0:N(!1)}),{mutate:P,isPending:G}=(0,o.VA)({onSuccess:s}),O=(0,n.useCallback)(e=>{w?("project"===y&&j?L:P)({sync_source_uuid:w.uuid,sync_source_config:e}):(null==N||N(!0),s(),("project"===y&&j?M:z)({sync_source_type:r.v8.GITHUB,sync_source_config:e}))},[w,y,j,M,L,z,P,s,N]);return(0,i.jsx)(l.aF,{isOpen:t,onClose:s,title:"Add content from GitHub",subtitle:"Select the files you would like to add to this ".concat(j?"project":"chat"),modalSize:"xl",hasCloseButton:!0,autoCloseOnFocusOut:!1,closeOnEscapeKeydown:!1,children:(0,i.jsx)("div",{className:"mt-2",children:(0,i.jsx)(X,{initialConfig:null==w?void 0:w.config,tokenLimit:k,alreadyUsedTokens:A,isSubmitting:I||D||T||G,onSubmit:O})})})}},0x1c03134a9:(e,t,s)=>{s.d(t,{$g:()=>c,V7:()=>u,X8:()=>x});let i=/docs\.google\.com\/document\/d\/([a-zA-Z0-9-_]+)/i,l=/docs\.google\.com\/spreadsheets\/d\/([a-zA-Z0-9-_]+)/i,a=/docs\.google\.com\/presentation\/d\/([a-zA-Z0-9-_]+)/i,r=/document\/d\/([a-zA-Z0-9-_]+)/i,n=/spreadsheets\/d\/([a-zA-Z0-9-_]+)/i,o=/presentation\/d\/([a-zA-Z0-9-_]+)/i,d=/(docs\.google\.com)|(drive\.google\.com)/i;function c(e){if(!e)return null;try{let t=new URL(e),s=!!t.toString().match(i),l=t.pathname.match(r);if(s&&l&&l[1])return l[1]}catch(e){}return null}function u(e){if(!e)return null;try{let t=new URL(e),s=t.toString();if(s.match(i)){let e=t.pathname.match(r);if(e&&e[1])return e[1]}if(s.match(l)){let e=t.pathname.match(n);if(e&&e[1])return e[1]}if(s.match(a)){let e=t.pathname.match(o);if(e&&e[1])return e[1]}}catch(e){}return null}function x(e){if(!e)return!1;try{return!!new URL(e).toString().match(d)}catch(e){}return!1}},0x1d1a079e9:(e,t,s)=>{s.d(t,{$:()=>y,u:()=>I});var i=s(0x52e2618c),l=s(0x22102fd88),a=s(0x6fe0a7f6),r=s(0x2471dc42f),n=s(0x14fe1b2a5),o=s(0x1b370f49d),d=s(0xb844abc8),c=s(0x18eb11a1c),u=s(0x10b8a0309),x=s(0x141440998),h=s(0x21014741c),p=s(0x1a1f6dda6),f=s(0xcaa21d58),m=s(0x38e6572),g=s(0x21fb79560);function b(){let e=(0,i._)(["\n  flex \n  flex-row \n  items-center \n  flex-1 \n  min-w-28\n"]);return b=function(){return e},e}function v(){let e=(0,i._)(["\n  flex \n  flex-col  \n  flex-1 \n  min-w-0\n"]);return v=function(){return e},e}function j(){let e=(0,i._)(["\n  font-small\n  text-text-500\n  text-ellipsis \n  break-words \n  whitespace-nowrap \n  min-w-0\n  overflow-hidden\n"]);return j=function(){return e},e}let y=e=>{let{item:t,onClick:s,isHighlighted:i,onMouseOver:n}=e,o=i&&!(0,d.fJ)(),f={disabled:t.isDisabled&&"upgrade"!==t.tag,onClick:t.isDisabled&&"upgrade"!==t.tag?void 0:()=>{"switch"===t.type&&t.onClick&&t.onClick(),null==s||s()},onMouseOver:n},b=t.isDisabled&&!t.rateLimitReached||"new chat"===t.tag||"upgrade"===t.tag&&!t.rateLimitReached;return"subheader"===t.type?(0,l.jsx)(w,{tooltip:t.tooltip,tooltipImage:t.tooltipImage,children:(0,l.jsx)(N,{...f,children:(0,l.jsx)(_,{children:t.label})})}):"button"===t.type?(0,l.jsx)(w,{tooltip:t.tooltip,tooltipImage:t.tooltipImage,children:(0,l.jsxs)(N,{className:(0,p.A)("primary"===t.variant&&"justify-center pr-4","primary"===t.variant&&o&&"!bg-accent-secondary-900/50 !text-accent-secondary-100"),isHighlighted:o,...f,hasSubtitle:!!t.subtitle,children:[(0,l.jsx)(C,{appearsDisabled:b,isHighlighted:o,itemKey:t.key,hasSubtitle:!!t.subtitle,children:t.icon}),(0,l.jsxs)(k,{children:[(0,l.jsxs)(S,{children:[(0,l.jsx)(A,{isHighlighted:o,appearsDisabled:b,children:t.label}),(0,l.jsx)(I,{tag:"upgrade"!==t.tag?t.tag:void 0})]}),(0,l.jsx)(E,{children:t.subtitle})]}),(0,l.jsx)(M,{className:"!text-text-500 opacity-70",children:t.secondaryText}),t.isExternal&&!t.tag&&(0,l.jsx)(c.B,{size:16,className:"text-text-500 opacity-70"}),"upgrade"===t.tag&&(0,l.jsx)(g.M,{})]})}):"buttonGroup"===t.type?(0,l.jsx)(w,{tooltip:t.tooltip,tooltipImage:t.tooltipImage,children:(0,l.jsxs)(N,{...f,isHighlighted:o,children:[(0,l.jsx)(C,{appearsDisabled:b,isHighlighted:o,itemKey:t.key,hasSubtitle:!!t.subtitle,children:t.icon}),(0,l.jsxs)(S,{children:[(0,l.jsx)(A,{isHighlighted:o,appearsDisabled:b,children:t.label}),(0,l.jsx)(I,{tag:t.tag})]}),(0,l.jsx)(u.K,{className:"h-4 w-4 text-text-500 opacity-80"})]})}):"toggleGroup"===t.type?(0,l.jsx)(w,{tooltip:t.tooltip,tooltipImage:t.tooltipImage,children:(0,l.jsxs)(N,{...f,isHighlighted:o,className:"group/toggleGroup",children:[(0,l.jsx)(C,{appearsDisabled:b,isHighlighted:o,itemKey:t.key,hasSubtitle:!!t.subtitle,children:t.icon}),(0,l.jsxs)(S,{children:[(0,l.jsx)(A,{isHighlighted:o,appearsDisabled:b,children:t.label}),(0,l.jsx)(I,{tag:t.tag})]}),(0,l.jsx)("div",{className:"flex items-center gap-2",children:void 0!==t.enabledCount?t.enabledCount>0?t.enabledCount===t.totalCount?t.onClick&&(0,l.jsx)("div",{onClick:e=>{var s;e.stopPropagation(),null==(s=t.onClick)||s.call(t)},children:(0,l.jsx)(r.j,{readOnly:!0,size:"small",checked:!0})}):(0,l.jsxs)("div",{className:"text-accent-secondary-200 h-5 text-xs bg-bg-400/50 rounded-full px-2 inline-flex items-center gap-1",children:[t.enabledCount,(0,l.jsx)("span",{className:"text-text-500 opacity-70",children:(0,l.jsx)(m.A,{defaultMessage:"of",id:"C9WGEuJVec"})}),(0,l.jsx)("span",{className:"text-text-500 opacity-70",children:t.totalCount})]}):t.onClick&&(0,l.jsx)("div",{onClick:e=>{var s;e.stopPropagation(),null==(s=t.onClick)||s.call(t)},children:(0,l.jsx)(r.j,{readOnly:!0,size:"small",checked:!1})}):null}),(0,l.jsx)(u.K,{className:"h-4 w-4 text-text-500 opacity-80"})]})}):"optionGroup"===t.type?(0,l.jsx)(w,{tooltip:t.tooltip,tooltipImage:t.tooltipImage,children:(0,l.jsxs)(N,{...f,isHighlighted:o,children:[(0,l.jsx)(C,{appearsDisabled:b,isHighlighted:o,itemKey:t.key,hasSubtitle:!!t.subtitle,children:t.icon}),(0,l.jsxs)(S,{children:[(0,l.jsx)(A,{isHighlighted:o,appearsDisabled:b,children:t.label}),(0,l.jsx)(I,{tag:t.tag})]}),(0,l.jsx)(M,{children:t.secondaryText}),(0,l.jsx)(u.K,{className:"h-4 w-4 text-text-500 opacity-80"})]})}):"toggleAll"===t.type||"toggle"===t.type||"switch"===t.type||"option"===t.type?(0,l.jsx)(w,{tooltip:t.tooltip,tooltipImage:t.tooltipImage,children:(0,l.jsxs)(N,{...f,hasSubtitle:!!t.subtitle,className:(0,p.A)("active:!scale-100",t.isChecked&&"text-primary-500"),isHighlighted:o,children:[(0,l.jsx)(C,{appearsDisabled:b,isHighlighted:o,itemKey:t.key,hasSubtitle:!!t.subtitle,children:t.icon}),(0,l.jsxs)(k,{children:[(0,l.jsxs)(S,{children:[(0,l.jsx)(A,{isHighlighted:o,appearsDisabled:b,children:t.label}),(0,l.jsx)(L,{tag:t.timeTag}),(0,l.jsx)(I,{tag:"upgrade"!==t.tag?t.tag:void 0})]}),(0,l.jsx)(E,{children:t.subtitle})]}),"toggleAll"===t.type&&(0,l.jsx)(a.Sc,{variant:"minus",disabled:!0,checked:t.isChecked,label:"",hideLabel:!0,className:(0,p.A)(b?"!cursor-default":"!opacity-100 !cursor-pointer")}),"toggle"===t.type&&(0,l.jsx)(a.Sc,{disabled:!0,checked:t.isChecked,label:"",hideLabel:!0,className:(0,p.A)(b?"!cursor-default":"!opacity-100 !cursor-pointer")}),"switch"===t.type&&"upgrade"===t.tag?(0,l.jsx)(g.M,{className:(0,p.A)(!!t.subtitle&&"mt-[0.25rem]")}):"switch"===t.type?(0,l.jsx)(r.j,{readOnly:!0,size:"small",checked:t.isChecked,className:(0,p.A)(!t.isDisabled&&"!cursor-pointer",b&&"opacity-50",!!t.subtitle&&"mt-[0.25rem]")}):null,"option"===t.type&&t.isChecked&&(0,l.jsx)(x.J,{weight:"bold",size:16,className:"text-accent-secondary-100 shrink-0"})]})}):"divider"===t.type?(0,l.jsx)("div",{className:"h-[0.5px] my-1.5 mx-0.5 bg-border-300"}):"back"===t.type?(0,l.jsx)(w,{tooltip:t.tooltip,tooltipImage:t.tooltipImage,children:(0,l.jsxs)(N,{...f,isHighlighted:o,children:[(0,l.jsx)(C,{itemKey:t.key,hasSubtitle:!!t.subtitle,children:(0,l.jsx)(h.n,{size:16,className:(0,p.A)("h-4 w-4 text-text-500 group-hover:!text-text-400",o&&"!text-text-400")})}),(0,l.jsx)("span",{className:"relative",children:(0,l.jsxs)(S,{children:[(0,l.jsx)(A,{className:(0,p.A)("opacity-100 transition-opacity text-text-500 group-hover:!text-text-400",o&&"!text-text-400"),children:t.label}),(0,l.jsx)(I,{tag:t.tag})]})})]})}):null},w=e=>{let{tooltip:t,tooltipImage:s,children:i}=e,a=(0,l.jsx)("div",{className:"",children:i});return t?(0,l.jsx)(o.Tooltip,{sideOffset:10,contentStyle:s?"sampleImage":"inputMenu",tooltipContent:(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[!!s&&(0,l.jsx)(f.default,{src:s.src,alt:"",width:s.width,height:s.height,className:"rounded-[6px] overflow-hidden"}),(0,l.jsx)("p",{className:"p-1",children:t})]}),side:"right",children:a}):a},N=e=>{let{isHighlighted:t,className:s,hasSubtitle:i,...a}=e;return(0,l.jsx)("button",{...a,className:(0,p.A)("group flex w-full text-left gap-2.5 py-auto px-1.5 font-base text-text-200 rounded-lg select-none items-center",t&&!a.disabled&&"!bg-bg-300/60 !text-text-000",s,!a.disabled&&"active:scale-[0.995] hover:bg-bg-300/60 hover:text-text-000",i?"h-[3rem]":"h-[2rem]")})},C=e=>{let{appearsDisabled:t,isHighlighted:s,itemKey:i,children:a,hasSubtitle:r,...n}=e;return(0,l.jsx)("div",{...n,className:(0,p.A)("group/icon min-w-4 min-h-4 flex items-center justify-center text-text-300 shrink-0",r&&"self-start pt-2.5",t&&"opacity-50",s&&!t&&"!text-text-100",!t&&"group-hover:text-text-100",n.className),children:a})},S=n.J.div(b()),k=n.J.div(v()),_=e=>{let{className:t,...s}=e;return(0,l.jsx)("p",{...s,className:(0,p.A)("font-small text-text-500 text-ellipsis break-words whitespace-nowrap min-w-0 overflow-hidden",t)})},A=e=>{let{appearsDisabled:t,isHighlighted:s,className:i,...a}=e;return(0,l.jsx)("p",{...a,className:(0,p.A)("font-base text-text-300 text-ellipsis break-words whitespace-nowrap min-w-0 overflow-hidden",s&&!t&&"!text-text-100",i,t&&"opacity-50",!t&&"group-hover:text-text-100")})},E=n.J.p(j()),M=e=>{let{className:t,...s}=e;return s.children?(0,l.jsx)("p",{...s,className:(0,p.A)("flex-initial text-right shrink font-base text-accent-secondary-100 text-ellipsis break-words whitespace-nowrap min-w-0 overflow-hidden",t)}):null},I=e=>{let{tag:t,className:s}=e;return t?(0,l.jsx)("div",{className:(0,p.A)("uppercase inline-flex items-center text-[0.5625rem] font-medium h-4 px-2 rounded-2xl ml-2.5 relative top-[1px] shrink-0 will-change-transform",("new chat"===t||"alpha"===t)&&"text-text-300 bg-bg-300/60",("pro"===t||"beta"===t)&&"text-accent-secondary-100 bg-accent-secondary-100/[8%]","upgrade"===t&&"border border-border-400 text-accent-secondary-000",s),children:t}):null},L=e=>{let{tag:t,className:s}=e;return t?(0,l.jsx)("div",{className:(0,p.A)("text-text-500 bg-bg-100 inline-flex items-center text-[0.5625rem] h-4 px-2 rounded-2xl ml-2.5 relative top-[1px] shrink-0",s),children:t}):null}},0x1f92f9b94:(e,t,s)=>{s.d(t,{br:()=>F,Tc:()=>I});var i=s(0x22102fd88),l=s(0x1a2392a8c),a=s(0x865afcc2),r=s(0x1d0c32e96),n=s(0x1b370f49d),o=s(0x1b813d90);let d=e=>e===o.I5.ACCESS_DENIED||e===o.I5.UNAUTHENTICATED||e===o.I5.DISABLED;o.v8.GDRIVE,o.v8.GITHUB,o.v8.OUTLINE,o.v8.SALESFORCE,o.v8.GMAIL,o.v8.GCAL,o.v8.SLACK,o.v8.ASANA,o.v8.CANVAS,o.v8.FIDDLEHEAD,o.v8.CUTTLEFISH,o.v8.MCP_RESOURCES;var c=s(0xf90d4e1e),u=s(0xfc89b4a4),x=s(0x1ab0d1ca1),h=s(0x38e6572),p=s(0x195e308ca),f=s(0x1334f6ecc),m=s(0x1065e58a2),g=s(0xf8bd7957),b=s(0xe824fb1c),v=s(0x1a28f0915),j=s(0x14de19ae8),y=s(0x139b5e710),w=s(0x183548b63),N=s(0xbb84ce70),C=s(0x14c0dfde7),S=s(0x25062734b);let k=e=>{let{isOpen:t,onClose:s,syncSource:l,server:a}=e,r=(0,x.A)(),{addError:n}=(0,y.Y)(),[o,d]=(0,u.useState)(null),[c,p]=(0,u.useState)(!1),[f,m]=(0,u.useState)(),g=(0,C.p9)(),{activeOrganization:v}=(0,j.YL)(),k=null==v?void 0:v.uuid,{mutateAsync:_}=(0,S.Ax)(),A=(0,u.useCallback)(async()=>{if(!a)return void n(r.formatMessage({defaultMessage:"MCP server not connected. Please reconnect the server to view this resource.",id:"dZx3khOR0+"}),{messageForLogging:"MCP server not connected. Please reconnect the server to view this resource."});p(!0);try{if(g&&k&&!(0,b.HG)(a.uuid,g)){let s=new URL(l.config.resource.uri);s.searchParams.set("includeContent","true");let i=(await _({resource_uri:s.toString(),server_uuid:a.uuid})).read_resource_result;if(i&&i.contents.length>0){var e,t;let s=i.contents[0];(e=>"text"in e&&"string"==typeof e.text)(s)?(d(s.text),m(null!=(e=s.mimeType)?e:void 0)):(e=>"blob"in e&&"string"==typeof e.blob)(s)&&(d(r.formatMessage({defaultMessage:"Binary content cannot be displayed in this preview.",id:"wsDLz6BmPt"})),m(null!=(t=s.mimeType)?t:void 0))}else d(r.formatMessage({defaultMessage:"No content available",id:"eS0BrNV2g3"}))}else{let e=(0,b.KU)(a.uuid),t=new URL(l.config.resource.uri);t.searchParams.set("includeContent","true");let s=await e.readResource({uri:t.toString()},{timeout:15e3});if(s.contents.length>0){let e=s.contents[0];"text"in e?(d(e.text),m(e.mimeType)):"blob"in e&&(d(r.formatMessage({defaultMessage:"Binary content cannot be displayed in this preview.",id:"wsDLz6BmPt"})),m(e.mimeType))}else d(r.formatMessage({defaultMessage:"No content available",id:"eS0BrNV2g3"}))}}catch(e){n("Failed to read resource. You can try again.",{error:e}),d(null)}finally{p(!1)}},[a,n,r,g,k,l.config.resource.uri,_]);(0,u.useEffect)(()=>{!t||o||c||A()},[t,o,c,A]);let E=l.config.resource.title||l.config.resource.name||l.config.resource.uri,M=c?(0,i.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,i.jsx)(N.j,{className:"h-32 w-full"})}):o?(0,i.jsxs)("div",{className:"h-full overflow-hidden flex flex-col",children:[(0,i.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,i.jsx)("pre",{className:"p-4 whitespace-pre-wrap break-all text-xs font-mono text-text-300",children:o})}),f&&(0,i.jsxs)("div",{className:"px-4 py-2 border-t border-border-300 text-sm text-text-500",children:[(0,i.jsx)(h.A,{defaultMessage:"Type:",id:"uS4soppacp"})," ",f]})]}):(0,i.jsx)("div",{className:"flex items-center justify-center h-full text-text-500 text-center p-4",children:(0,i.jsx)(h.A,{defaultMessage:"Unable to load content. Please ensure the MCP server is connected.",id:"Go4pdaSjWh"})});return(0,i.jsx)(w.aF,{isOpen:t,hasCloseButton:!0,title:E,onClose:s,className:"w-[40rem] h-[24rem]",modalSize:"xl",children:M})};var _=s(0xae0386ed),A=s(0x53e6c5ac);let E=e=>{let t=(0,x.A)(),s={[o.I5.UNAUTHENTICATED]:t.formatMessage({defaultMessage:"Authentication needed",id:"AYP3OHxyGn"}),[o.I5.ACCESS_DENIED]:t.formatMessage({defaultMessage:"Content not accessible",id:"IPK01iLM7n"}),[o.I5.DISABLED]:t.formatMessage({defaultMessage:"Feature disabled by organization",id:"0mkp6rxalw"})};return e in s?s[e]:void 0},M=e=>{var t;let{syncSourceType:s,syncStatus:a,title:r,url:n,handleClick:c,isLoading:u,actions:x,isSyncing:h,tag:f,mcpServer:m,...g}=e,b=d(a),v=E(a),j=(0,p.v)(),y={};return y=a===o.I5.UNAUTHENTICATED?{handleClick:()=>{j(s,m)}}:c?{handleClick:c}:{url:n},(0,i.jsx)(l.Iq,{...g,actions:x,title:null!=(t=null!=v?v:r)?t:"Untitled",tag:null!=f?f:(0,i.jsx)(D,{type:s}),isError:b,isLoading:u,isSyncing:h,...y})},I=e=>{let{syncSourceType:t,syncStatus:s,url:l,...r}=e,n=d(s),c=E(s),u=(0,p.v)(),x={};return(x=s===o.I5.UNAUTHENTICATED?{handleClick:()=>{u(t)}}:{url:l},n)?(0,i.jsx)(a.$,{...r,...x,isError:!0,title:c,subtitles:void 0,tag:void 0}):(0,i.jsx)(a.$,{...r,...x})},L={[o.v8.GDRIVE]:"DOC",[o.v8.OUTLINE]:"DOC",[o.v8.GITHUB]:"GITHUB",[o.v8.SALESFORCE]:"SALESFORCE",[o.v8.GMAIL]:"EMAIL",[o.v8.GCAL]:"CALENDAR",[o.v8.SLACK]:"SLACK",[o.v8.ASANA]:"ASANA",[o.v8.CANVAS]:"LTI",[o.v8.FIDDLEHEAD]:"FIDDLEHEAD",[o.v8.CUTTLEFISH]:"CUTTLEFISH",[o.v8.MCP_RESOURCES]:"MCP"},D=e=>{let{type:t}=e;return(0,i.jsxs)(l.G,{children:[(0,i.jsx)(r.A9,{type:t,size:12,variant:t===o.v8.GDRIVE?r.UF.DOCS:void 0}),(0,i.jsx)("p",{className:"uppercase truncate font-ui text-text-300 text-[11px] leading-[13px]",children:L[t]})]})},z=e=>{let{projectUuid:t,syncSource:s,location:l,actions:a,isSyncing:r,...n}=e,[o,c]=(0,u.useState)(!1),{owner:x,repo:h}=s.config,p="".concat(x,"/").concat(h),f=s.config.branch,m=!d(s.status.state),g=n.isEditable&&m,b=g||n.isInSelectionMode;return(0,i.jsxs)(i.Fragment,{children:[g&&(0,i.jsx)(v.s,{projectUuid:t,location:l,isOpen:o,onClose:()=>c(!1),syncSource:s}),(0,i.jsx)(M,{...n,syncSourceType:s.type,syncStatus:s.status.state,title:p,subtitle:f,handleClick:b?()=>{if(n.isInSelectionMode){var e;null==(e=n.handleSelect)||e.call(n,!0,!1)}c(!0)}:void 0,actions:a,isSyncing:r})]})},T=e=>{let{syncSource:t,actions:s,isSyncing:l,...a}=e,r=(0,A.d)(t.config.uri),{title:n,isLoading:o}=(0,f.zF)({uri:t.config.uri}),d=a.isInSelectionMode?()=>{var e;null==(e=a.handleSelect)||e.call(a,!0,!1)}:void 0;return(0,i.jsx)(M,{handleClick:d,...a,syncSourceType:t.type,syncStatus:t.status.state,title:n,url:r,isLoading:a.isLoading||o,actions:s,isSyncing:l})},P=e=>{let{syncSource:t,actions:s,isSyncing:l,...a}=e,r=(0,A.S)(t.config.outline_uri),{title:n,isLoading:o}=(0,m.n0)({uri:t.config.outline_uri}),d=a.isInSelectionMode?()=>{var e;null==(e=a.handleSelect)||e.call(a,!0,!1)}:void 0;return(0,i.jsx)(M,{handleClick:d,...a,syncSourceType:t.type,syncStatus:t.status.state,title:n,url:r,isLoading:a.isLoading||o,actions:s,isSyncing:l})},G=e=>{let{resource:t,server:s}=e,a=(0,_.q)(t.uri),r=(0,u.useRef)(null),[o,d]=(0,u.useState)(!1),x=(0,_.c)(null==s?void 0:s.name);(0,u.useEffect)(()=>{let e=r.current;if(!e)return;let t=new ResizeObserver(t=>{for(let s of t)s.contentRect.width>0&&d(e.scrollWidth>e.clientWidth)});t.observe(e);let s=()=>{e.clientWidth>0&&d(e.scrollWidth>e.clientWidth)},i=setTimeout(s,100);return requestAnimationFrame(()=>{s(),requestAnimationFrame(s)}),()=>{t.disconnect(),clearTimeout(i)}},[x]);let h=(0,i.jsx)("p",{ref:r,className:"truncate font-ui text-text-300 text-[11px] leading-[13px]",children:x});return(0,i.jsxs)(l.G,{className:"group",children:[(0,i.jsxs)("div",{className:"relative flex items-center justify-center",children:[(0,i.jsx)("div",{className:a?"group-hover:opacity-0 transition-opacity duration-200":"",children:(0,i.jsx)(g.z,{type:"favicon",src:(null==s?void 0:s.url)||"",size:12,name:x})}),a&&(0,i.jsx)(c.Q,{size:12,className:"text-text-400 absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-200",weight:"regular"})]}),o?(0,i.jsx)(n.Tooltip,{tooltipContent:x,side:"bottom",align:"end",sideOffset:5,children:h}):h]})},O=e=>{let{syncSource:t,actions:s,isSyncing:l,projectUuid:a,...r}=e,[c,x]=(0,u.useState)(!1),p=(0,b.Uz)({uuid:t.config.server_uuid})[0],f=t.config.resource.title||t.config.resource.name||t.config.resource.uri,m=t.config.resource.uri,g=(0,_.q)(m),v=(0,u.useCallback)(()=>{if(r.isInSelectionMode){var e;null==(e=r.handleSelect)||e.call(r,!0,!1)}else r.isEditable&&!g&&x(!0)},[r,g]),j=g&&t.status.state!==o.I5.UNAUTHENTICATED&&!d(t.status.state),y=(0,i.jsx)(M,{...r,syncSourceType:t.type,syncStatus:t.status.state,title:f,url:j?m:void 0,handleClick:j?void 0:v,mcpServer:p?{uuid:p.uuid,url:p.url}:void 0,tag:(0,i.jsx)(G,{resource:t.config.resource,server:p}),actions:s,isSyncing:l,isLoading:r.isLoading});return(0,i.jsxs)(i.Fragment,{children:[r.isEditable&&!g&&(0,i.jsx)(k,{isOpen:c,onClose:()=>x(!1),syncSource:t,server:p}),g?(0,i.jsx)(n.Tooltip,{tooltipContent:(0,i.jsx)(h.A,{defaultMessage:"View original",id:"6nLwtulOHW"}),side:"bottom",sideOffset:5,children:(0,i.jsx)("div",{children:y})}):y]})},F=e=>{let{projectUuid:t,syncSource:s,isEditable:a=!1,location:r,actions:n,isSyncing:d,...c}=e;return(null==s?void 0:s.type)?s.type===o.v8.GITHUB?(0,i.jsx)(z,{...c,projectUuid:t,syncSource:s,isEditable:a,location:r,actions:n,isSyncing:d}):s.type===o.v8.GDRIVE?(0,i.jsx)(T,{...c,syncSource:s,isEditable:a,actions:n,isSyncing:d}):s.type===o.v8.OUTLINE?(0,i.jsx)(P,{...c,syncSource:s,isEditable:a,actions:n,isSyncing:d}):s.type===o.v8.MCP_RESOURCES?(0,i.jsx)(O,{...c,syncSource:s,isEditable:a,actions:n,isSyncing:d,projectUuid:t}):void 0:(0,i.jsx)(l.NG,{})}}}]);