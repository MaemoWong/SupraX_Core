try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="e096f2b8-1d88-456b-9915-f495c75b756f",e._sentryDebugIdIdentifier="sentry-dbid-e096f2b8-1d88-456b-9915-f495c75b756f")}catch(e){}{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=Object.assign({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:anthropic-apps":!0})}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[72725],{0x6700eaaa:(e,n,t)=>{t.d(n,{ak:()=>l,cO:()=>i,xI:()=>o});var a=t(0x1b813d90),r=t(0x10a2d47e3);let i="settings",o=e=>a.sb[e]||e,l=()=>{let e=(0,r.wc)();return n=>n===a.v8.FIDDLEHEAD&&e[r.Wj]?e[r.Wj]:n===a.v8.CUTTLEFISH&&e[r.in]?e[r.in]:a.sb[n]||n}},0xe0c26d90:(e,n,t)=>{t.d(n,{tn:()=>w,nB:()=>p,rW:()=>v,bo:()=>L,Cq:()=>m,b4:()=>y,yL:()=>_,VX:()=>S});var a=t(0x12c9046cd),r=t(0x14de19ae8),i=t(0x49fac030),o=t(0xac309a83),l=t(0x1b813d90),u=t(0x1bd175d8c),d=t(0x17e725145),s=t(0x20892a038),c=t(0x4d348f95),f=t(0xfc89b4a4),h=t(0x21fe74567),g=t(0x18175ce17),b=t(0xc6857cab);let x="github_success",p=function(){var e;let{callerIdentifier:n,toggleGithubModalOpen:t,fetchImmediately:o=!1,pathname:l,queryString:d,shouldRedirectToDesktopApp:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:b}=(0,r.YL)(),p=null==b?void 0:b.uuid,v=m(),[y,_]=(0,f.useState)(o),w=(e=>{let{shouldFetch:n=!1}=e,{activeOrganization:t}=(0,r.YL)(),o=null==t?void 0:t.uuid,l=m();return(0,a.Sk)("/api/organizations/".concat(o,"/sync/github/auth"),{queryKey:[i.Hv,{orgUuid:o}],enabled:!!(n&&t&&l),meta:{noToast:!0}})})({shouldFetch:y}),L=(0,f.useCallback)(async function(){var e,n;let{forceRefetch:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!y||t?(_(!0),null==(e=(await w.refetch()).data)?void 0:e.is_authenticated):null==(n=w.data)?void 0:n.is_authenticated},[w,y]),{mutate:S}=(0,a.L2)("/api/organizations/".concat(p,"/sync/github/auth/start"),"POST",{enabled:!!(b&&v),onSuccess:e=>{if(function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(0===n.length)return!1;try{if(!e.startsWith("http://")&&!e.startsWith("https://"))return!1;let t=new URL(e);return"https:"===t.protocol&&n.some(e=>t.hostname===e||t.hostname.endsWith(".".concat(e)))}catch(e){return!1}}(e.redirect_url,["github.com"]))window.location.href=e.redirect_url;else throw Error("Invalid redirect URL received from auth endpoint")}}),C="".concat(x,"=").concat(n).concat(d?"&".concat(d):"");(0,g.FZ)({callerIdentifier:n,successParam:x,handleOpen:()=>{null==t||t(!0)}});let j=(0,c.useSearchParams)(),E=(0,u.V)(),I=(0,f.useRef)(!1),k=(0,c.usePathname)(),D=(0,h.d)({pathname:l||k,searchParams:j,queryString:C,shouldOpenInClaudeApp:E||!!s});return{checkIsGithubAuthenticated:L,initGithubAuth:()=>{if(v){if(E)return void window.open("/settings/connectors?open_in_browser=1&auth_start=github&origin=".concat(D));I.current||(I.current=!0,S({pre_auth_state:{origin:D}}))}},isGithubAuthenticated:null==(e=w.data)?void 0:e.is_authenticated,isLoading:w.isLoading}},v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:n}=(0,r.YL)(),t=null==n?void 0:n.uuid,o=m(),l=(0,d.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(t,"/sync/github/auth"),"DELETE",{enabled:!!(n&&o),...e,onSuccess:function(){for(var n,a=arguments.length,r=Array(a),o=0;o<a;o++)r[o]=arguments[o];l.invalidateQueries({queryKey:[i.Hv,{orgUuid:t}]}),null==(n=e.onSuccess)||n.call(e,...r)}})},m=()=>{let{data:e}=(0,g.LN)(),n=(0,r.mV)(),t=!!(Array.isArray(e)&&e.find(e=>e.type===l.v8.GITHUB&&e.enabled));return!!(!b.env.NEXT_PUBLIC_DISABLE_GITHUB_INTEGRATION&&(!n||t))},y=()=>{let{activeOrganization:e}=(0,r.YL)(),n=null==e?void 0:e.uuid,t=m();return(0,a.Sk)("/api/organizations/".concat(n,"/sync/github/repos"),{queryKey:[i.jL,{orgUuid:n}],enabled:!!(e&&t),meta:{noToast:!0}})},_=function(){let{skipStatus:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:n}=(0,r.YL)(),t=null==n?void 0:n.uuid,i=m(),l=(0,o.fS)("bad_moon_rising_skip_status"),u=null!=e?e:l,d=new URLSearchParams({skip_status:u.toString()}).toString();return(0,a.Sk)("/api/organizations/".concat(t,"/code/repos?").concat(d),{queryKey:["SYNC_GH_REPOS_WITH_STATUS_QUERY_KEY",{orgUuid:t,skipStatus:u}],enabled:!!(n&&t&&i),meta:{noToast:!0}})},w=e=>{var n;let{owner:t,repo:o,branch:l}=e,u=(e=>{let{owner:n,repo:t,branch:o}=e,{activeOrganization:l}=(0,r.YL)(),u=null==l?void 0:l.uuid,d=m(),s=new URLSearchParams({owner:null!=n?n:"",repo:null!=t?t:""}).toString();return(0,a.Sk)("/api/organizations/".concat(u,"/sync/github/repo?").concat(s),{queryKey:[i.yB,{orgUuid:u,owner:n,repo:t}],enabled:!!(n&&t&&!o&&l&&d),meta:{noToast:!0}})})({owner:t,repo:o,branch:l}),d=(e=>{let{owner:n,repo:t,branch:o}=e,{activeOrganization:l}=(0,r.YL)(),u=null==l?void 0:l.uuid,d=m();return(0,a.Sk)("/api/organizations/".concat(u,"/sync/github/repo/").concat(n,"/").concat(t,"/tree/").concat(o),{queryKey:[i.o6,{orgUuid:u,owner:n,repo:t,branch:o}],staleTime:3e5,enabled:!!(n&&t&&o&&l&&d),meta:{noToast:!0}})})({owner:t,repo:o,branch:l||(null==(n=u.data)?void 0:n.default_branch)});return{data:{repo:u.data,tree:d.data},isFetching:u.isFetching||d.isFetching,error:u.error||d.error}},L=e=>{let{repoBranches:n,enabled:t=!0}=e,{activeOrganization:a}=(0,r.YL)(),o=null==a?void 0:a.uuid,l=m(),u=[...n].sort((e,n)=>"".concat(e.repo,":").concat(e.branch).localeCompare("".concat(n.repo,":").concat(n.branch)));return(0,s.useQuery)({queryKey:[i.uh,{orgUuid:o,repoBranches:u}],queryFn:async()=>{let e=await fetch("/api/github/organizations/".concat(o,"/github_batch_branch_status"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({repo_branches:u})});if(!e.ok)throw Error("Failed to fetch branch statuses: ".concat(e.status));return e.json()},enabled:!!(a&&l&&u.length>0&&t),staleTime:5e3,refetchOnWindowFocus:!0})},S=e=>{let n,{repo:t,branch:a,enabled:o=!0}=e,{activeOrganization:l}=(0,r.YL)(),u=null==l?void 0:l.uuid,c=(0,d.useQueryClient)(),f=[i.uh,{orgUuid:u}];for(let[,e]of c.getQueriesData({queryKey:f,exact:!1}))if((null==e?void 0:e.branch_statuses)&&(n=e.branch_statuses.find(e=>e.repo===t&&e.branch===a)))break;let{data:h}=(e=>{let{repo:n,branch:t,enabled:a=!0}=e,{activeOrganization:o}=(0,r.YL)(),l=null==o?void 0:o.uuid,u=m();return(0,s.useQuery)({queryKey:[i.i8,{orgUuid:l,repo:n,branch:t}],queryFn:async()=>{let e=await fetch("/api/github/organizations/".concat(l,"/github_batch_branch_status"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({repo_branches:[{repo:n,branch:t}]})});if(!e.ok)throw Error("Failed to fetch single branch status: ".concat(e.status));return(await e.json()).branch_statuses[0]},enabled:!!(o&&u&&n&&t&&a),staleTime:5e3,refetchOnWindowFocus:!0})})({repo:t,branch:a,enabled:o});return!h&&n?n:h&&!n||h?h:void 0}},0xecd80d84:(e,n,t)=>{t.d(n,{Qp:()=>c,eF:()=>s,w5:()=>d});var a=t(0x12c9046cd),r=t(0x14de19ae8),i=t(0xac309a83),o=t(0x10a2d47e3),l=t(0x17e725145),u=t(0x4d348f95);let d=()=>(0,i.fS)("fiddlehead"),s=()=>{let{activeOrganization:e}=(0,r.YL)(),n=null==e?void 0:e.uuid,t=d(),i=(0,o.wc)(),{data:l,isFetched:s}=(0,a.Sk)("/api/oauth/organizations/".concat(n,"/oauth_tokens"),{enabled:!!(n&&t),staleTime:3e5}),c=(0,u.useSearchParams)().get("debug_fiddlehead_auth_override"),f=i[o.me],h=f&&(null==l?void 0:l.some(e=>e.application_name===f));return{isAuthenticated:null!==c?"1"===c:h,isFetched:s,initAuth:()=>{window.open(i[o.vf],"_blank")}}},c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:n}=(0,r.YL)(),t=null==n?void 0:n.uuid,i=d(),o=(0,l.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(t,"/fiddlehead/disconnect_and_delete_all"),"POST",{enabled:!!(n&&i),...e,onSuccess:function(){for(var n,a=arguments.length,r=Array(a),i=0;i<a;i++)r[i]=arguments[i];o.invalidateQueries({queryKey:["/api/oauth/organizations/".concat(t,"/oauth_tokens")]}),null==(n=e.onSuccess)||n.call(e,...r)}})}},0xfb91a209:(e,n,t)=>{t.d(n,{Q:()=>u,t:()=>d});var a=t(0x22102fd88),r=t(0x286b4261),i=t.n(r),o=t(0xfc89b4a4);let l=(0,o.createContext)({isOpen:!1,dropdownToOpen:void 0,openModal:i(),closeModal:i(),clearCallerIdentifier:i()}),u=e=>{let{children:n}=e,[t,r]=(0,o.useState)(!1),i=(0,o.useRef)(void 0),[u,d]=(0,o.useState)(void 0);return(0,a.jsx)(l.Provider,{value:{isOpen:t,openModal:e=>{r(!0),i.current=e},closeModal:()=>{r(!1),d(i.current)},dropdownToOpen:u,clearCallerIdentifier:()=>{d(void 0)}},children:n})},d=()=>(0,o.useContext)(l)},0x1065e58a2:(e,n,t)=>{t.d(n,{AI:()=>d,I5:()=>s,n0:()=>u,qp:()=>c,so:()=>f});var a=t(0x12c9046cd),r=t(0x14de19ae8),i=t(0x49fac030);t(0x1b813d90);var o=t(0x17e725145);t(0xfc89b4a4);var l=t(0x18175ce17);let u=e=>{let{uri:n}=e,{data:t,isLoading:o}=(e=>{let{documentId:n}=e,{account:t,activeOrganization:o}=(0,r.YL)(),l=null==t?void 0:t.uuid,u=null==o?void 0:o.uuid,s=d();return(0,a.Sk)("/api/organizations/".concat(u,"/sync/mcp/outline/document/").concat(n),{queryKey:[i.hq,{accountUUID:l,orgUuid:u,documentId:n}],enabled:s})})({documentId:n});return{title:null==t?void 0:t.title,isLoading:o}},d=()=>{let{data:e}=(0,l.LN)();return!1},s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{account:n,activeOrganization:t}=(0,r.YL)(),o=null==t?void 0:t.uuid,l=d(),{data:u,refetch:s}=(0,a.Sk)("/api/organizations/".concat(o,"/sync/mcp/outline/auth"),{queryKey:[i.iP,{accountUUID:null==n?void 0:n.uuid,orgUuid:o}],enabled:!!(t&&l),staleTime:5e3}),{mutate:c,isPending:f}=(0,a.L2)("/api/organizations/".concat(o,"/sync/mcp/outline/auth/start"),"POST",{enabled:!!(t&&l),...e,onSuccess:function(){for(var n,t=arguments.length,a=Array(t),r=0;r<t;r++)a[r]=arguments[r];null==(n=e.onSuccess)||n.call(e,...a)}});return{isOutlineAuthenticated:!!(null==u?void 0:u.is_authenticated),refetch:s,initOutlineAuth:c,isLoadingOutlineAuthInit:f}},c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{account:n,activeOrganization:t}=(0,r.YL)(),l=null==n?void 0:n.uuid,u=null==t?void 0:t.uuid,s=d(),c=(0,o.useQueryClient)();return(0,a.L2)("/api/organizations/".concat(u,"/sync/mcp/outline/auth"),"DELETE",{enabled:!!(t&&s),...e,onSuccess:function(){for(var n,t=arguments.length,a=Array(t),r=0;r<t;r++)a[r]=arguments[r];c.invalidateQueries({queryKey:[i.iP,{accountUUID:l,orgUuid:u}]}),null==(n=e.onSuccess)||n.call(e,...a)}})},f=()=>{let e=encodeURIComponent(window.location.href);window.location.href="/settings/connectors?redirect_url=".concat(e,"&open_outline_auth=true")}},0x11c7a82c2:(e,n,t)=>{t.d(n,{R:()=>l});var a=t(0x22102fd88),r=t(0xfc89b4a4),i=t(0x225bae024),o=t(0x183548b63);let l=(0,r.memo)(e=>{let{isOpen:n,onClose:t,onConfirm:l,title:u,message:d,confirmText:s="Confirm",cancelText:c="Cancel",variant:f="primary",isLoading:h,disabled:g=!1,autoFocus:b=!0,testId:x,children:p,size:v="sm"}=e,[m,y]=(0,r.useState)(!1),_=null!=h?h:m,w=(0,r.useCallback)(async()=>{if(!g&&!_){y(!0);try{let e=l();e&&"function"==typeof e.then&&await e,t()}finally{y(!1)}}},[l,t,g,_]),L=(0,r.useCallback)(()=>{_||t()},[t,_]);return(0,a.jsxs)(o.aF,{isOpen:n,onClose:L,title:u,modalSize:v,closeOnEscapeKeydown:!_,children:[(0,a.jsxs)("div",{className:"mt-1 mb-2",children:[d&&(0,a.jsx)("div",{className:"text-text-300 whitespace-pre-line",children:d}),p]}),(0,a.jsxs)(o.vW,{children:[(0,a.jsx)(i.$,{variant:"secondary",onClick:L,disabled:_,children:c}),(0,a.jsx)(i.$,{variant:"danger"===f?"danger":"primary",onClick:w,disabled:g||_,loading:_,autoFocus:b,"data-testid":x||"confirmation-modal-confirm",children:s})]})]})});l.displayName="ConfirmationModal"},0x132295873:(e,n,t)=>{t.d(n,{m:()=>v});var a=t(0x22102fd88),r=t(0x19273021e),i=t(0x14de19ae8),o=t(0x139b5e710),l=t(0x11c7a82c2),u=t(0x1b813d90),d=t(0x10a2d47e3),s=t(0xfc89b4a4),c=t(0x1ab0d1ca1),f=t(0x1d302b010),h=t(0x1334f6ecc),g=t(0xecd80d84),b=t(0xe0c26d90),x=(t(0x1065e58a2),t(0x18175ce17)),p=t(0x6700eaaa);function v(e){let{type:n,server:t,onClose:r,onDisconnect:i}=e;if(t)return(0,a.jsx)(w,{server:t,onClose:r,onDisconnect:i});switch(n){case u.v8.GITHUB:return(0,a.jsx)(m,{onClose:r,onDisconnect:i});case u.v8.GDRIVE:return(0,a.jsx)(y,{onClose:r,onDisconnect:i});case u.v8.OUTLINE:return;case u.v8.FIDDLEHEAD:return(0,a.jsx)(L,{onClose:r,onDisconnect:i});case u.v8.CUTTLEFISH:return(0,a.jsx)(S,{onClose:r,onDisconnect:i});default:return(0,a.jsx)(_,{type:n,onClose:r,onDisconnect:i})}}function m(e){let{onClose:n,onDisconnect:t}=e,{mutate:r,isPending:i}=(0,b.rW)(),o=(0,s.useCallback)(()=>{r(),null==t||t()},[r,t]);return(0,a.jsx)(C,{name:"GitHub",onDisconnect:o,disconnecting:i,onClose:n})}function y(e){let{onClose:n,onDisconnect:t}=e,{mutate:r,isPending:i}=(0,h.U5)(),o=(0,c.A)(),l=(0,s.useCallback)(()=>{r(),null==t||t()},[r,t]);return(0,a.jsx)(C,{name:"Google Drive",onDisconnect:l,disconnecting:i,onClose:n,modalMessageOverride:o.formatMessage({defaultMessage:"You won’t be able to continue any previous chats that reference content from Google Docs.",id:"Zi7eVRnAwf"})})}function _(e){let{type:n,onClose:t,onDisconnect:r}=e,{disconnect:i}=(0,x.ob)(n),o=(0,s.useCallback)(()=>{i(),null==r||r()},[i,r]);return(0,a.jsx)(C,{name:(0,p.xI)(n),onDisconnect:o,disconnecting:!1,onClose:t})}function w(e){let{server:n,onClose:t,onDisconnect:r}=e,l=(0,c.A)(),{activeOrganization:u}=(0,i.YL)(),{addError:d}=(0,o.Y)(),{mutate:h,isPending:g}=(0,f.W3)((null==u?void 0:u.uuid)||"",n.uuid,{onError:e=>{d(l.formatMessage({defaultMessage:"Failed to disconnect from server",id:"L488a5jdgF"}),{error:e,messageForLogging:"Failed to disconnect from server"})}}),b=(0,s.useCallback)(()=>{h(),null==r||r()},[h,r]);return(0,a.jsx)(C,{name:n.name,onDisconnect:b,disconnecting:g,onClose:t})}function L(e){let{onClose:n,onDisconnect:t}=e,{mutate:r,isPending:i}=(0,g.Qp)(),o=(0,p.ak)(),l=(0,d.wc)(),c=l[d.BU],f=l[d.jT],h=l[d.fh],b=(0,s.useCallback)(()=>{r(),null==t||t()},[r,t]);return(0,a.jsx)(C,{name:o(u.v8.FIDDLEHEAD),onDisconnect:b,disconnecting:i,onClose:n,modalMessageOverride:c,modalTitleOverride:f,modalButtonOverride:h})}function S(e){let{onClose:n,onDisconnect:t}=e,{mutate:i,isPending:o}=(0,r.fH)(),l=(0,p.ak)(),d=(0,s.useCallback)(()=>{i(),null==t||t()},[i,t]);return(0,a.jsx)(C,{name:l(u.v8.CUTTLEFISH),onDisconnect:d,disconnecting:o,onClose:n})}function C(e){let{name:n,onDisconnect:t,disconnecting:r,onClose:i,modalMessageOverride:o,modalTitleOverride:u,modalButtonOverride:d}=e,s=(0,c.A)(),f=null!=u?u:s.formatMessage({defaultMessage:"Disconnect {integrationName}?",id:"MUrNVj88RO"},{integrationName:n}),h=null!=d?d:s.formatMessage({defaultMessage:"Disconnect",id:"qj1uhzynub"}),g=null!=o?o:s.formatMessage({defaultMessage:"You can still continue previous chats that reference {integrationName} content. However, Claude won’t be able to access new content or perform new tasks.",id:"tlmLidjA7e"},{integrationName:n});return(0,a.jsx)(l.R,{isOpen:!0,onClose:i,title:f,onConfirm:()=>{t(),i()},confirmText:h,variant:"danger",autoFocus:!1,message:g,size:"md",isLoading:r})}},0x1334f6ecc:(e,n,t)=>{t.d(n,{$f:()=>N,Gk:()=>I,K6:()=>F,L5:()=>Y,LP:()=>j,U5:()=>T,cI:()=>k,cj:()=>D,ef:()=>P,fb:()=>M,kJ:()=>E,qL:()=>R,vT:()=>z,y:()=>A,yy:()=>S,zF:()=>O,zH:()=>q});var a=t(0x17aa9d8d7),r=t(0x12c9046cd),i=t(0x14de19ae8),o=t(0x139b5e710),l=t(0x49fac030),u=t(0xac309a83),d=t(0x1b813d90),s=t(0x1bd175d8c),c=t(0x78b33fbd),f=t(0x17e725145),h=t(0x4d348f95),g=t(0xfc89b4a4),b=t(0x1ab0d1ca1),x=t(0x87b1176c),p=t(0xfb91a209),v=t(0x187ab14f6),m=t(0x21fe74567),y=t(0x31c535e9),_=t(0x18175ce17),w=t(0xc6857cab);let L="gdrive_success",S=()=>{let e=(0,i.mV)(),{data:n}=(0,_.LN)(),t=(0,_.kO)(),a=(0,_.qi)(d.v8.GDRIVE),r=!1;if(t){var o;let e=Array.isArray(n)?n.find(e=>e.type===d.v8.MCP_RESOURCES):null;(null==a?void 0:a.uuid)&&(null==e||null==(o=e.config)?void 0:o.servers)&&(r=!!e.config.servers[a.uuid])}else r=!!(Array.isArray(n)&&n.find(e=>e.type===d.v8.GDRIVE&&e.enabled));return!e||r},C=()=>{let e=(0,u.fS)("kingfisher_enabled"),n=(0,c.useLayer)("trials_freemium").get("free_integrations",!1);return e||n},j=()=>{let e=S(),n=C();return!!(!w.env.NEXT_PUBLIC_DISABLE_GDRIVE_INTEGRATION&&n&&e)},E=()=>{let{account:e,activeOrganization:n}=(0,i.YL)(),t=null==n?void 0:n.uuid,a=j(),{data:o,isFetched:u}=(0,r.Sk)("/api/organizations/".concat(t,"/sync/mcp/drive/auth"),{queryKey:[l.jR,{accountUUID:null==e?void 0:e.uuid,orgUuid:t}],enabled:a,staleTime:3e5});return{isAuthenticated:a&&!!(null==o?void 0:o.is_authenticated),isFetched:u}},I=()=>{let e=(0,_.kO)(),n=(0,_.dJ)(d.v8.GDRIVE),t=(0,_.hm)(d.v8.GDRIVE);return e?n:t},k=function(){let{callerIdentifier:e,handleAuthSuccess:n,pathname:t,queryString:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=(0,_.kO)(),{isAuthenticated:c,startAuth:x,isFetched:v}=(0,_.ob)(d.v8.GDRIVE,{callerIdentifier:e,handleAuthSuccess:n,pathname:t,queryString:a}),{isAuthenticated:y,isFetched:w}=E(),{addSuccess:S}=(0,o.Y)(),C=(0,b.A)(),{dropdownToOpen:I,clearCallerIdentifier:k}=(0,p.t)(),D=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];null==n||n(e),S(C.formatMessage({defaultMessage:"Connected to Google Drive",id:"ij6u4TNsGF"}))},T=(e=>{let{callerIdentifier:n,pathname:t,queryString:a}=e,o=(0,h.usePathname)(),{account:u,activeOrganization:d}=(0,i.YL)(),c=null==u?void 0:u.uuid,b=null==d?void 0:d.uuid,x=j(),p=(0,f.useQueryClient)(),v=(0,s.V)(),y=(0,h.useSearchParams)(),{mutate:_}=(0,r.L2)("/api/organizations/".concat(b,"/sync/mcp/drive/auth/start"),"POST",{enabled:x,onSuccess:e=>{window.location.href=e.redirect_url}}),w=(0,g.useRef)(!1);return()=>{if(!x)return;let e="".concat(L,"=").concat(n).concat(a?"&".concat(a):""),r=(0,m.d)({pathname:t||o,searchParams:y,queryString:e,shouldOpenInClaudeApp:v});if(p.invalidateQueries({queryKey:[l.jR,{accountUUID:c,orgUuid:b}]}),v)return void window.open("/settings/connectors?open_in_browser=1&auth_start=gdrive&origin=".concat(r));w.current||(w.current=!0,_({pre_auth_state:{origin:r},redirect_uri:new URL("/connect/mcp/drive/callback",window.location.origin).toString()}))}})({callerIdentifier:e,pathname:t,queryString:a});return((0,_.FZ)({callerIdentifier:e,successParam:L,handleOpen:D}),(0,g.useEffect)(()=>{e&&I===e&&(null==n||n(!0),k())},[I,n,e,k]),u)?{isDriveAuthenticated:c,initDriveAuth:x,handleDriveTrigger:D,isFetched:v}:{isDriveAuthenticated:y,initDriveAuth:T,handleDriveTrigger:D,isFetched:w}},D=()=>{let e=(0,_.kO)(),n=(0,_.qi)(d.v8.GDRIVE);return{serverId:null==n?void 0:n.uuid,isConnected:null==n?void 0:n.isConnected,isEnabled:e}},T=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{account:n,activeOrganization:t}=(0,i.YL)(),a=null==n?void 0:n.uuid,o=null==t?void 0:t.uuid,u=j(),d=(0,f.useQueryClient)(),{mutate:s}=(0,x.ih)();return(0,r.L2)("/api/organizations/".concat(o,"/sync/mcp/drive/auth"),"DELETE",{enabled:!!(t&&u),...e,onSuccess:function(){for(var n,t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];d.invalidateQueries({queryKey:[l.jR,{accountUUID:a,orgUuid:o}]}),s({}),null==(n=e.onSuccess)||n.call(e,...r)}})},A=e=>{let{documentId:n}=e,{account:t,activeOrganization:a}=(0,i.YL)(),o=null==t?void 0:t.uuid,u=null==a?void 0:a.uuid,d=j(),s=(0,f.useQueryClient)(),c=(0,r.Sk)("/api/organizations/".concat(u,"/sync/mcp/drive/document/").concat(n,"?include_content=false"),{queryKey:[l.QB,{accountUUID:o,orgUuid:u,documentId:n}],enabled:d,meta:{noToast:!0}}),h=c.isError;return(0,g.useEffect)(()=>{h&&s.invalidateQueries({queryKey:[l.jR,{accountUUID:o,orgUuid:u}]})},[s,h,o,u]),c};function O(e){let{uri:n}=e,{data:t,isLoading:a}=A({documentId:n});return{title:null==t?void 0:t.title,isLoading:a}}let R=e=>{let{account:n,activeOrganization:t}=(0,i.YL)(),a=null==n?void 0:n.uuid,o=null==t?void 0:t.uuid,u=j(),d=(0,g.useMemo)(()=>e.map(e=>"/api/organizations/".concat(o,"/sync/mcp/drive/document/").concat(e)),[e,o]),s=(0,g.useMemo)(()=>({queryKey:e.map(e=>[l.qM,{accountUUID:a,orgUuid:o,documentId:e}]),enabled:u,meta:{noToast:!0}}),[e,a,o,u]);return(0,r._i)(d,s)},q=e=>{let{account:n,activeOrganization:t}=(0,i.YL)(),a=null==n?void 0:n.uuid,o=null==t?void 0:t.uuid,u=j(),d=(0,v.bI)(),{data:s,isSuccess:c,isLoading:f}=(0,r.Sk)("/api/organizations/".concat(o,"/sync/mcp/drive/recents"),{queryKey:[l.zu,{accountUUID:a,orgUuid:o}],enabled:e&&u,meta:{noToast:!0}});return(0,g.useEffect)(()=>{if(c&&s){let e=s.map(e=>{let{uri:n,title:t}=e;return{uri:n,title:t}});(0,v.Ac)(e)}},[c,s]),{recentDriveDocs:c?s:d,isLoading:f}},M=()=>{let e=C(),n=(0,u.fS)("apps_use_bananagrams"),t=(0,c.useLayer)("trials_freemium").get("free_integrations",!1);return e&&n||t},F=()=>{let e=j(),n=M();return e&&n&&!w.env.NEXT_PUBLIC_DISABLE_GDRIVE_INTEGRATION},N=e=>{var n;let t=F(),{account:a}=(0,i.YL)(),r=(0,u.fS)("claude_ai_sticky_project_settings"),o=(0,y.vP)("enabled_bananagrams");return!!t&&(r?!!o:e?!!(null==e||null==(n=e.conversationSettings)?void 0:n.enabled_bananagrams):!!(null==a?void 0:a.settings.enabled_bananagrams))},Y=()=>(0,u.fS)("rag_prototype"),z=()=>{let e=F(),n=(0,i.mV)(),{data:t}=(0,_.LN)(),{account:a}=(0,i.YL)(),r=Y(),o=(0,_.kO)(),l=(0,_.qi)(d.v8.GDRIVE);if(!e||!r)return!1;if(n)if(!o)return!!(Array.isArray(t)&&t.find(e=>{var n;return e.type===d.v8.GDRIVE&&e.enabled&&(null==(n=e.config)?void 0:n.allow_indexing)}));else{var u;let e=Array.isArray(t)?t.find(e=>e.type===d.v8.MCP_RESOURCES):null;if((null==l?void 0:l.uuid)&&(null==e||null==(u=e.config)?void 0:u.servers)){let n=e.config.servers[l.uuid];return!!(null==n?void 0:n.allow_indexing)}return!1}return!!(null==a?void 0:a.settings.enabled_gdrive_indexing)},P=()=>{let{account:e}=(0,i.YL)(),{mutate:n}=(0,a.yJ)(),{mutate:t}=(0,x.Bg)();return{toggleDriveSearchAndIndexingEnabled:a=>{var r;let{indexingEnabled:i,searchEnabled:o,dismissBanner:l}=a,u=l||!!i;i&&t({}),n({...void 0!==i?{enabled_gdrive_indexing:i}:null,...void 0!==o||!0===i?{enabled_bananagrams:null!=i?i:o}:null,...u?{dismissed_claudeai_banners:[...(null==e||null==(r=e.settings)?void 0:r.dismissed_claudeai_banners)||[],{banner_id:"drive_indexing_enablement_2/11_1",dismissed_at:new Date().toISOString()}]}:null})}}}},0x1b03847fb:(e,n,t)=>{t.d(n,{AM:()=>y,Bi:()=>w,DG:()=>R,FV:()=>O,MS:()=>j,RP:()=>C,Wn:()=>A,cm:()=>E,ms:()=>m,o_:()=>I,q:()=>T,tJ:()=>D});var a=t(0x52e2618c),r=t(0x22102fd88),i=t(0x14fe1b2a5),o=t(0xb91ccc43),l=t(0x1a1f6dda6),u=t(0x1fb5bdc42),d=t(0xfc89b4a4);function s(){let e=(0,a._)(["\n  outline-none\n  py-2\n  px-1.5\n  -mx-1\n  -mt-1\n  mb-1\n  border-b-0.5\n  border-border-200\n"]);return s=function(){return e},e}function c(){let e=(0,a._)(["\n  z-dropdown\n  bg-bg-000\n  border-0.5\n  border-border-200\n  backdrop-blur-xl\n  rounded-xl\n  min-w-[8rem]\n  p-1.5\n  text-text-300\n  shadow-[0px_2px_8px_0px_rgba(0,0,0,0.08)]\n  dark:shadow-[0px_2px_8px_0px_rgba(0,0,0,0.24)]\n  max-h-[min(var(--radix-dropdown-menu-content-available-height),var(--dropdown-max-height))]\n  overflow-y-auto\n  overflow-x-hidden\n"]);return c=function(){return e},e}function f(){let e=(0,a._)(["\n  rounded\n  py-1\n  px-2\n  max-w-full\n  whitespace-nowrap\n  text-ellipsis\n  overflow-hidden\n"]);return f=function(){return e},e}function h(){let e=(0,a._)(["text-text-500 pt-1 px-2"]);return h=function(){return e},e}function g(){let e=(0,a._)(["\n  font-base\n  min-h-8\n  p-2\n  rounded-lg\n  cursor-pointer\n  whitespace-nowrap\n  overflow-hidden\n  text-ellipsis\n  grid\n  grid-cols-[minmax(0,_1fr)_auto]\n  gap-2\n  items-center\n  outline-none\n  select-none\n  [&[data-highlighted]]:bg-bg-200\n  [&[data-highlighted]]:text-text-000\n  ","\n  ","\n"]);return g=function(){return e},e}function b(){let e=(0,a._)(["\n  font-base\n  min-h-8\n  p-2\n  rounded-lg\n  whitespace-nowrap\n  overflow-hidden\n  text-ellipsis\n  flex\n  justify-between\n  gap-2\n  items-center\n"]);return b=function(){return e},e}function x(){let e=(0,a._)(['\n  font-base\n  min-h-8\n  p-2\n  rounded-lg\n  cursor-pointer\n  whitespace-nowrap\n  overflow-hidden\n  text-ellipsis\n  grid\n  grid-cols-[minmax(0,_1fr)_auto]\n  gap-2\n  items-center\n  outline-none\n  select-none\n  [&[data-highlighted]]:bg-bg-200\n  [&[data-highlighted]]:text-text-300\n  [&[data-state="open"]:not([data-highlighted])]:bg-bg-100\n  [&[data-state="open"]:not([data-highlighted])]:text-text-300\n']);return x=function(){return e},e}function p(){let e=(0,a._)(["\n  z-dropdown\n  bg-bg-000\n  border-0.5\n  border-border-200\n  backdrop-blur-xl\n  rounded-xl\n  min-w-[8rem]\n  p-1.5\n  text-text-300\n  shadow-[0px_2px_8px_0px_rgba(0,0,0,0.08)]\n  dark:shadow-[0px_2px_8px_0px_rgba(0,0,0,0.24)]\n  max-h-[calc(100vh-16px)]\n  overflow-y-auto\n  overflow-x-hidden\n"]);return p=function(){return e},e}function v(){let e=(0,a._)(["\n  h-[0.5px]\n  bg-border-300\n  my-1.5\n  mx-2\n"]);return v=function(){return e},e}function m(e){let{trigger:n,children:t,unstyledTrigger:a=!1,...i}=e;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(_,{...i,trigger:a?(0,r.jsx)(u.l9,{asChild:!0,children:n}):(0,r.jsx)(S,{asChild:!0,children:n}),children:t})})}function y(e){let{children:n,open:t,mainButtonText:a,onClickMainButton:i,align:d="end",...s}=e;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(_,{...s,align:d,trigger:(0,r.jsxs)("div",{className:"flex h-8 whitespace-nowrap",children:[(0,r.jsx)("button",{className:(0,l.A)("font-base-bold !text-xs rounded-l-lg bg-bg-000 h-full flex items-center justify-center px-2 border-y border-l border-border-200 hover:bg-bg-200",t&&"bg-bg-200"),onClick:i,children:a}),(0,r.jsx)(u.l9,{asChild:!0,children:(0,r.jsx)("button",{className:"bg-bg-000 flex items-center justify-center px-1 hover:bg-bg-200 rounded-r-lg border border-border-200",children:(0,r.jsx)(o.biH,{size:16})})})]}),children:n})})}function _(e){var n;let{matchTriggerWidth:t=!1,children:a,open:i,onOpenChange:o,trigger:l,modal:d,...s}=e;return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(u.bL,{open:i,onOpenChange:o,modal:d,children:[l,(0,r.jsx)(u.ZL,{children:(0,r.jsx)(L,{style:t?{width:"var(--radix-dropdown-menu-trigger-width)"}:void 0,sideOffset:null!=(n=s.sideOffset)?n:4,...s,children:a})})]})})}let w=(0,i.J)(u.lp)(s()),L=(0,i.J)(u.UC)(c()),S=(0,i.J)(u.l9)(f()),C=u.I,j=u.Pb,E=u.ZL,I=(0,i.J)(u.lp)(h()),k=(0,i.J)(u.q7)(g(),e=>{let{disabled:n}=e;return n&&"\n    opacity-50\n    pointer-events-none\n  "},e=>{let{danger:n}=e;return n&&"\n    !text-danger-000\n    [&[data-highlighted]]:bg-danger-900\n  "}),D=d.forwardRef((e,n)=>{let{children:t,icon:a,trailing:i,...o}=e;return a||i?(0,r.jsx)(k,{ref:n,...o,children:(0,r.jsxs)("div",{className:"flex items-center gap-2 w-full font-base group",children:[a,(0,r.jsx)("span",{className:"flex-1 truncate",children:t}),i&&(0,r.jsx)("div",{className:"flex items-center flex-shrink-0 -mr-2",children:i})]})}):(0,r.jsx)(k,{ref:n,...o,children:t})});D.displayName="DropdownItem";let T=i.J.div(b()),A=(0,i.J)(u.ZP)(x()),O=(0,i.J)(u.G5)(p()),R=(0,i.J)(u.mB)(v())}}]);