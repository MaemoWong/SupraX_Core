try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="ee5b235a-ea3f-40ae-b66d-ef53b72523a0",e._sentryDebugIdIdentifier="sentry-dbid-ee5b235a-ea3f-40ae-b66d-ef53b72523a0")}catch(e){}{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};e._sentryModuleMetadata=e._sentryModuleMetadata||{},e._sentryModuleMetadata[new e.Error().stack]=Object.assign({},e._sentryModuleMetadata[new e.Error().stack],{"_sentryBundlerPluginAppKey:anthropic-apps":!0})}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[65279],{0x145d45a:(e,t,n)=>{n.d(t,{c:()=>i,j:()=>r});var a=n(0x22102fd88),o=n(0xfc89b4a4);let l=(0,o.createContext)([null,null]);function i(e){let{children:t}=e,n=(0,o.useState)({});return(0,a.jsx)(l.Provider,{value:n,children:t})}function r(e){let[t,n]=(0,o.useContext)(l),[a,i]=(0,o.useState)(),r=(0,o.useCallback)(()=>{n?n(t=>{let n={...t};return delete n[e],n}):i(void 0)},[e,n]),s=(0,o.useCallback)(t=>{n?n(n=>({...n,[e]:t})):i(t)},[e,n]);return{context:t?t[e]:a,clearContext:r,setContext:s}}},0x1e10d8e8:(e,t,n)=>{n.d(t,{r:()=>p});var a=n(0x6096d538),o=n(0x9845e38c),l=n(0x207db90c9),i=n(0x1ebd482b5),r=n(0xac309a83);let s={};var c=n(0x243825738);let d={};var u=n(0x244aea38b),h=n(0x13d66e7d3),m=n(0x1cd6706d8);let g="performance",p=(0,l.q)(function(e){let{metricType:t=e.replace(/^.+?\./,""),duration:n=0,attributes:o={},performanceAttributes:l={},tracer:p=(!d.tracer&&(d.tracer=c.u.getTracer("claude-ai-performance","1.0.0")),d.tracer)}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},b=(0,u.US)();if(b&&!(/^events\./.test(e)||/^page\.navigation_timing/.test(e))&&1){b.addAction(e),n&&b.addTiming(e,n);return}let f=m.C.getContextWithParent(),x=Date.now(),A=n>0?x-n:x,_=f?a._.with(f,()=>p.startSpan(e,{startTime:A})):p.startSpan(e,{startTime:A}),v="".concat(g,".").concat(t),y={...o,["".concat(g,".metric_type")]:t,...(0,i.r)(v,l),...function(){if(s.attributes)return s.attributes;let e=(0,r.Je)(),t=(0,i.r)("statsig",{no_more_smoother:null==e?void 0:e.getExperiment("no_more_smoother_2",{disableExposureLog:!0}).get("no_smoothing",void 0),prog_chat_input:null==e?void 0:e.getExperiment("progressively_enhanced_chat_input",{disableExposureLog:!0}).get("prog_chat_input_enabled",void 0),render_new_on_root:null==e?void 0:e.getExperiment("render_new_on_root",{disableExposureLog:!0}).get("enabled",void 0)});return e&&(s.attributes=t),t}()};n>0&&(y["".concat(v,".duration_ms")]=n,y.duration_ms=n);let E=(0,h.l)();E&&(y["memory.used_js_heap_size"]=E.usedJSHeapSize,y["memory.total_js_heap_size"]=E.totalJSHeapSize,y["memory.js_heap_size_limit"]=E.jsHeapSizeLimit,y["memory.heap_usage_percent"]=E.heapUsagePercent),_.setAttributes(y),_.end(x)},o.u.O11Y_INTERNALS)},0x25d59887:(e,t,n)=>{n.d(t,{W:()=>d});var a=n(0x22102fd88),o=n(0xa5acf583),l=n(0x14de19ae8),i=n(0xef41e510),r=n.n(i),s=n(0x38e6572);let c=()=>{let e=(0,o.fZ)(),{websiteBaseUrl:t}=(0,o._r)();return(0,a.jsx)(a.Fragment,{children:e?(0,a.jsx)(s.A,{defaultMessage:"For higher limits, <link>explore our Pro plan</link>.",id:"lU28LDdk7g",values:{link:e=>(0,a.jsx)("a",{href:"/upgrade/pro",className:"font-bold underline",rel:"noreferrer",children:e})}}):(0,a.jsx)(s.A,{defaultMessage:"Or <link>contact sales</link> if you would be interested in upgrading to a paid version of Claude.",id:"3hk4yMCf5v",values:{link:e=>(0,a.jsx)(r(),{href:"".concat(t,"/contact-sales"),className:"font-bold underline",children:e})}})})};function d(){let e=(0,l.UC)(),t=(0,l.r$)();return e&&!t?(0,a.jsx)(c,{}):null}},0x50e23a72:(e,t,n)=>{n.d(t,{x:()=>s});var a=n(0x49fac030),o=n(0x17e725145),l=n(0x20892a038),i=n(0xfc89b4a4);let r={value:null},s=()=>{let e=(0,o.useQueryClient)();return{failedStreamRetryData:(0,l.useQuery)({queryKey:[a.xT],queryFn:()=>r.value,initialData:null}).data||null,setFailedStreamRetryData:(0,i.useCallback)(t=>{r.value=t,e.setQueryData([a.xT],t)},[e])}}},0x538a5aea:(e,t,n)=>{n.d(t,{$L:()=>v,Bh:()=>A,Go:()=>y,J8:()=>E,MT:()=>p,Qg:()=>g,WC:()=>f,We:()=>d,aB:()=>b,cX:()=>m,gJ:()=>u,jp:()=>h,vF:()=>_,xQ:()=>x});var a=n(0x22102fd88),o=n(0x25d59887),l=n(0x20e00cddd),i=n(0xc6536c20),r=n(0xef41e510),s=n.n(r),c=n(0x38e6572);function d(){return(0,a.jsx)("p",{children:(0,a.jsx)(c.A,{defaultMessage:"Claude’s response was interrupted. This can be caused by network problems or exceeding the maximum conversation length. Please <link>contact support</link> if the issue persists.",id:"sHRMIfTKu4",values:{link:e=>(0,a.jsx)(s(),{href:"https://support.anthropic.com/en/articles/9015913-how-to-get-support",className:"underline",children:e})}})})}function u(){return(0,a.jsx)(c.A,{defaultMessage:"We couldn’t connect to Claude. Please check your network connection and try again.",id:"KzO0j4cGtg"})}function h(){return(0,a.jsxs)("p",{children:[(0,a.jsx)(c.A,{defaultMessage:"You’ve reached your weekly limit for thinking messages. Please try again next week.",id:"uu/l1k2f+L"}),"\xa0",(0,a.jsx)(o.W,{})]})}function m(){return(0,a.jsx)(c.A,{defaultMessage:"Looks like you have too many chats going. Please close a tab to continue.",id:"KD5FDGzyMz"})}function g(e){let{resetsAtInSeconds:t}=e;return(0,a.jsxs)("p",{children:[(0,a.jsx)(c.A,{defaultMessage:"You’ve hit your limit for Claude messages.",id:"JR7SJGPDTb"}),"\xa0",t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.A,{defaultMessage:"Limits will reset at {resetsAt}.",id:"NrQ1CUE4v0",values:{resetsAt:i.c9.fromSeconds(t).toLocaleString(i.c9.TIME_SIMPLE).replace(" ","\xa0")}}),"\xa0",(0,a.jsx)(o.W,{}),"\xa0",(0,a.jsx)(c.A,{defaultMessage:"<link>View your usage details</link>.",id:"wWT0iz9SkP",values:{link:e=>(0,a.jsx)(s(),{href:"/settings/usage",className:"font-bold underline",children:e})}})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.A,{defaultMessage:"Please wait before trying again.",id:"XhLYQfswyj"}),"\xa0",(0,a.jsx)(o.W,{})]})]})}function p(){return(0,a.jsx)(c.A,{defaultMessage:"Claude model version not found.",id:"kdrUaXpTqd"})}function b(){return(0,a.jsx)(c.A,{defaultMessage:"This model isn’t available right now. You can switch to another model to continue using Claude.",id:"EIRohXEK72"})}function f(){return(0,a.jsx)(c.A,{defaultMessage:"Conversation not found.",id:"eePQiZiD6b"})}function x(){return(0,a.jsx)("p",{children:(0,a.jsx)(c.A,{defaultMessage:"We had an unexpected billing error, please <link>contact support.</link>",id:"MBYn4HHrFu",values:{link:e=>(0,a.jsx)("a",{className:"underline",href:"https://support.anthropic.com/en/articles/9015913-how-can-i-contact-support",target:"_blank",rel:"noreferrer",children:e})}})})}function A(){return(0,a.jsxs)("p",{children:[(0,a.jsx)(c.A,{defaultMessage:"Due to unexpected capacity constraints, Claude is unable to respond to your message. Please try again soon.",id:"TRpxX8Mu1L"}),"\xa0",(0,a.jsx)(o.W,{})]})}function _(){return(0,a.jsx)("p",{children:(0,a.jsx)(c.A,{defaultMessage:"Due to capacity constraints, chatting with Claude is currently not available. Please try again in a little while.",id:"W2dIBW8oIg"})})}function v(){return(0,a.jsx)(c.A,{defaultMessage:"Your message will exceed the maximum number of files allowed per message. Consider removing some of your files or adding files over several messages.",id:"/jNwaAHdg9"})}function y(e){let{numSanitizedDocuments:t,onNewChat:n}=e;return t>0?(0,a.jsx)(c.A,{defaultMessage:"Your message will exceed the <link>maximum image count</link> for this chat. Try uploading {count, plural, one {# document} other {# documents}} with fewer pages, removing images, <newChatLink>or starting a new conversation.</newChatLink>{upgradeInstructions}",id:"gltmHPfviz",values:{link:e=>(0,a.jsx)("a",{className:"underline",target:"_blank",rel:"noreferrer",href:l.FP,children:e}),newChatLink:e=>(0,a.jsx)("a",{href:"#",className:"underline",onClick:e=>{e.preventDefault(),n()},children:e}),upgradeInstructions:()=>(0,a.jsx)(o.W,{}),count:t}}):(0,a.jsx)(c.A,{defaultMessage:"Your message will exceed the <link>maximum image count</link> for this chat. Try removing images <newChatLink>or starting a new conversation.</newChatLink>{upgradeInstructions}",id:"QmLhKBubcc",values:{link:e=>(0,a.jsx)("a",{className:"underline",target:"_blank",rel:"noreferrer",href:l.FP,children:e}),newChatLink:e=>(0,a.jsx)("a",{href:"#",className:"underline",onClick:e=>{e.preventDefault(),n()},children:e}),upgradeInstructions:()=>(0,a.jsx)(o.W,{})}})}function E(e){let{numAttachmentsOrFiles:t,onNewChat:n}=e;return t>0?(0,a.jsx)(c.A,{defaultMessage:"Your message will exceed the <link>length limit</link> for this chat. Try attaching fewer or smaller files <newChatLink>or starting a new conversation.</newChatLink>{upgradeInstructions}",id:"G1lejdsk5p",values:{link:e=>(0,a.jsx)("a",{className:"underline",target:"_blank",rel:"noreferrer",href:l.q4,children:e}),newChatLink:e=>(0,a.jsx)("a",{href:"#",className:"underline",onClick:e=>{e.preventDefault(),n()},children:e}),upgradeInstructions:()=>(0,a.jsx)(o.W,{})}}):(0,a.jsx)(c.A,{defaultMessage:"Your message will exceed the <link>length limit</link> for this chat. Try shortening your message <newChatLink>or starting a new conversation.</newChatLink>{upgradeInstructions}",id:"EWtBrIlAAR",values:{link:e=>(0,a.jsx)("a",{className:"underline",target:"_blank",rel:"noreferrer",href:l.q4,children:e}),newChatLink:e=>(0,a.jsx)("a",{href:"#",className:"underline",onClick:e=>{e.preventDefault(),n()},children:e}),upgradeInstructions:()=>(0,a.jsx)(o.W,{})}})}},0x9dcf4143:(e,t,n)=>{n.d(t,{v:()=>l,x:()=>i});var a=n(0xfc89b4a4);let o="customSystemPrompt",l=()=>{let[e,t]=(0,a.useState)(()=>"undefined"==typeof localStorage?"":localStorage.getItem(o)||"");return(0,a.useEffect)(()=>{localStorage.setItem(o,e)},[e]),{customSystemPrompt:e,setCustomSystemPrompt:t}},i=()=>"undefined"==typeof localStorage?"":localStorage.getItem(o)},0xe48b09ae:(e,t,n)=>{n.d(t,{S:()=>F});var a=n(0x22102fd88),o=n(0x628a9a0b),l=n(0x164c6313f),i=n(0x1f150de5e),r=n(0x10e9ea2cc),s=n(0xf32c56dd),c=n(0xa5acf583),d=n(0x14de19ae8),u=n(0x139b5e710),h=n(0x1016c6ed2),m=n(0x18393fe29),g=n(0x9845e38c),p=n(0xac309a83),b=n(0xe670e093),f=n(0x253a5c787),x=n(0x78b33fbd),A=n(0xc6536c20),_=n(0x4d348f95),v=n(0xfc89b4a4),y=n(0x1ab0d1ca1),E=n(0x23cebaa8a),C=n(0x538a5aea),k=n(0x50e23a72),G=n(0x23b6b0e18),S=n(0x23c1bed08),V=n(0x145d45a),W=n(0x23f9bb43c),I=n(0x209ab1f87),B=n(0x20805e624);let Z="incomplete_stream",R=Error(Z);function F(e){var t;let{conversationUuid:n,projectUuid:F,endpoint:X,getTools:w,onIncrementalCompletion:Y,onStreamCompleted:N,onRetry:U,enableCaching:M=!1,pendingUserMessage:j,hasActiveStream:J=!1,onStartAppend:Q,checkMessageExists:L,getAssistantMessageUuid:K}=e,z=(0,s.st)(),{applicationType:H}=(0,c._r)(),{activeOrganization:T,account:D}=(0,d.YL)(),O=(0,p.fS)("apps_no_smoothing"),P=null==T?void 0:T.uuid,q=(0,v.useMemo)(()=>{if(!D||!T)return!1;let e=D.memberships.find(e=>e.organization.uuid===T.uuid);return(null==e?void 0:e.seat_tier)==="enterprise_usage_based"},[D,T]),{context:$,clearContext:ee,setContext:et}=(0,V.j)(n),en=function(e){let{conversationUuid:t,hasActiveStream:n,pendingUserMessage:a,onIncrementalCompletion:o,onStartAppend:l,onStreamCompleted:r,checkMessageExists:s,getAssistantMessageUuid:c,smoothingDisabled:d=!1}=e,{setCompletionStatus:u}=(0,i.U)(t,!0),[h,m]=(0,v.useState)(null),[p,f]=(0,v.useState)(!1),[x,A]=(0,v.useState)(!1),_=(0,v.useRef)(null),y=(0,v.useRef)(null),E=(0,v.useRef)(void 0),C=(0,v.useCallback)(()=>{A(!1),u(!1),y.current&&(y.current.model_done=!0,y.current=null),r&&r(t,null,E.current,{shouldRefetch:!0})},[u,r,t]),k=(0,v.useCallback)(()=>{var e;null==(e=_.current)||e.abort(),C()},[C]),G=(0,v.useCallback)(e=>{var t,n;if(!p||!x)return;let a=y.current;a&&(null==(t=_.current)||!t.signal.aborted)&&("completion_type"in e&&"unparsed"===e.completion_type?a.onMessage({type:"content_block_delta",index:0,delta:{type:"text_delta",text:e.completion||""}}):"type"in e&&"string"==typeof e.type&&(["message_start","content_block_start","content_block_delta","content_block_stop","message_delta","message_stop"].includes(e.type)?("message_start"===e.type&&(null==(n=e.message)?void 0:n.uuid)&&(E.current=e.message.uuid),a.onMessage(e),"message_stop"===e.type&&(g.v.info(g.u.CHAT_COMPLETION,"Stream completed during reconnection"),a.model_done=!0,C())):e.type))},[p,x,C]);return(0,v.useEffect)(()=>{n&&a&&!p&&(async()=>{if(g.v.info(g.u.CHAT_COMPLETION,"Initializing stream reconnection",{conversationUuid:t}),A(!0),u(!0),_.current=new AbortController,s(a.uuid)){let e=null==c?void 0:c(a.uuid);e&&(m(e),E.current=e)}else{let e="".concat(B.B6,"-").concat((0,b.b)()),n={uuid:e,sender:"assistant",content:[{type:"text",text:""}],created_at:new Date().toISOString(),updated_at:new Date().toISOString(),parent_message_uuid:a.uuid,attachments:[],files:[],files_v2:[],sync_sources:[],index:1};m(e),l&&await l(t,e=>(0,B.xQ)(e,[a,n]))}let e=(0,W.i)();e.dont_smooth=d,e.on_completion=e=>{o&&o(t,e)},e.checkVisibility=()=>I.Z.isVisible(),y.current=e;let n=_.current.signal;d||e.task(e=>{o&&o(t,e)},n),f(!0),g.v.info(g.u.CHAT_COMPLETION,"Stream reconnection initialized, ready to process events")})()},[n,a,t,l,s,c,p,u,o,d]),(0,v.useEffect)(()=>()=>{y.current&&(y.current.model_done=!0,y.current=null)},[]),{currentMessageUuid:h,hasInitializedPlaceholders:p,isReconnecting:x,abortReconnection:k,handleEvent:G}}({conversationUuid:n,hasActiveStream:J&&!!Q&&!!L,pendingUserMessage:j,onIncrementalCompletion:Y,onStartAppend:Q,onStreamCompleted:N,checkMessageExists:L||(()=>!1),getAssistantMessageUuid:K,smoothingDisabled:O}),ea=(0,_.useSearchParams)(),eo=null==ea?void 0:ea.get("t"),el=null!=(t=(0,G.k)(n))?t:"",ei=null==ea?void 0:ea.get("max_tokens"),er=(0,r.$)(),{addError:es,addApiError:ec,clearToast:ed}=(0,u.Y)(),eu=(0,v.useMemo)(b.b,[]),eh=(0,o.bT)("push",eu),{setFailedStreamRetryData:em}=(0,k.x)(),eg=(0,v.useCallback)(async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{shouldRefetch:!0,skipOptimisticUpdate:!1};await (null==N?void 0:N(n,e,t,a)),ee()},[N,n,ee]),ep=(0,v.useCallback)((e,t,o)=>e===Z?es((0,a.jsx)(C.We,{}),{error:e}):e instanceof h.LG?"rate_limit_error"===e.type?(0,E.i7)(e,P,n,er,es,q):"not_found_error"===e.type?e.message&&e.message.toLowerCase().includes("model:")?es((0,a.jsx)(C.MT,{}),{error:e}):(0,E.Tj)(e)?es((0,a.jsx)(C.WC,{}),{error:e}):"model_not_available"===e.errorCode&&e.message?es(e.message,{error:e}):(z.track({event_key:"claudeai.unhandled_error_code",conversation_uuid:n,project_uuid:F,error_code:e.errorCode,error_type:e.type,error_message:e.message}),es((0,a.jsx)(C.aB,{}),{error:e})):"billing_error"===e.type?es((0,a.jsx)(C.xQ,{}),{error:e}):"overloaded_error"===e.type?es((0,a.jsx)(C.Bh,{}),{error:e}):("invalid_request_error"===e.type&&413===e.statusCode&&z.track({event_key:"chat.conversation.token_limit_exceeded",conversation_uuid:n,project_uuid:F}),(0,E.Wf)(e,t,o,F,eh,ed,es))?void 0:"invalid_request_error"===e.type&&"read_only_mode"===e.extra.code?es((0,a.jsx)(C.vF,{}),{error:e}):ec(e,{errorContext:{tags:{source:"stream_completion"}}}):es((0,a.jsx)(C.gJ,{}),{error:e}),[F,eh,ed,es,ec,P,n,er,z,q]),eb=(0,x.useExperiment)("no_more_smoother_2"),ef=(0,y.A)(),{setCompletionStatus:ex}=(0,i.U)(n,!0),eA=(0,v.useCallback)(async e=>{let t,{prompt:a,attachments:o,files:i,syncSources:r,rethrowErrors:s=!1,modelOverride:c,parent_message_uuid:d,personalized_style:u,paprika_mode:p,enableCaching:b,grpcTools:x,skipOptimisticUpdateOnStreamComplete:_=!1}=e;if($)return;if(!T)throw Error("Cannot stream without an organization");let v=new AbortController;et({controller:v}),em(null);let y=w(),C=(0,S.J)({prompt:a,parent_message_uuid:d,timezone:A.c9.local().zoneName||void 0,personalized_style:u,locale:ef.locale,model:el,modelOverride:c,temperature:eo,maxTokensToSample:ei,paprika_mode:p,tools:y}),k=[],G=null,V=null,W=!0,I=null;try{let e=eb.get("no_smoothing",!1);ex(!0);let s=null!=b?b:M,c=s?l.MG.GRPC:l.MG.SSE;if(G=(I=await (0,l.xD)({applicationType:H,endpoint:X,orgUuid:T.uuid,conversationUuid:n,body:{organization_uuid:T.uuid,conversation_uuid:n,text:a,attachments:o,files:i.map(e=>e.file_uuid),sync_sources:r.map(e=>e.uuid)},onCompletion:e=>{Y(n,e),k=e},onMessageStart:e=>{t=e},onRetry:U,onCompactionStatus:e=>{et({controller:v,compactionStatus:"compacting"===e?e:void 0})},abortController:v,completion:C,getTools:w,smoothingEnabled:!O&&!e,transport:c,...s&&x&&{grpcTools:x},retryEnabled:!s})).stopReason,V=I.messageLimitResult,I&&!G)throw R}catch(t){let e=t instanceof h.LG;if(em({prompt:a,attachments:o,files:i}),e&&(0,E.Tj)(t)&&(W=!1),t===R?(Y(n,k),ep(Z,o.length+i.length,i.filter(e=>"document"===e.file_kind).length),z.track({event_key:"sse_interrupted"}),(0,f.wd)("sse_interrupted"),await new Promise(e=>setTimeout(e,3e4))):(ep(t,o.length+i.length,i.filter(e=>"document"===e.file_kind).length),e||g.v.error(g.u.CHAT_COMPLETION,"Non-API stream error",t)),(0,f.Cp)(t,{tags:{source:e?"stream-api":"stream-generic"}}),s||(0,m.yz)())throw t}finally{await eg(V,t,{shouldRefetch:W,skipOptimisticUpdate:_}),ex(!1)}return k},[$,T,et,em,ex,w,ef.locale,el,eo,ei,eb,H,X,n,U,O,Y,ep,z,eg,M]),e_=(0,v.useCallback)(()=>{en.isReconnecting&&en.abortReconnection(),$&&($.controller.abort(),ee())},[$,ee,en]);return{runStream:eA,isStreaming:!!$||en.isReconnecting,abortStream:e_,isReconnected:J&&!!j,handleEvent:en.handleEvent}}},0x10e9ea2cc:(e,t,n)=>{n.d(t,{$:()=>d,T:()=>u});var a=n(0x12c9046cd),o=n(0x14de19ae8),l=n(0x53bbc52f),i=n(0x49fac030),r=n(0xac309a83),s=n(0x17e725145),c=n(0xfc89b4a4);let d=()=>{let e=(0,s.useQueryClient)();return(0,c.useCallback)((t,n,a)=>{"within_limit"!==t.type&&(t.conversationUuid=a),e.setQueryData([i.Rw],e=>e?{...e,messageLimits:{...e.messageLimits,[n]:t}}:e)},[e])},u=e=>{let{activeOrganization:t}=(0,o.YL)(),{selectedTier:n}=(0,l.tg)(),i=(0,r.fS)("internal_tier_selector"),s=null==t?void 0:t.uuid,c=d(),u={type:"within_limit"};return(0,a.L2)(()=>"/api/organizations/".concat(s,"/reset_rate_limits"),"POST",{onSuccess:()=>{c(u,s,e||"")},meta:{noToast:!0},transformVariables:()=>i&&n?{org_type:n}:{}})}},0x13d66e7d3:(e,t,n)=>{function a(){return"undefined"!=typeof performance&&"memory"in performance&&void 0!==performance.memory}function o(){if(!a())return null;let e=performance.memory;return{usedJSHeapSize:e.usedJSHeapSize,totalJSHeapSize:e.totalJSHeapSize,jsHeapSizeLimit:e.jsHeapSizeLimit,heapUsagePercent:Math.round(e.usedJSHeapSize/e.jsHeapSizeLimit*100)}}n.d(t,{Y:()=>a,l:()=>o})},0x164c6313f:(e,t,n)=>{n.d(t,{ep:()=>C,MG:()=>A,wV:()=>_,OZ:()=>y,xD:()=>S});var a=n(0x24553dffe),o=n(0x2004f6966),l=n(0x1e10d8e8),i=n(0x1016c6ed2),r=n(0x20e00cddd),s=n(0x9845e38c);async function c(){let{numPrevAttempts:e=1,maxAttempts:t=10,jitterFraction:n=.1,backoffAmount:a=1.5,initialDelayMs:o=1e3}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e<0)throw Error("numPrevAttempts must be non-negative");let l=o*Math.pow(a,Math.min(t,e)),i=(Math.random()-.5)*2*(l*n),r=Math.floor(Math.max(0,l+i));return s.v.debug(s.u.LOCAL_DEV,"exponentialBackoffWithJitter: Waiting ".concat(r," ms")),new Promise(e=>{setTimeout(e,r)})}var d=n(0x16b12f4ea),u=n(0x16a879d4a),h=n(0xe0aa32af),m=n(0x21ff8586b),g=n(0x1bd372a25),p=n(0x253a5c787),b=n(0x23f9bb43c),f=n(0x209ab1f87);let x="POST";var A=function(e){return e.SSE="sse",e.GRPC="grpc",e}({});function _(e){let t=(0,m.w)({baseUrl:"/v1/mobile",useBinaryFormat:!1,interceptors:[t=>async n=>(n.header.set("X-Organization-Id",e),await t(n))]});return(0,h.UU)(o.mt,t)}let v=null,y=()=>{v&&(v.force_smoother_done=!0)};async function E(e){let{fn:t,maxAttempts:n,attemptNumber:a,onRetry:o,abortController:r}=e;if(n<1)throw Error("Max attempts must be >= 1");if(s.v.info(s.u.CHAT_COMPLETION,"Starting completion request (".concat(a+1,"/").concat(n,")")),a>0&&(1===a&&(0,l.r)("chat.completion_retry_initiated"),await c({numPrevAttempts:a-1,initialDelayMs:5e3,backoffAmount:1.5,jitterFraction:.1}),r.signal.aborted))throw s.v.warn(s.u.CHAT_COMPLETION,"Request aborted during backoff, stopping retries"),new DOMException("Request aborted","AbortError");try{await t(),s.v.info(s.u.CHAT_COMPLETION,"Completion request succeeded on attempt ".concat(a+1)),a>0&&(0,l.r)("chat.completion_retry_recovered");return}catch(e){if(s.v.error(s.u.CHAT_COMPLETION,"Request failed",e),1===n||!(e instanceof i.LG))throw e;if("overloaded_error"!==e.type)throw s.v.error(s.u.CHAT_COMPLETION,"Not retryable error, throwing"),(0,l.r)("chat.completion_non_retryable_error",{attributes:{"error.type":e.type}}),e;if(null==o||o(a+1),a+1>=n)throw(0,l.r)("chat.completion_retry_exhausted"),e}return E({...e,attemptNumber:a+1})}var C=function(e){return e[e.APPEND_MESSAGE_WITH_COMPLETION=1]="APPEND_MESSAGE_WITH_COMPLETION",e[e.RETRY_MESSAGE_WITH_COMPLETION=2]="RETRY_MESSAGE_WITH_COMPLETION",e}({});let k=["close_file","create_file","delete_file","file_search","open_file","repl","str_replace","update_file"];async function G(e){let{orgUuid:t,conversationUuid:n,body:a,abortController:l,completion:r,smoother:c,grpcTools:d,onMessageStart:h,endpoint:m}=e,g=_(t),p=null;try{var b,f;let e;if(2===m)e=g.retryMessage((0,u.v)(o.WH,{organizationUuid:t,chatConversationUuid:n,parentMessageUuid:r.parent_message_uuid,model:r.model,timezone:a.timezone||r.timezone,customSystemPrompt:r.custom_system_prompt,locale:r.locale,paprikaMode:null!=(b=r.paprika_mode)?b:void 0,tools:d,maxTokensToSample:r.max_tokens_to_sample,renderingMode:o.x4.MESSAGES}),{signal:l.signal});else{let i=null==(f=a.attachments)?void 0:f.map(e=>(0,u.v)(o.gG,{fileName:e.file_name,fileSize:e.file_size,fileType:e.file_type,extractedContent:e.extracted_content}));e=g.appendMessage((0,u.v)(o.Kp,{organizationUuid:t,chatConversationUuid:n,prompt:a.text||r.prompt,model:r.model,timezone:a.timezone,attachments:i,files:a.files,tools:d,renderingMode:o.x4.MESSAGES}),{signal:l.signal})}for await(let t of e)if("completionEventJson"===t.payload.case)try{let e=JSON.parse(t.payload.value);if("error"===e.type)throw(0,i.a5)({status:0,response:"error"in e&&e.error||{},fallbackMessage:"gRPC streaming error",headers:void 0,endpoint:"/v1/mobile/appendMessage",method:"gRPC"});let n=["message_start","content_block_start","content_block_delta","content_block_stop","message_delta","message_stop"];if("tool_approval"===e.type);else if(n.includes(e.type)){if(c.onMessage(e),"message_start"===e.type)null==h||h(e.message.uuid);else if("message_stop"===e.type){c.model_done=!0,p="message_stop";break}}}catch(e){throw s.v.error(s.u.CHAT_COMPLETION,"Failed to parse gRPC completion event",e),e}else if("completionEventError"===t.payload.case){let e=t.payload.value,n={};try{n=JSON.parse(e.errorJson)}catch(e){s.v.error(s.u.CHAT_COMPLETION,"Failed to parse error_json from gRPC error response",e)}throw(0,i.a5)({status:e.statusCode,response:n,fallbackMessage:"HTTP error from private API",headers:void 0,endpoint:"/v1/mobile/appendMessage",method:"gRPC"})}c.model_done=!0}catch(e){throw c.model_done=!0,c.force_smoother_done=!0,e}return{stopReason:p,messageLimitResult:null}}async function S(e){let t,{applicationType:n,endpoint:o,orgUuid:l,conversationUuid:c,body:u,onMessageStart:h,onCompletion:m,onRetry:A,onCompactionStatus:_,abortController:y,completion:C,getTools:S,smoothingEnabled:V=!0,retryEnabled:W=!0,transport:I="sse",grpcTools:B,cachedEvents:Z}=e,R=(0,b.i)();v=R,R.dont_smooth=!V,R.on_completion=m,R.checkVisibility=()=>f.Z.isVisible();let F=V?R.task(m,y.signal):Promise.resolve();if(Z&&Z.length>0){for(let e of(s.v.info(s.u.CHAT_COMPLETION,"Replaying cached events before continuing live stream",{eventCount:Z.length}),Z)){if(y.signal.aborted){s.v.info(s.u.CHAT_COMPLETION,"Cached event processing aborted");break}if("unparsed"===e.completion_type)R.onMessage({type:"content_block_delta",index:0,delta:{type:"text_delta",text:e.completion||""}});else if(e.type){let t=["message_start","content_block_start","content_block_delta","content_block_stop","message_delta","message_stop"];"tool_approval"===e.type||t.includes(e.type)&&R.onMessage(e)}}s.v.info(s.u.CHAT_COMPLETION,"Cached events replayed, continuing with live stream")}if("grpc"===I){let e=await G({orgUuid:l,conversationUuid:c,body:u,abortController:y,completion:C,smoother:R,grpcTools:B,onMessageStart:h,endpoint:o});return await F,v=null,e}let X=a.m.get(r.eT.DEVICE_ID_KEY),w={"Content-Type":"application/json",Accept:"text/event-stream",...(0,d._)(n),...X&&{"anthropic-device-id":X}},Y=null,N=null,U=JSON.stringify({...C,...u,text:void 0,rendering_mode:"messages",organization_uuid:void 0,conversation_uuid:void 0}),M="",j="",J=0,Q=E({fn:()=>{R.model_done=!1,R.force_smoother_done=!1,M="",j="",t=void 0,J=0;let e=function(e,t,n){let a;switch(e){case 1:a="completion";break;case 2:a="retry_completion";break;default:throw Error("Invalid endpoint")}return"/api/organizations/".concat(t,"/chat_conversations/").concat(n,"/").concat(a)}(o,l,c);return(0,g.y)(e,{method:x,credentials:"include",headers:w,body:U,openWhenHidden:!0,signal:y.signal,async onopen(t){var n;if(!t.ok||!(null==(n=t.headers.get("content-type"))?void 0:n.includes(g.o))){let n=await t.text(),a={};try{a=JSON.parse(n)}catch(e){}throw(0,i.a5)({status:t.status,response:a,fallbackMessage:"Failed to fetch",headers:t.headers,endpoint:e,method:x})}},onmessage:n=>{var a,o;switch(n.event){case"ping":default:return;case"error":throw(0,i.a5)({status:0,response:JSON.parse(n.data),fallbackMessage:"Streaming error: 22",headers:void 0,endpoint:e,method:x});case"completion":{let e=JSON.parse(n.data);if(void 0===e.completion)throw Error("Unexpected message received when streaming: ".concat(n.data));let t={type:"content_block_delta",index:0,delta:{type:"text_delta",text:e.completion}};Y=e.stop_reason,N=null!=(a=e.messageLimit)?a:null,R.onMessage(t);break}case"content_block_start":{let e=JSON.parse(n.data);J=e.index,"tool_use"===e.content_block.type&&(j=e.content_block.name,t=e.content_block.approval_key),R.onMessage(e);break}case"content_block_delta":{let e=JSON.parse(n.data);if(e.index!==J&&"thinking_summary_delta"!==e.delta.type)throw Error("Content block index did not match the expected index");(null==(o=e.delta)?void 0:o.type)==="input_json_delta"&&(k.includes(j)||S().some(e=>e.name===j||j.endsWith(":".concat(e.name)))||t)&&(M+=e.delta.partial_json),R.onMessage(e);break}case"content_block_stop":{let e=JSON.parse(n.data);if(e.index!==J)throw Error("Content block index did not match the expected index");if(e.buffered_input=M,R.onMessage(e),!j)break;M="",j="",t=void 0;break}case"message_limit":N=JSON.parse(n.data).message_limit;break;case"compaction_status":{let e=JSON.parse(n.data);null==_||_(e.status,e.message);break}case"message_delta":case"message_start":case"message_stop":{let e=JSON.parse(n.data);"message_start"===e.type&&(null==h||h(e.message.uuid)),"message_stop"===e.type&&(Y="message_stop"),R.onMessage(e)}case"tool_approval":}},onclose(){R.model_done=!0},onerror(e){throw(0,p.Cp)(e),R.model_done=!0,R.force_smoother_done=!0,e}})},abortController:y,attemptNumber:0,maxAttempts:W?10:1,onRetry:A});return await Promise.all([Q,F]),v=null,{stopReason:Y,messageLimitResult:N}}},0x1cd6706d8:(e,t,n)=>{n.d(t,{C:()=>r});var a=n(0x243825738),o=n(0x112ace885),l=n(0x6096d538);class i{extractFromServerTiming(){try{let e=performance.getEntriesByType("navigation");if(0===e.length)return;let t=e[0].serverTiming;if(!t)return;let n=t.find(e=>"traceparent"===e.name);if(!n||!n.description)return;let l=n.description.split("-");if(4!==l.length)return;let[i,r,s,c]=l;if("00"!==i)return;this.parentContext={traceId:r,spanId:s,traceFlags:parseInt(c,16),isRemote:!0};let d=a.u.wrapSpanContext(this.parentContext);this.contextWithParent=a.u.setSpan(o.l,d)}catch(e){}}setParentContext(e){this.parentContext=e}getParentContext(){return this.parentContext}isParentSampled(){return!!this.parentContext&&(1&this.parentContext.traceFlags)==1}getContextWithParent(){if(!this.parentContext)return null;let e=a.u.wrapSpanContext(this.parentContext);return a.u.setSpan(l._.active(),e)}clearParentContext(){this.parentContext=null,this.contextWithParent=null}hasParentContext(){return null!==this.parentContext}active(){return this.contextWithParent||o.l}with(e,t,n){for(var a=arguments.length,o=Array(a>3?a-3:0),l=3;l<a;l++)o[l-3]=arguments[l];return t.call(n,...o)}bind(e,t){return t}enable(){return this.initialized||(this.extractFromServerTiming(),this.initialized=!0),this}disable(){return this.parentContext=null,this.contextWithParent=null,this.initialized=!1,this}constructor(){this.initialized=!1,this.parentContext=null,this.contextWithParent=null}}let r=new i},0x1ebd482b5:(e,t,n)=>{n.d(t,{r:()=>a});function a(e,t){return Object.fromEntries(Object.entries(t).map(t=>{let[n,a]=t;return[n.startsWith("".concat(e,"."))?n:"".concat(e,".").concat(n),a]}))}},0x1f150de5e:(e,t,n)=>{n.d(t,{U:()=>s});var a=n(0x12c9046cd),o=n(0x14de19ae8),l=n(0xac309a83),i=n(0x17e725145),r=n(0xfc89b4a4);let s=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{activeOrganization:n}=(0,o.YL)(),s=(0,i.useQueryClient)(),c=null==n?void 0:n.uuid,d=(0,l.fS)("claudeai_completion_status_sidebar"),{data:u,refetch:h}=(0,a.Sk)("/api/organizations/".concat(c,"/chat_conversations/").concat(e,"/completion_status?poll=false"),{enabled:void 0!==e&&void 0!==c&&d&&!t,refetchInterval:e=>{var t,n;return null!=e&&null!=(n=e.state)&&null!=(t=n.data)&&!!t.is_pending&&1e3},retry:!1});return{completionStatus:u,refetchCompletionStatus:h,setCompletionStatus:(0,r.useCallback)(t=>{if(!d||void 0===e||void 0===c)return;let n="/api/organizations/".concat(c,"/chat_conversations/").concat(e,"/completion_status?poll=false");return s.setQueryData([n,void 0],{is_pending:t,is_error:!1,error_code:null,error_detail:null})},[e,c,s,d])}}},0x2004f6966:(e,t,n)=>{n.d(t,{Kp:()=>p,Ky:()=>h,WH:()=>b,WK:()=>g,a3:()=>m,aA:()=>u,gG:()=>d,mM:()=>c,mt:()=>x,x4:()=>f});var a=n(0x152020469),o=n(0x18c3d05ea),l=n(0x85af78ca),i=n(0x216b382d5),r=n(0x1732c2ae);let s=(0,a.w)("CilhbnRocm9waWMvbW9iaWxlL3YxYWxwaGEvY29tcGxldGlvbi5wcm90bxIYYW50aHJvcGljLm1vYmlsZS52MWFscGhhIkQKGUNvbXBsZXRpb25TdHJlYW1IVFRQRXJyb3ISEwoLc3RhdHVzX2NvZGUYASABKAUSEgoKZXJyb3JfanNvbhgCIAEoCSL1AwoWR2V0Q29udmVyc2F0aW9uUmVxdWVzdBIiChFvcmdhbml6YXRpb25fdXVpZBgBIAEoCUIHukgEcgIQARInChZjaGF0X2NvbnZlcnNhdGlvbl91dWlkGAIgASgJQge6SARyAhABEhkKDHdvcmtzcGFjZV9pZBgDIAEoCUgAiAEBEhEKBHRyZWUYBCABKAhIAYgBARJRCg5yZW5kZXJpbmdfbW9kZRgFIAEoDjI0LmFudGhyb3BpYy5tb2JpbGUudjFhbHBoYS5DbGF1ZGVNZXNzYWdlUmVuZGVyaW5nTW9kZUgCiAEBEh0KEHJlbmRlcl9hbGxfdG9vbHMYBiABKAhIA4gBARIkChdyZW5kZXJfYWxsX21vYmlsZV90b29scxgHIAEoCEgEiAEBEhIKBXRvb2xzGAggASgJSAWIAQESKgodcmV0dXJuX2RhbmdsaW5nX2h1bWFuX21lc3NhZ2UYCSABKAhIBogBAUIPCg1fd29ya3NwYWNlX2lkQgcKBV90cmVlQhEKD19yZW5kZXJpbmdfbW9kZUITChFfcmVuZGVyX2FsbF90b29sc0IaChhfcmVuZGVyX2FsbF9tb2JpbGVfdG9vbHNCCAoGX3Rvb2xzQiAKHl9yZXR1cm5fZGFuZ2xpbmdfaHVtYW5fbWVzc2FnZSJIChdHZXRDb252ZXJzYXRpb25SZXNwb25zZRItCgxjb252ZXJzYXRpb24YASABKAsyFy5nb29nbGUucHJvdG9idWYuU3RydWN0InUKHlN0cmVhbVBlbmRpbmdDb21wbGV0aW9uUmVxdWVzdBInChZjaGF0X2NvbnZlcnNhdGlvbl91dWlkGAEgASgJQge6SARyAhABEioKGXBhcmVudF9odW1hbl9tZXNzYWdlX3V1aWQYAiABKAlCB7pIBHICEAEirQEKH1N0cmVhbVBlbmRpbmdDb21wbGV0aW9uUmVzcG9uc2USKAoVY29tcGxldGlvbl9ldmVudF9qc29uGAEgASgJQge6SARyAhABSAASVQoWY29tcGxldGlvbl9ldmVudF9lcnJvchgCIAEoCzIzLmFudGhyb3BpYy5tb2JpbGUudjFhbHBoYS5Db21wbGV0aW9uU3RyZWFtSFRUUEVycm9ySABCCQoHcGF5bG9hZCLyBAoZQ3JlYXRlQ29udmVyc2F0aW9uUmVxdWVzdBIiChFvcmdhbml6YXRpb25fdXVpZBgBIAEoCUIHukgEcgIQARIZCgx3b3Jrc3BhY2VfaWQYAiABKAlIAIgBARIXCgZwcm9tcHQYAyABKAlCB7pIBHICEAESEgoFbW9kZWwYBCABKAlIAYgBARIUCgdzdW1tYXJ5GAUgASgJSAKIAQESEQoEdXVpZBgGIAEoCUgDiAEBEhkKDHByb2plY3RfdXVpZBgHIAEoCUgEiAEBEhkKDGlzX3RlbXBvcmFyeRgIIAEoCEgFiAEBEi0KIGluY2x1ZGVfY29udmVyc2F0aW9uX3ByZWZlcmVuY2VzGAkgASgISAaIAQESGwoOYmVhbV9jaGF0X3V1aWQYCiABKAlIB4gBARIdChBpc19uZXdfYmVhbV9jaGF0GAsgASgISAiIAQESGQoMY29tcGFzc19tb2RlGAwgASgJSAmIAQESGQoMcGFwcmlrYV9tb2RlGA0gASgJSAqIAQESGAoLY3JlYXRlX21vZGUYDiABKAlIC4gBAUIPCg1fd29ya3NwYWNlX2lkQggKBl9tb2RlbEIKCghfc3VtbWFyeUIHCgVfdXVpZEIPCg1fcHJvamVjdF91dWlkQg8KDV9pc190ZW1wb3JhcnlCIwohX2luY2x1ZGVfY29udmVyc2F0aW9uX3ByZWZlcmVuY2VzQhEKD19iZWFtX2NoYXRfdXVpZEITChFfaXNfbmV3X2JlYW1fY2hhdEIPCg1fY29tcGFzc19tb2RlQg8KDV9wYXByaWthX21vZGVCDgoMX2NyZWF0ZV9tb2RlIksKGkNyZWF0ZUNvbnZlcnNhdGlvblJlc3BvbnNlEi0KDGNvbnZlcnNhdGlvbhgBIAEoCzIXLmdvb2dsZS5wcm90b2J1Zi5TdHJ1Y3QiZwoRTWVzc2FnZUF0dGFjaG1lbnQSEQoJZmlsZV9uYW1lGAEgASgJEhEKCWZpbGVfc2l6ZRgCIAEoBRIRCglmaWxlX3R5cGUYAyABKAkSGQoRZXh0cmFjdGVkX2NvbnRlbnQYBCABKAkivQEKDENsYXVkZUFpVG9vbBIuCgRuYW1lGAEgASgJQiC6SB1yGxABGEAyFV5bYS16QS1aMC05Xy1dezEsNjR9JBIcCgtkZXNjcmlwdGlvbhgCIAEoCUIHukgEcgIQARItCgxpbnB1dF9zY2hlbWEYAyABKAsyFy5nb29nbGUucHJvdG9idWYuU3RydWN0EhwKD25hbWVzcGFjZWRfbmFtZRgEIAEoCUgAiAEBQhIKEF9uYW1lc3BhY2VkX25hbWUinAQKFUZyb250ZW5kUmVtb3RlTWNwVG9vbBIuCgRuYW1lGAEgASgJQiC6SB1yGxABGEAyFV5bYS16QS1aMC05Xy1dezEsNjR9JBIcCgtkZXNjcmlwdGlvbhgCIAEoCUIHukgEcgIQARItCgxpbnB1dF9zY2hlbWEYAyABKAsyFy5nb29nbGUucHJvdG9idWYuU3RydWN0EhwKD25hbWVzcGFjZWRfbmFtZRgEIAEoCUgAiAEBEhwKD21jcF9zZXJ2ZXJfdXVpZBgFIAEoCUgBiAEBEh0KEGludGVncmF0aW9uX25hbWUYBiABKAlIAogBARIhChRpbnRlZ3JhdGlvbl9pY29uX3VybBgHIAEoCUgDiAEBEhsKDm5lZWRzX2FwcHJvdmFsGAggASgISASIAQESHgoRYmFja2VuZF9leGVjdXRpb24YCSABKAhIBYgBARISCgV0aXRsZRgKIAEoCUgGiAEBEhsKDnJlYWRfb25seV9oaW50GAsgASgISAeIAQFCEgoQX25hbWVzcGFjZWRfbmFtZUISChBfbWNwX3NlcnZlcl91dWlkQhMKEV9pbnRlZ3JhdGlvbl9uYW1lQhcKFV9pbnRlZ3JhdGlvbl9pY29uX3VybEIRCg9fbmVlZHNfYXBwcm92YWxCFAoSX2JhY2tlbmRfZXhlY3V0aW9uQggKBl90aXRsZUIRCg9fcmVhZF9vbmx5X2hpbnQiVgoNQW50aHJvcGljVG9vbBIVCgR0eXBlGAEgASgJQge6SARyAhABEi4KBG5hbWUYAiABKAlCILpIHXIbEAEYQDIVXlthLXpBLVowLTlfLV17MSw2NH0kIvABCgRUb29sEkAKDmNsYXVkZV9haV90b29sGAEgASgLMiYuYW50aHJvcGljLm1vYmlsZS52MWFscGhhLkNsYXVkZUFpVG9vbEgAElMKGGZyb250ZW5kX3JlbW90ZV9tY3BfdG9vbBgCIAEoCzIvLmFudGhyb3BpYy5tb2JpbGUudjFhbHBoYS5Gcm9udGVuZFJlbW90ZU1jcFRvb2xIABJBCg5hbnRocm9waWNfdG9vbBgDIAEoCzInLmFudGhyb3BpYy5tb2JpbGUudjFhbHBoYS5BbnRocm9waWNUb29sSABCDgoMdG9vbF92YXJpYW50IoABChFQZXJzb25hbGl6ZWRTdHlsZRIRCgR1dWlkGAEgASgJSACIAQESFwoKc3R5bGVfdHlwZRgCIAEoCUgBiAEBEicKBmNvbmZpZxgDIAEoCzIXLmdvb2dsZS5wcm90b2J1Zi5TdHJ1Y3RCBwoFX3V1aWRCDQoLX3N0eWxlX3R5cGUitQgKFEFwcGVuZE1lc3NhZ2VSZXF1ZXN0EiIKEW9yZ2FuaXphdGlvbl91dWlkGAEgASgJQge6SARyAhABEicKFmNoYXRfY29udmVyc2F0aW9uX3V1aWQYAiABKAlCB7pIBHICEAESDgoGcHJvbXB0GAMgASgJEhkKDHdvcmtzcGFjZV9pZBgEIAEoCUgAiAEBEiQKF3VzZV9hbGxfYXZhaWxhYmxlX3Rvb2xzGAUgASgISAGIAQESLQoFdG9vbHMYBiADKAsyHi5hbnRocm9waWMubW9iaWxlLnYxYWxwaGEuVG9vbBISCgVtb2RlbBgHIAEoCUgCiAEBEiEKFG1heF90b2tlbnNfdG9fc2FtcGxlGAggASgFSAOIAQESGAoLdGVtcGVyYXR1cmUYCSABKAJIBIgBARISCgV0b3BfaxgKIAEoBUgFiAEBEhIKBXRvcF9wGAsgASgCSAaIAQESFQoIdGltZXpvbmUYDCABKAlIB4gBARIhChRjdXN0b21fc3lzdGVtX3Byb21wdBgNIAEoCUgIiAEBEiAKE3BhcmVudF9tZXNzYWdlX3V1aWQYDiABKAlICYgBARIXCgppbnB1dF9tb2RlGA8gASgJSAqIAQESUQoOcmVuZGVyaW5nX21vZGUYECABKA4yNC5hbnRocm9waWMubW9iaWxlLnYxYWxwaGEuQ2xhdWRlTWVzc2FnZVJlbmRlcmluZ01vZGVIC4gBARIhChRpc19tb2JpbGVfYXBwX2ludGVudBgRIAEoCEgMiAEBEhsKDmlzX3ZvaWNlX2lucHV0GBIgASgISA2IAQESEwoGbG9jYWxlGBMgASgJSA6IAQESQAoLYXR0YWNobWVudHMYFCADKAsyKy5hbnRocm9waWMubW9iaWxlLnYxYWxwaGEuTWVzc2FnZUF0dGFjaG1lbnQSDQoFZmlsZXMYFSADKAkSFAoMc3luY19zb3VyY2VzGBYgAygJEkgKE3BlcnNvbmFsaXplZF9zdHlsZXMYFyADKAsyKy5hbnRocm9waWMubW9iaWxlLnYxYWxwaGEuUGVyc29uYWxpemVkU3R5bGVCDwoNX3dvcmtzcGFjZV9pZEIaChhfdXNlX2FsbF9hdmFpbGFibGVfdG9vbHNCCAoGX21vZGVsQhcKFV9tYXhfdG9rZW5zX3RvX3NhbXBsZUIOCgxfdGVtcGVyYXR1cmVCCAoGX3RvcF9rQggKBl90b3BfcEILCglfdGltZXpvbmVCFwoVX2N1c3RvbV9zeXN0ZW1fcHJvbXB0QhYKFF9wYXJlbnRfbWVzc2FnZV91dWlkQg0KC19pbnB1dF9tb2RlQhEKD19yZW5kZXJpbmdfbW9kZUIXChVfaXNfbW9iaWxlX2FwcF9pbnRlbnRCEQoPX2lzX3ZvaWNlX2lucHV0QgkKB19sb2NhbGUiowEKFUFwcGVuZE1lc3NhZ2VSZXNwb25zZRIoChVjb21wbGV0aW9uX2V2ZW50X2pzb24YASABKAlCB7pIBHICEAFIABJVChZjb21wbGV0aW9uX2V2ZW50X2Vycm9yGAIgASgLMjMuYW50aHJvcGljLm1vYmlsZS52MWFscGhhLkNvbXBsZXRpb25TdHJlYW1IVFRQRXJyb3JIAEIJCgdwYXlsb2FkIo8HChNSZXRyeU1lc3NhZ2VSZXF1ZXN0EiIKEW9yZ2FuaXphdGlvbl91dWlkGAEgASgJQge6SARyAhABEicKFmNoYXRfY29udmVyc2F0aW9uX3V1aWQYAiABKAlCB7pIBHICEAESIAoTcGFyZW50X21lc3NhZ2VfdXVpZBgDIAEoCUgAiAEBEhkKDHdvcmtzcGFjZV9pZBgEIAEoCUgBiAEBEiQKF3VzZV9hbGxfYXZhaWxhYmxlX3Rvb2xzGAUgASgISAKIAQESLQoFdG9vbHMYBiADKAsyHi5hbnRocm9waWMubW9iaWxlLnYxYWxwaGEuVG9vbBISCgVtb2RlbBgHIAEoCUgDiAEBEiEKFG1heF90b2tlbnNfdG9fc2FtcGxlGAggASgFSASIAQESEgoFdG9wX2sYCSABKAVIBYgBARISCgV0b3BfcBgKIAEoAkgGiAEBEhUKCHRpbWV6b25lGAsgASgJSAeIAQESIQoUY3VzdG9tX3N5c3RlbV9wcm9tcHQYDCABKAlICIgBARIXCgppbnB1dF9tb2RlGA0gASgJSAmIAQESUQoOcmVuZGVyaW5nX21vZGUYDiABKA4yNC5hbnRocm9waWMubW9iaWxlLnYxYWxwaGEuQ2xhdWRlTWVzc2FnZVJlbmRlcmluZ01vZGVICogBARIhChRpc19tb2JpbGVfYXBwX2ludGVudBgPIAEoCEgLiAEBEhMKBmxvY2FsZRgQIAEoCUgMiAEBEkgKE3BlcnNvbmFsaXplZF9zdHlsZXMYESADKAsyKy5hbnRocm9waWMubW9iaWxlLnYxYWxwaGEuUGVyc29uYWxpemVkU3R5bGUSGQoMcGFwcmlrYV9tb2RlGBIgASgJSA2IAQFCFgoUX3BhcmVudF9tZXNzYWdlX3V1aWRCDwoNX3dvcmtzcGFjZV9pZEIaChhfdXNlX2FsbF9hdmFpbGFibGVfdG9vbHNCCAoGX21vZGVsQhcKFV9tYXhfdG9rZW5zX3RvX3NhbXBsZUIICgZfdG9wX2tCCAoGX3RvcF9wQgsKCV90aW1lem9uZUIXChVfY3VzdG9tX3N5c3RlbV9wcm9tcHRCDQoLX2lucHV0X21vZGVCEQoPX3JlbmRlcmluZ19tb2RlQhcKFV9pc19tb2JpbGVfYXBwX2ludGVudEIJCgdfbG9jYWxlQg8KDV9wYXByaWthX21vZGUiogEKFFJldHJ5TWVzc2FnZVJlc3BvbnNlEigKFWNvbXBsZXRpb25fZXZlbnRfanNvbhgBIAEoCUIHukgEcgIQAUgAElUKFmNvbXBsZXRpb25fZXZlbnRfZXJyb3IYAiABKAsyMy5hbnRocm9waWMubW9iaWxlLnYxYWxwaGEuQ29tcGxldGlvblN0cmVhbUhUVFBFcnJvckgAQgkKB3BheWxvYWQq0AEKGkNsYXVkZU1lc3NhZ2VSZW5kZXJpbmdNb2RlEi0KKUNMQVVERV9NRVNTQUdFX1JFTkRFUklOR19NT0RFX1VOU1BFQ0lGSUVEEAASJQohQ0xBVURFX01FU1NBR0VfUkVOREVSSU5HX01PREVfUkFXEAESMAosQ0xBVURFX01FU1NBR0VfUkVOREVSSU5HX01PREVfUExBSU5fTUFSS0RPV04QAhIqCiZDTEFVREVfTUVTU0FHRV9SRU5ERVJJTkdfTU9ERV9NRVNTQUdFUxADMocFChFDb21wbGV0aW9uU2VydmljZRJ2Cg9HZXRDb252ZXJzYXRpb24SMC5hbnRocm9waWMubW9iaWxlLnYxYWxwaGEuR2V0Q29udmVyc2F0aW9uUmVxdWVzdBoxLmFudGhyb3BpYy5tb2JpbGUudjFhbHBoYS5HZXRDb252ZXJzYXRpb25SZXNwb25zZRKQAQoXU3RyZWFtUGVuZGluZ0NvbXBsZXRpb24SOC5hbnRocm9waWMubW9iaWxlLnYxYWxwaGEuU3RyZWFtUGVuZGluZ0NvbXBsZXRpb25SZXF1ZXN0GjkuYW50aHJvcGljLm1vYmlsZS52MWFscGhhLlN0cmVhbVBlbmRpbmdDb21wbGV0aW9uUmVzcG9uc2UwARKBAQoSQ3JlYXRlQ29udmVyc2F0aW9uEjMuYW50aHJvcGljLm1vYmlsZS52MWFscGhhLkNyZWF0ZUNvbnZlcnNhdGlvblJlcXVlc3QaNC5hbnRocm9waWMubW9iaWxlLnYxYWxwaGEuQ3JlYXRlQ29udmVyc2F0aW9uUmVzcG9uc2UwARJyCg1BcHBlbmRNZXNzYWdlEi4uYW50aHJvcGljLm1vYmlsZS52MWFscGhhLkFwcGVuZE1lc3NhZ2VSZXF1ZXN0Gi8uYW50aHJvcGljLm1vYmlsZS52MWFscGhhLkFwcGVuZE1lc3NhZ2VSZXNwb25zZTABEm8KDFJldHJ5TWVzc2FnZRItLmFudGhyb3BpYy5tb2JpbGUudjFhbHBoYS5SZXRyeU1lc3NhZ2VSZXF1ZXN0Gi4uYW50aHJvcGljLm1vYmlsZS52MWFscGhhLlJldHJ5TWVzc2FnZVJlc3BvbnNlMAFCsQEKHGNvbS5hbnRocm9waWMubW9iaWxlLnYxYWxwaGFCD0NvbXBsZXRpb25Qcm90b1ABogIDQU1YqgIYQW50aHJvcGljLk1vYmlsZS5WMWFscGhhygIYQW50aHJvcGljXE1vYmlsZVxWMWFscGhh4gIkQW50aHJvcGljXE1vYmlsZVxWMWFscGhhXEdQQk1ldGFkYXRh6gIaQW50aHJvcGljOjpNb2JpbGU6OlYxYWxwaGFiBnByb3RvMw",[i.V5,r.dA]),c=(0,o.Z)(s,3),d=(0,o.Z)(s,7),u=(0,o.Z)(s,8),h=(0,o.Z)(s,9),m=(0,o.Z)(s,10),g=(0,o.Z)(s,11),p=(0,o.Z)(s,13),b=(0,o.Z)(s,15);var f=function(e){return e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.RAW=1]="RAW",e[e.PLAIN_MARKDOWN=2]="PLAIN_MARKDOWN",e[e.MESSAGES=3]="MESSAGES",e}({});let x=(0,l.Z)(s,0)},0x207db90c9:(e,t,n)=>{n.d(t,{U:()=>i,q:()=>l});var a=n(0x9845e38c);let o=(e,t)=>a.v.error(e,"Error suppressed in wrapped function",t);function l(e,t){return function(){for(var n=arguments.length,a=Array(n),l=0;l<n;l++)a[l]=arguments[l];try{return e(...a)}catch(e){o(t,e)}}}function i(e,t){return async function(){for(var n=arguments.length,a=Array(n),l=0;l<n;l++)a[l]=arguments[l];try{return await e(...a)}catch(e){o(t,e)}}}},0x209ab1f87:(e,t,n)=>{n.d(t,{Z:()=>o});class a{setVisibilityCheck(e){this.checkFn=e}clearVisibilityCheck(){this.checkFn=null}isVisible(){return!this.checkFn||this.checkFn()}constructor(){this.checkFn=null}}let o=new a},0x226530adf:(e,t,n)=>{n.d(t,{Z3:()=>o.Z,c7:()=>l.c,x:()=>a.x}),n(0x23cebaa8a),n(0x538a5aea);var a=n(0x50e23a72),o=n(0x23b6b0e18);n(0x23c1bed08);var l=n(0x145d45a);n(0xe48b09ae)},0x23b6b0e18:(e,t,n)=>{n.d(t,{Z:()=>c,k:()=>s});var a=n(0x628a9a0b),o=n(0xac309a83),l=n(0x4d348f95),i=n(0x156c4e43b);let r=i.Ik({model:i.Yj().nullable()}).nullable(),s=e=>{let t=(0,a.mz)(e||""),n=(0,l.useSearchParams)(),o=null==n?void 0:n.get("model");return(null==t?void 0:t.model)?null==t?void 0:t.model:o||void 0},c=e=>{let t=s(e),n=(0,o.P0)("tepui_default_on_claude_free","model",null,o.Lu),a=(0,o.GZ)("frontend","console_default_model_override",null,r),l=(0,o.T9)("console_default_model","model",null,o.Lu);return t||n||(null==a?void 0:a.model)||l||"claude-3-5-haiku-latest"}},0x23c1bed08:(e,t,n)=>{n.d(t,{J:()=>l});var a=n(0x9dcf4143),o=n(0x1b2b72618);function l(e){let t={prompt:e.prompt,parent_message_uuid:e.parent_message_uuid,timezone:e.timezone,personalized_styles:e.personalized_style?[e.personalized_style]:void 0,locale:o.SC.includes(e.locale)?e.locale:o.Xn},n=(0,a.x)();return n&&(t.custom_system_prompt=n),e.model&&"string"==typeof e.model&&(t.model=e.model),e.modelOverride&&(t.model=e.modelOverride),"string"==typeof e.temperature&&(t.temperature=parseInt(e.temperature)),e.maxTokensToSample&&"string"==typeof e.maxTokensToSample&&(t.max_tokens_to_sample=parseInt(e.maxTokensToSample)),e.paprika_mode&&(t.paprika_mode=e.paprika_mode),e.tools.length&&(t.tools=e.tools),t}},0x23cebaa8a:(e,t,n)=>{n.d(t,{Tj:()=>r,Wf:()=>i,i7:()=>l});var a=n(0x22102fd88);n(0xfc89b4a4);var o=n(0x538a5aea);function l(e,t,n,l,i){var r;let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=null;if(e.message.includes("{")&&t)try{c=JSON.parse(e.message),l(c,t,n)}catch(e){}if((null==c?void 0:c.type)==="exceeded_limit"&&"concurrents"===c.representativeClaim)return void i((0,a.jsx)(o.cX,{}),{error:e});if("thinking_messages_rate_limit_exceeded"===e.errorCode)return void i((0,a.jsx)(o.jp,{}),{error:e});if("opus_messages_rate_limit_exceeded"===e.errorCode)throw e;if(s)return;let d=(null==c?void 0:c.type)==="exceeded_limit"&&"representativeClaim"in(r=c)&&void 0!==r.representativeClaim?c.resetsAt:void 0;i((0,a.jsx)(o.Qg,{resetsAtInSeconds:d}),{error:e})}function i(e,t,n,l,i,r,s){if("exceeded_max_uploads_per_message"===e.errorCode)return s((0,a.jsx)(o.$L,{}),{error:e}),!0;if("exceeded_max_image_limit_per_chat"===e.errorCode){let t=s((0,a.jsx)("p",{children:(0,a.jsx)(o.Go,{numSanitizedDocuments:n,onNewChat:()=>{i({projectUuid:l}),r(t)}})}),{error:e});return!0}if("invalid_request_error"===e.type&&413===e.statusCode){let n=s((0,a.jsx)("p",{children:(0,a.jsx)(o.J8,{numAttachmentsOrFiles:t,onNewChat:()=>{i({projectUuid:l}),r(n)}})}),{error:e});return!0}return!1}function r(e){return"not_found_error"===e.type&&("chat_conversation_not_found"===e.errorCode||e.message.toLowerCase().includes("unknown chat"))}},0x23f9bb43c:(e,t,n)=>{n.d(t,{i:()=>i});let a=(e,t,n)=>{let{blockSize:a,sliceBlock:o}=e,l=[];if(n<=0)return[];let i=0;for(let e of t){if(i+a(e)>=n){l.push(o(e,n-i));break}l.push(e),i+=a(e)}return l},o=1e3/60;class l{_get_smoothed_completion(){var e,t,n;if(0===this.start)return[];if(this.x>=this.totalCompletionLength)return this.smoothed_completion_is_unchanged=!0,a(this.blockOperations,this.blocksList,this.totalCompletionLength);let o=(Date.now()-this.start)/1e3,l=this.arrivals[this.arrivals.length-1][1]+(this.model_done||this.force_smoother_done?100:0),i=.9*o-(null!=(n=null==(e=(t=this.blockOperations).getBlockDeadlineOffset)?void 0:e.call(t))?n:.3),r=this.arrivals.filter(e=>e[0]<i).map(e=>e[1]),s=r[r.length-1],c=function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.01;if(t===n)return t;let o=e(t),l=e(n);if(t>=n)throw Error("Lower x is greater than upper x");if(o>a)throw Error("Lower f is greater than zero");if(l<-a)throw Error("Upper f is less than zero");for(;o<-a;){let a=(t+n)/2,i=e(a);i<=0?(t=a,o=i):(n=a,l=i)}return t}(e=>{let t=(e-this.x)/(o-this.t),n=1/(o-this.t);return 2*(this.force_smoother_done?.01*this.gamma:this.gamma)*n*(t-this.v)-1/(e-s)+1/(l-e)},s,l),d=(c-this.x)/(o-this.t);return this.v=this.alpha*this.v+(1-this.alpha)*d,this.smoothed_completion_is_unchanged=this.x>=this.totalCompletionLength,this.x=Math.max(c,this.x),this.t=o,this.stats.push({t:o,x:c,v:d,min_chars:s,max_chars:l}),a(this.blockOperations,this.blocksList,this.x)}get smootherDone(){return this.force_smoother_done||this.model_done&&this.x>=this.totalCompletionLength}addBlock(e,t){this.blocksList.push(t)}updateBlock(e,t){this.blocksList[e]=t}getBlocks(){return this.blocksList}onMessage(e){let t;switch(e.type){case"content_block_start":{let t=this.blockOperations.createBlockFromStartEvent(e);null!==t&&this.addBlock(e.index,t);break}case"content_block_delta":{let t=this.blocksList[e.index];if(!t)break;let n=this.blockOperations.applyDeltaEvent(e,t);this.updateBlock(e.index,n);break}case"content_block_stop":{let t=this.blocksList[e.index];if(!t)break;let n=this.blockOperations.stopBlockEvent(e,t);this.updateBlock(e.index,n);break}case"message_stop":this.model_done=!0}0===this.start&&(this.start=Date.now());let n=(t=this.blockOperations,this.blocksList.reduce((e,n)=>e+t.blockSize(n),0));if(this.totalCompletionLength=n,this.arrivals.push([(Date.now()-this.start)/1e3,n]),this.dont_smooth&&this.on_completion){let e=structuredClone(this.blocksList);this.on_completion(e)}}async task(e,t){for(;!this.smootherDone&&!t.aborted;){if(document.hidden){await new Promise(e=>setTimeout(e,200));continue}if(this.x>=this.totalCompletionLength&&this.model_done)break;if(this.blocksList.length>0){let t=this._get_smoothed_completion();this.smoothed_completion_is_unchanged||e(t)}let t=!0;if(this.checkVisibility){let e=Date.now();e-this.lastVisibilityCheck>1e3&&(this.cachedVisibility=this.checkVisibility(),this.lastVisibilityCheck=e),t=this.cachedVisibility}let n=t?o:100;await new Promise(e=>setTimeout(e,n))}}constructor(e){this.alpha=.99,this.gamma=1e-5,this.v=100,this.x=0,this.t=0,this.arrivals=[[-9999,0]],this.start=0,this.totalCompletionLength=0,this.smoothed_completion_is_unchanged=!1,this.dont_smooth=!1,this.model_done=!1,this.force_smoother_done=!1,this.stats=[],this.blocksList=[],this.lastVisibilityCheck=0,this.cachedVisibility=!0,this.blockOperations=e}}function i(){let e=new Map,t=!1;return new l({blockSize:e=>{if("text"===e.type)return e.text.length;if("thinking"===e.type)return e.thinking.length;if("tool_use"===e.type){var t;return(null==(t=e.partial_json)?void 0:t.length)||0}return e.type,0},sliceBlock:(e,t)=>{if("tool_result"===e.type)return e;if("text"===e.type)return{...e,text:e.text.slice(0,t)};if("tool_use"===e.type){var n;return{...e,partial_json:null==(n=e.partial_json)?void 0:n.slice(0,t)}}return"thinking"===e.type?{...e,thinking:e.thinking.slice(0,t)}:e},createBlockFromStartEvent:e=>("thinking"===e.content_block.type&&(e.content_block.start_timestamp=new Date().toISOString()),e.content_block),applyDeltaEvent:(n,a)=>{var o,l;if("flag_delta"===n.delta.type){let e=new Set(null!=(o=a.flags)?o:[]);e.add(n.delta.flag);let t=Array.from(e);return{...a,flags:t}}switch(a.type){case"text":switch(t=!1,n.delta.type){case"text_delta":return{...a,text:a.text+n.delta.text};case"citation_start_delta":{let t=n.delta.citation;return e.set(t.uuid,{...t,start_index:a.text.length}),a}case"citation_end_delta":{let t=n.delta.citation_uuid,o=e.get(t);if(!o)return a;let l=a.citations?[...a.citations]:[];return l.push({...o,end_index:a.text.length}),{...a,citations:l}}default:return a}case"thinking":switch(t=!0,n.delta.type){case"thinking_delta":return{...a,thinking:a.thinking+n.delta.thinking};case"thinking_summary_delta":return{...a,summaries:[...a.summaries||[],n.delta.summary]};case"thinking_cut_off_delta":return{...a,cut_off:n.delta.cut_off};default:return a}case"tool_result":if(t=!1,"input_json_delta"!==n.delta.type)return a;{let e;try{let t=JSON.parse(n.delta.partial_json);e=Array.isArray(t)&&t.length>0&&t.every(e=>"object"==typeof e&&null!==e&&"type"in e)?t:[{type:"text",text:n.delta.partial_json}]}catch(t){e=[{type:"text",text:n.delta.partial_json}]}return{...a,content:e}}case"tool_use":if(t=!1,"input_json_delta"===n.delta.type)return{...a,partial_json:(null!=(l=a.partial_json)?l:"")+n.delta.partial_json};return a}},stopBlockEvent:(e,t)=>{if("thinking"===t.type)return{...t,stop_timestamp:e.stop_timestamp};if("tool_use"===t.type){var n;return{...t,buffered_input:null!=(n=e.buffered_input)?n:"{}"}}return t},getBlockDeadlineOffset(){if(t)return 3}})}},0x244aea38b:(e,t,n)=>{n.d(t,{Jb:()=>r,US:()=>i});var a=n(0x9845e38c),o=n(0x207db90c9);let l=null;function i(){return l}let r=(0,o.U)(s,a.u.O11Y_INTERNALS);async function s(e){let{datadogRum:t}=await n.e(93975).then(n.bind(n,0xfe6ab197));t.init(e),l=t,a.v.info(a.u.O11Y_INTERNALS,"[DatadogRUM] Initialized",{service:e.service,env:e.env,version:e.version})}}}]);