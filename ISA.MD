ğŸš€ SUPRAX ISA v9.0 - FINAL SPECIFICATION
Open Source High-Performance ISA
Created by hobbyist collaboration with AI

ğŸ“ ARCHITECTURAL OVERVIEW
Core Parameters
apache
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ SUPRAX ISA - Fundamental Characteristics                                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                          â•‘
â•‘  Instruction Width:     128 bits (16 bytes) FIXED                       â•‘
â•‘  Opcode Size:           32 bits (6-bit type + 26-bit extended)          â•‘
â•‘  Register File:         256 architectural registers (r0-r255)           â•‘
â•‘  Register Addressing:   8 bits                                          â•‘
â•‘  Physical Registers:    3072 (12:1 rename ratio)                        â•‘
â•‘  Immediate Width:       Up to 64 bits (type-dependent)                  â•‘
â•‘  Memory Addressing:     64-bit flat address space                       â•‘
â•‘  Alignment:             All instructions 16-byte aligned                â•‘
â•‘  Endianness:            Little-endian                                   â•‘
â•‘  Register r0:           Hardwired to zero (writes ignored)              â•‘
â•‘                                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ—‚ï¸ TYPE ALLOCATION MAP
gcode
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ TYPE FIELD [127:122] - 64 Instruction Types                             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                          â•‘
â•‘ 0x00-0x07: CONTROL FLOW                                                 â•‘
â•‘   0x00  NOP        No operation                                         â•‘
â•‘   0x01  BR         Branch conditional                                   â•‘
â•‘   0x02  JMP        Unconditional jump (absolute)                        â•‘
â•‘   0x03  CALL       Call subroutine                                      â•‘
â•‘   0x04  RET        Return from subroutine                               â•‘
â•‘   0x05  CALLR      Call register-indirect                               â•‘
â•‘   0x06  JMPR       Jump register-indirect                               â•‘
â•‘   0x07  RESERVED                                                        â•‘
â•‘                                                                          â•‘
â•‘ 0x08-0x0F: SCALAR ALU                                                   â•‘
â•‘   0x08  ALU2       Dual-source ALU (Rd = Rs1 OP Rs2)                    â•‘
â•‘   0x09  ALU1       Single-source ALU (Rd = OP Rs1)                      â•‘
â•‘   0x0A  ALUI       ALU with immediate (Rd = Rs1 OP imm)                 â•‘
â•‘   0x0B  CMP        Compare (flags only, no writeback)                   â•‘
â•‘   0x0C  CMOV       Conditional move                                     â•‘
â•‘   0x0D  SEL        Select (Rd = cond ? Rs1 : Rs2)                       â•‘
â•‘   0x0E  RESERVED                                                        â•‘
â•‘   0x0F  RESERVED                                                        â•‘
â•‘                                                                          â•‘
â•‘ 0x10-0x17: PARALLEL ALU                                                 â•‘
â•‘   0x10  DUAL       2Ã— independent ALU ops (any combination)             â•‘
â•‘   0x11  TRIPLE     3Ã— independent ALU ops (any combination)             â•‘
â•‘   0x12  QUAD       4Ã— independent ALU ops (any combination)             â•‘
â•‘   0x13  RESERVED                                                        â•‘
â•‘   0x14  RESERVED                                                        â•‘
â•‘   0x15  RESERVED                                                        â•‘
â•‘   0x16  RESERVED                                                        â•‘
â•‘   0x17  RESERVED                                                        â•‘
â•‘                                                                          â•‘
â•‘ 0x18-0x1F: DATA MOVEMENT                                                â•‘
â•‘   0x18  MOVI       Move immediate (Rd = imm64)                          â•‘
â•‘   0x19  MOV        Move register (Rd = Rs)                              â•‘
â•‘   0x1A  SWAP       Swap two registers                                   â•‘
â•‘   0x1B  MVPAIR     Move register pair                                   â•‘
â•‘   0x1C  MVQUAD     Move 4 registers (parallel)                          â•‘
â•‘   0x1D  BCAST      Broadcast (imm â†’ multiple registers)                 â•‘
â•‘   0x1E  RESERVED                                                        â•‘
â•‘   0x1F  RESERVED                                                        â•‘
â•‘                                                                          â•‘
â•‘ 0x20-0x27: MEMORY LOAD                                                  â•‘
â•‘   0x20  LD         Load (Rd = Mem[Rs + imm])                            â•‘
â•‘   0x21  LDX        Load indexed (Rd = Mem[Rs1 + Rs2Ã—scale + imm])       â•‘
â•‘   0x22  LDA        Load absolute (Rd = Mem[imm64])                      â•‘
â•‘   0x23  LDPAIR     Load pair (consecutive addresses)                    â•‘
â•‘   0x24  LDQUAD     Load quad (4 consecutive values)                     â•‘
â•‘   0x25  PREFETCH   Prefetch to cache                                    â•‘
â•‘   0x26  RESERVED                                                        â•‘
â•‘   0x27  RESERVED                                                        â•‘
â•‘                                                                          â•‘
â•‘ 0x28-0x2F: MEMORY STORE                                                 â•‘
â•‘   0x28  ST         Store (Mem[Rs1 + imm] = Rs2)                         â•‘
â•‘   0x29  STX        Store indexed (Mem[Rs1 + Rs2Ã—scale + imm] = Rs3)     â•‘
â•‘   0x2A  STA        Store absolute (Mem[imm64] = Rs)                     â•‘
â•‘   0x2B  STPAIR     Store pair                                           â•‘
â•‘   0x2C  STQUAD     Store quad                                           â•‘
â•‘   0x2D  FLUSH      Flush cache line                                     â•‘
â•‘   0x2E  RESERVED                                                        â•‘
â•‘   0x2F  RESERVED                                                        â•‘
â•‘                                                                          â•‘
â•‘ 0x30-0x37: ATOMIC OPERATIONS                                            â•‘
â•‘   0x30  AMO        Atomic memory operation (ADD/AND/OR/XOR/SWAP)        â•‘
â•‘   0x31  CAS        Compare-and-swap                                     â•‘
â•‘   0x32  CAS2       Double-width CAS (128-bit)                           â•‘
â•‘   0x33  LL         Load-linked                                          â•‘
â•‘   0x34  SC         Store-conditional                                    â•‘
â•‘   0x35  AMOMAX     Atomic max/min operations                            â•‘
â•‘   0x36  RESERVED                                                        â•‘
â•‘   0x37  RESERVED                                                        â•‘
â•‘                                                                          â•‘
â•‘ 0x38-0x3F: SIMD/VECTOR                                                  â•‘
â•‘   0x38  VALU       Vector ALU (element-wise)                            â•‘
â•‘   0x39  VFMA       Vector fused multiply-add                            â•‘
â•‘   0x3A  VRED       Vector reduction (horizontal)                        â•‘
â•‘   0x3B  VSHUFFLE   Vector shuffle/permute                               â•‘
â•‘   0x3C  VEXTRACT   Extract vector element                               â•‘
â•‘   0x3D  VINSERT    Insert vector element                                â•‘
â•‘   0x3E  VBCAST     Broadcast scalar to vector                           â•‘
â•‘   0x3F  VCMP       Vector compare (generate mask)                       â•‘
â•‘                                                                          â•‘
â•‘ 0x40-0x47: SYSTEM/CONTROL                                               â•‘
â•‘   0x40  FENCE      Memory fence                                         â•‘
â•‘   0x41  CSRRW      CSR read-write                                       â•‘
â•‘   0x42  CSRR       CSR read-only                                        â•‘
â•‘   0x43  CSRW       CSR write-only                                       â•‘
â•‘   0x44  SYSCALL    System call                                          â•‘
â•‘   0x45  BREAK      Breakpoint                                           â•‘
â•‘   0x46  HALT       Halt processor                                       â•‘
â•‘   0x47  ERET       Exception return                                     â•‘
â•‘                                                                          â•‘
â•‘ 0x48-0x4F: BIT MANIPULATION                                             â•‘
â•‘   0x48  BITOPS     Bit operations (POPCNT/CLZ/CTZ/BSWAP)                â•‘
â•‘   0x49  BITFIELD   Bit field extract/insert                             â•‘
â•‘   0x4A  PDEP       Parallel bit deposit                                 â•‘
â•‘   0x4B  PEXT       Parallel bit extract                                 â•‘
â•‘   0x4C  CRC        CRC calculation                                      â•‘
â•‘   0x4D  RESERVED                                                        â•‘
â•‘   0x4E  RESERVED                                                        â•‘
â•‘   0x4F  RESERVED                                                        â•‘
â•‘                                                                          â•‘
â•‘ 0x50-0x57: FLOATING POINT                                               â•‘
â•‘   0x50  FP2        Dual FP operations                                   â•‘
â•‘   0x51  FPALU      Single FP operation                                  â•‘
â•‘   0x52  FPFMA      FP fused multiply-add                                â•‘
â•‘   0x53  FPCMP      FP compare                                           â•‘
â•‘   0x54  FPCONV     FP conversion                                        â•‘
â•‘   0x55  FPSQRT     FP square root                                       â•‘
â•‘   0x56  FPDIV      FP division                                          â•‘
â•‘   0x57  FPCLASS    FP classify (NaN/Inf/Zero)                           â•‘
â•‘                                                                          â•‘
â•‘ 0x58-0x3F: FUTURE EXPANSION (Reserved)                                  â•‘
â•‘                                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ INSTRUCTION FORMAT TEMPLATES
Format R: Register-Register Operations
json
  127      122 121      116 115                                         96
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   Type    â”‚ Operation â”‚            Reserved                         â”‚
  â”‚   [6b]    â”‚   [6b]    â”‚            [20b]                            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  95        88 87        80 79        72 71        70 69                 0
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Rs1      â”‚  Rs2      â”‚  Rd       â”‚ FlagUpdate â”‚   Reserved         â”‚
  â”‚  [8b]     â”‚  [8b]     â”‚  [8b]     â”‚   [2b]     â”‚   [70b]            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  FlagUpdate [71:70]:
    00: No flag update (preserve existing flags)
    01: Update flags from result
    10: Reserved
    11: Reserved

Total: 6 + 6 + 20 + 8 + 8 + 8 + 2 + 70 = 128 bits âœ…

Used by: ALU2, ALU1, CMP, CMOV, SEL, MOV, SWAP

Format I: Immediate Operations
json
  127      122 121      116 115                                         96
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   Type    â”‚ Operation â”‚            Reserved                         â”‚
  â”‚   [6b]    â”‚   [6b]    â”‚            [20b]                            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  95        88 87        80 79                                         16
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Rs       â”‚  Rd       â”‚  Immediate (64 bits)                         â”‚
  â”‚  [8b]     â”‚  [8b]     â”‚  [64b]                                       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  15        14 13                                                        0
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ FlagUpdate â”‚            Reserved                                     â”‚
  â”‚   [2b]     â”‚            [14b]                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Total: 6 + 6 + 20 + 8 + 8 + 64 + 2 + 14 = 128 bits âœ…

Used by: ALUI, MOVI, BCAST

Format M: Memory Operations
json
  127      122 121                113 112  110 109  108                  96
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   Type    â”‚      Reserved       â”‚  Size  â”‚ Sign  â”‚   Ordering         â”‚
  â”‚   [6b]    â”‚      [9b]           â”‚  [3b]  â”‚ [1b]  â”‚   [3b]             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  95        88 87        80 79                                         16
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Rs_addr  â”‚  Rd_data  â”‚  Offset (64 bits, signed)                    â”‚
  â”‚  [8b]     â”‚  [8b]     â”‚  [64b]                                       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  15                                                                      0
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                        Reserved                                     â”‚
  â”‚                        [16b]                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Size [112:110]:
    000: 8-bit (byte)
    001: 16-bit (halfword)
    010: 32-bit (word)
    011: 64-bit (doubleword)
    100-111: Reserved (future 128/256/512-bit)
    
  Sign [109]:
    0: Zero-extend (unsigned)
    1: Sign-extend (signed)
    
  Ordering [108:106]:
    000: Normal (relaxed)
    001: Acquire (load-acquire)
    010: Release (store-release)
    011: AcqRel (both)
    100: SeqCst (sequentially consistent)
    101-111: Reserved

Total: 6 + 9 + 3 + 1 + 3 + 8 + 8 + 64 + 16 = 128 bits âœ…

Used by: LD, ST, LDA, STA

Format X: Indexed Memory Operations
json
  127      122 121                113 112  110 109  108            103 102 96
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   Type    â”‚      Reserved       â”‚  Size  â”‚ Sign  â”‚  Reserved    â”‚ Scale â”‚
  â”‚   [6b]    â”‚      [9b]           â”‚  [3b]  â”‚ [1b]  â”‚  [6b]        â”‚ [3b]  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜
  95        88 87        80 79        72 71                                16
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Rs_base  â”‚  Rs_index â”‚  Rd_data  â”‚  Offset (56 bits, signed)            â”‚
  â”‚  [8b]     â”‚  [8b]     â”‚  [8b]     â”‚  [56b]                               â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  15                                                                         0
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                        Reserved                                          â”‚
  â”‚                        [16b]                                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Scale [102:100]:
    000: Ã—1 (byte)
    001: Ã—2 (halfword)
    010: Ã—4 (word)
    011: Ã—8 (doubleword)
    100: Ã—16
    101-111: Reserved

Total: 6 + 9 + 3 + 1 + 6 + 3 + 8 + 8 + 8 + 56 + 16 = 128 bits âœ…

Used by: LDX, STX

Address calculation: EA = Rs_base + (Rs_index << scale) + sign_extend(offset)

Format D: Dual Parallel ALU
json
  127      122 121      116 115      110 109                     98 97  96
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   Type    â”‚   Op A    â”‚   Op B    â”‚      Reserved            â”‚FlagSel â”‚
  â”‚   [6b]    â”‚   [6b]    â”‚   [6b]    â”‚      [12b]               â”‚ [2b]   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  95     88 87     80 79     72 71     64 63     56 55     48 47         0
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ A:Rs1   â”‚ A:Rs2   â”‚ A:Rd    â”‚ B:Rs1   â”‚ B:Rs2   â”‚ B:Rd    â”‚ Reserved â”‚
  â”‚  [8b]   â”‚  [8b]   â”‚  [8b]   â”‚  [8b]   â”‚  [8b]   â”‚  [8b]   â”‚  [48b]   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  FlagSel [97:96]:
    00: No flags updated
    01: Operation A updates flags
    10: Operation B updates flags
    11: Both update flags (B's flags win, last write)

Total: 6 + 6 + 6 + 12 + 2 + 48 + 48 = 128 bits âœ…

Used by: DUAL

Format T: Triple Parallel ALU
json
  127      122 121      116 115      110 109      104 103            98 97 96
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
  â”‚   Type    â”‚   Op A    â”‚   Op B    â”‚   Op C    â”‚    Reserved      â”‚FlagSeâ”‚
  â”‚   [6b]    â”‚   [6b]    â”‚   [6b]    â”‚   [6b]    â”‚    [6b]          â”‚ [2b] â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
  95     88 87     80 79     72 71     64 63     56 55     48 47     40 39  32
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
  â”‚ A:Rs1   â”‚ A:Rs2   â”‚ A:Rd    â”‚ B:Rs1   â”‚ B:Rs2   â”‚ B:Rd    â”‚ C:Rs1   â”‚C:Rs2â”‚
  â”‚  [8b]   â”‚  [8b]   â”‚  [8b]   â”‚  [8b]   â”‚  [8b]   â”‚  [8b]   â”‚  [8b]   â”‚ [8b]â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
  31     24 23                                                            0
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ C:Rd    â”‚                    Reserved                                  â”‚
  â”‚  [8b]   â”‚                    [24b]                                     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  FlagSel [97:96]:
    00: No flags updated
    01: Operation A updates flags
    10: Operation B updates flags
    11: Operation C updates flags

Total: 6 + 6 + 6 + 6 + 6 + 2 + 72 + 24 = 128 bits âœ…

Used by: TRIPLE

Format Q: Quad Parallel ALU
json
  127      122 121      116 115      110 109      104 103            98 97 96
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
  â”‚   Type    â”‚   Op A    â”‚   Op B    â”‚   Op C    â”‚    Op D          â”‚FlagSeâ”‚
  â”‚   [6b]    â”‚   [6b]    â”‚   [6b]    â”‚   [6b]    â”‚    [6b]          â”‚ [2b] â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜
  95     88 87     80 79     72 71     64 63     56 55     48 47     40 39  32
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
  â”‚ A:Rs1   â”‚ A:Rs2   â”‚ A:Rd    â”‚ B:Rs1   â”‚ B:Rs2   â”‚ B:Rd    â”‚ C:Rs1   â”‚C:Rs2â”‚
  â”‚  [8b]   â”‚  [8b]   â”‚  [8b]   â”‚  [8b]   â”‚  [8b]   â”‚  [8b]   â”‚  [8b]   â”‚ [8b]â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜
  31     24 23     16 15      8 7                                         0
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ C:Rd    â”‚ D:Rs1   â”‚ D:Rs2   â”‚ D:Rd                                     â”‚
  â”‚  [8b]   â”‚  [8b]   â”‚  [8b]   â”‚  [8b]                                    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  FlagSel [97:96]:
    00: No flags updated
    01: Operation A updates flags
    10: Operation B updates flags
    11: Operation C updates flags
    (Note: Op D never updates flags in this encoding)

Total: 6 + 6 + 6 + 6 + 6 + 2 + 96 = 128 bits âœ…

Used by: QUAD

Format B: Branch Operations
json
  127      122 121      118 117                                         96
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   Type    â”‚ Condition â”‚            Reserved                         â”‚
  â”‚   [6b]    â”‚   [4b]    â”‚            [22b]                            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  95                                                                    32
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                  Target Address (64 bits)                          â”‚
  â”‚                  [64b]                                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  31                                                                     0
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                        Reserved                                    â”‚
  â”‚                        [32b]                                       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Condition [121:118]:
    0x0: ALWAYS (unconditional)
    0x1: EQ  (ZF=1)
    0x2: NE  (ZF=0)
    0x3: LT  (SFâ‰ OF, signed less)
    0x4: LE  (ZF=1 || SFâ‰ OF)
    0x5: GT  (ZF=0 && SF=OF)
    0x6: GE  (SF=OF)
    0x7: LTU (CF=1, unsigned less)
    0x8: LEU (CF=1 || ZF=1)
    0x9: GTU (CF=0 && ZF=0)
    0xA: GEU (CF=0)
    0xB: OF  (OF=1)
    0xC: NOF (OF=0)
    0xD: SF  (SF=1, negative)
    0xE: NSF (SF=0, positive/zero)
    0xF: NEVER (always fall through)

Total: 6 + 4 + 22 + 64 + 32 = 128 bits âœ…

Used by: BR, JMP (JMP uses condition=ALWAYS)

Format C: Call/Return Operations
json
  127      122 121                                                      96
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   Type    â”‚                   Reserved                              â”‚
  â”‚   [6b]    â”‚                   [26b]                                 â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  95        88 87                                                      32
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Rd_link  â”‚  Target Address (56 bits)                                â”‚
  â”‚  [8b]     â”‚  [56b]                                                   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  31                                                                     0
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                        Reserved                                    â”‚
  â”‚                        [32b]                                       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Total: 6 + 26 + 8 + 56 + 32 = 128 bits âœ…

Used by: CALL, CALLR, RET

Format V: Vector/SIMD Operations
json
  127      122 121      116 115  113 112                               96
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   Type    â”‚ Operation â”‚ElemWidthâ”‚         Reserved                    â”‚
  â”‚   [6b]    â”‚   [6b]    â”‚  [3b]  â”‚         [17b]                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  95        88 87        80 79        72 71                               0
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Rs1      â”‚  Rs2      â”‚  Rd       â”‚         Reserved                   â”‚
  â”‚  [8b]     â”‚  [8b]     â”‚  [8b]     â”‚         [72b]                      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ElemWidth [115:113]:
    000: Reserved
    001: 8-bit elements (8Ã— ops per 64-bit register)
    010: 16-bit elements (4Ã— ops)
    011: 32-bit elements (2Ã— ops)
    100: 64-bit elements (1Ã— op, scalar)
    101-111: Reserved (future 128/256/512-bit)

Total: 6 + 6 + 3 + 17 + 8 + 8 + 8 + 72 = 128 bits âœ…

Used by: VALU, VFMA, VCMP

Format A: Atomic Operations
json
  127      122 121      116 115  113 112  110 109                       96
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   Type    â”‚   AMO Op  â”‚  Size  â”‚ Order  â”‚         Reserved             â”‚
  â”‚   [6b]    â”‚   [6b]    â”‚  [3b]  â”‚  [3b]  â”‚         [14b]                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  95        88 87        80 79                                         16
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Rs_new   â”‚  Rd_old   â”‚  Address (64 bits)                           â”‚
  â”‚  [8b]     â”‚  [8b]     â”‚  [64b]                                       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  15                                                                      0
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                        Reserved                                     â”‚
  â”‚                        [16b]                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  AMO Op [121:116]:
    0x00: SWAP    Atomic exchange
    0x01: ADD     Fetch-and-add
    0x02: SUB     Fetch-and-sub
    0x03: AND     Fetch-and-AND
    0x04: OR      Fetch-and-OR
    0x05: XOR     Fetch-and-XOR
    0x06: MIN     Fetch-and-min (signed)
    0x07: MAX     Fetch-and-max (signed)
    0x08: MINU    Fetch-and-min (unsigned)
    0x09: MAXU    Fetch-and-max (unsigned)
    0x0A-0x3F: Reserved
    
  Order [112:110]:
    000: RELAXED
    001: ACQUIRE
    010: RELEASE
    011: ACQ_REL
    100: SEQ_CST
    101-111: Reserved

Total: 6 + 6 + 3 + 3 + 14 + 8 + 8 + 64 + 16 = 128 bits âœ…

Used by: AMO, AMOMAX

Format CAS: Compare-And-Swap
json
  127      122 121                113 112  110 109                       96
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   Type    â”‚      Reserved       â”‚  Size  â”‚         Reserved             â”‚
  â”‚   [6b]    â”‚      [9b]           â”‚  [3b]  â”‚         [14b]                â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  95        88 87        80 79        72 71                              16
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Rs_new   â”‚  Rs_cmp   â”‚  Rd_old   â”‚  Address (56 bits)                 â”‚
  â”‚  [8b]     â”‚  [8b]     â”‚  [8b]     â”‚  [56b]                             â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  15                                                                       0
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                        Reserved                                      â”‚
  â”‚                        [16b]                                         â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Total: 6 + 9 + 3 + 14 + 8 + 8 + 8 + 56 + 16 = 128 bits âœ…

Used by: CAS, CAS2

Format S: System/CSR Operations
json
  127      122 121      116 115                                         96
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   Type    â”‚  Sub-op   â”‚            Reserved                         â”‚
  â”‚   [6b]    â”‚   [6b]    â”‚            [20b]                            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  95        88 87        80 79                                         16
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Rs       â”‚  Rd       â”‚  CSR Address / Immediate (64 bits)           â”‚
  â”‚  [8b]     â”‚  [8b]     â”‚  [64b]                                       â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  15                                                                      0
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚                        Reserved                                     â”‚
  â”‚                        [16b]                                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Total: 6 + 6 + 20 + 8 + 8 + 64 + 16 = 128 bits âœ…

Used by: CSRRW, CSRR, CSRW, SYSCALL, FENCE

ğŸ”§ OPERATION ENCODINGS
ALU Operations (6 bits, used in Operation field)
ini
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ OPERATION FIELD [121:116] - ALU Operations                              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                          â•‘
â•‘ 0x00-0x0F: ARITHMETIC                                                   â•‘
â•‘   0x00  ADD        Rd = Rs1 + Rs2                                       â•‘
â•‘   0x01  SUB        Rd = Rs1 - Rs2                                       â•‘
â•‘   0x02  RSUB       Rd = Rs2 - Rs1 (reverse subtract)                    â•‘
â•‘   0x03  MUL        Rd = (Rs1 Ã— Rs2)[63:0]                               â•‘
â•‘   0x04  MULH       Rd = (Rs1 Ã— Rs2)[127:64] (signed)                    â•‘
â•‘   0x05  MULHU      Rd = (Rs1 Ã— Rs2)[127:64] (unsigned)                  â•‘
â•‘   0x06  MULHSU     Rd = (signed Rs1 Ã— unsigned Rs2)[127:64]             â•‘
â•‘   0x07  DIV        Rd = Rs1 / Rs2 (signed)                              â•‘
â•‘   0x08  DIVU       Rd = Rs1 / Rs2 (unsigned)                            â•‘
â•‘   0x09  REM        Rd = Rs1 % Rs2 (signed remainder)                    â•‘
â•‘   0x0A  REMU       Rd = Rs1 % Rs2 (unsigned remainder)                  â•‘
â•‘   0x0B  NEG        Rd = -Rs1 (two's complement)                         â•‘
â•‘   0x0C  ABS        Rd = |Rs1| (absolute value)                          â•‘
â•‘   0x0D  INC        Rd = Rs1 + 1                                         â•‘
â•‘   0x0E  DEC        Rd = Rs1 - 1                                         â•‘
â•‘   0x0F  ADDC       Rd = Rs1 + Rs2 + CF (add with carry)                 â•‘
â•‘                                                                          â•‘
â•‘ 0x10-0x1F: LOGICAL                                                      â•‘
â•‘   0x10  AND        Rd = Rs1 & Rs2                                       â•‘
â•‘   0x11  OR         Rd = Rs1 | Rs2                                       â•‘
â•‘   0x12  XOR        Rd = Rs1 ^ Rs2                                       â•‘
â•‘   0x13  NOT        Rd = ~Rs1                                            â•‘
â•‘   0x14  NAND       Rd = ~(Rs1 & Rs2)                                    â•‘
â•‘   0x15  NOR        Rd = ~(Rs1 | Rs2)                                    â•‘
â•‘   0x16  XNOR       Rd = ~(Rs1 ^ Rs2)                                    â•‘
â•‘   0x17  ANDN       Rd = Rs1 & ~Rs2 (and-not)                            â•‘
â•‘   0x18  ORN        Rd = Rs1 | ~Rs2 (or-not)                             â•‘
â•‘   0x19  TEST       Rd = (Rs1 & Rs2) ? 1 : 0                             â•‘
â•‘   0x1A-0x1F: Reserved                                                   â•‘
â•‘                                                                          â•‘
â•‘ 0x20-0x2F: SHIFTS                                                       â•‘
â•‘   0x20  SLL        Rd = Rs1 << Rs2 (shift left logical)                 â•‘
â•‘   0x21  SRL        Rd = Rs1 >> Rs2 (shift right logical)                â•‘
â•‘   0x22  SRA        Rd = Rs1 >> Rs2 (shift right arithmetic)             â•‘
â•‘   0x23  ROL        Rd = rotate_left(Rs1, Rs2)                           â•‘
â•‘   0x24  ROR        Rd = rotate_right(Rs1, Rs2)                          â•‘
â•‘   0x25  FUNNEL     Rd = funnel_shift(Rs1, Rs2, shift_amt)               â•‘
â•‘   0x26-0x2F: Reserved                                                   â•‘
â•‘                                                                          â•‘
â•‘ 0x30-0x3F: COMPARE & SELECT                                             â•‘
â•‘   0x30  SEQ        Rd = (Rs1 == Rs2) ? 1 : 0                            â•‘
â•‘   0x31  SNE        Rd = (Rs1 != Rs2) ? 1 : 0                            â•‘
â•‘   0x32  SLT        Rd = (Rs1 < Rs2) ? 1 : 0 (signed)                    â•‘
â•‘   0x33  SLE        Rd = (Rs1 <= Rs2) ? 1 : 0 (signed)                   â•‘
â•‘   0x34  SGT        Rd = (Rs1 > Rs2) ? 1 : 0 (signed)                    â•‘
â•‘   0x35  SGE        Rd = (Rs1 >= Rs2) ? 1 : 0 (signed)                   â•‘
â•‘   0x36  SLTU       Rd = (Rs1 < Rs2) ? 1 : 0 (unsigned)                  â•‘
â•‘   0x37  SLEU       Rd = (Rs1 <= Rs2) ? 1 : 0 (unsigned)                 â•‘
â•‘   0x38  SGTU       Rd = (Rs1 > Rs2) ? 1 : 0 (unsigned)                  â•‘
â•‘   0x39  SGEU       Rd = (Rs1 >= Rs2) ? 1 : 0 (unsigned)                 â•‘
â•‘   0x3A  MIN        Rd = min(Rs1, Rs2) (signed)                          â•‘
â•‘   0x3B  MAX        Rd = max(Rs1, Rs2) (signed)                          â•‘
â•‘   0x3C  MINU       Rd = min(Rs1, Rs2) (unsigned)                        â•‘
â•‘   0x3D  MAXU       Rd = max(Rs1, Rs2) (unsigned)                        â•‘
â•‘   0x3E-0x3F: Reserved                                                   â•‘
â•‘                                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Flag Update Logic (Performance-Optimized)
clojure
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ FLAG UPDATE SPECIFICATION                                                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                          â•‘
â•‘ Flags: ZF (Zero), SF (Sign), CF (Carry), OF (Overflow), PF (Parity)     â•‘
â•‘                                                                          â•‘
â•‘ ARITHMETIC OPERATIONS:                                                   â•‘
â•‘   ADD, SUB, RSUB, ADDC:                                                  â•‘
â•‘     ZF = (result == 0)                                                   â•‘
â•‘     SF = result[63]                                                      â•‘
â•‘     CF = carry_out (ADD) / borrow (SUB)                                  â•‘
â•‘     OF = signed_overflow                                                 â•‘
â•‘     PF = parity(result[7:0])                                             â•‘
â•‘                                                                          â•‘
â•‘   MUL, MULH, MULHU, MULHSU:                                              â•‘
â•‘     ZF = (result == 0)                                                   â•‘
â•‘     SF = result[63]                                                      â•‘
â•‘     CF = 0                                                               â•‘
â•‘     OF = (high_bits != sign_extension(low_bits))                         â•‘
â•‘     PF = parity(result[7:0])                                             â•‘
â•‘                                                                          â•‘
â•‘   DIV, DIVU, REM, REMU:                                                  â•‘
â•‘     ZF = (result == 0)                                                   â•‘
â•‘     SF = result[63]                                                      â•‘
â•‘     CF = 0                                                               â•‘
â•‘     OF = 0                                                               â•‘
â•‘     PF = parity(result[7:0])                                             â•‘
â•‘                                                                          â•‘
â•‘   NEG, ABS:                                                              â•‘
â•‘     ZF = (result == 0)                                                   â•‘
â•‘     SF = result[63]                                                      â•‘
â•‘     CF = (result != 0)  // borrow from zero                              â•‘
â•‘     OF = (original == 0x8000000000000000 && op == NEG)                   â•‘
â•‘     PF = parity(result[7:0])                                             â•‘
â•‘                                                                          â•‘
â•‘   INC, DEC:                                                              â•‘
â•‘     ZF = (result == 0)                                                   â•‘
â•‘     SF = result[63]                                                      â•‘
â•‘     CF = unchanged (preserved from previous operation)                   â•‘
â•‘     OF = overflow occurred                                               â•‘
â•‘     PF = parity(result[7:0])                                             â•‘
â•‘                                                                          â•‘
â•‘ LOGICAL OPERATIONS:                                                      â•‘
â•‘   AND, OR, XOR, NOT, NAND, NOR, XNOR, ANDN, ORN, TEST:                  â•‘
â•‘     ZF = (result == 0)                                                   â•‘
â•‘     SF = result[63]                                                      â•‘
â•‘     CF = 0                                                               â•‘
â•‘     OF = 0                                                               â•‘
â•‘     PF = parity(result[7:0])                                             â•‘
â•‘                                                                          â•‘
â•‘ SHIFT/ROTATE OPERATIONS:                                                 â•‘
â•‘   SLL:                                                                   â•‘
â•‘     ZF = (result == 0)                                                   â•‘
â•‘     SF = result[63]                                                      â•‘
â•‘     CF = last_bit_shifted_out (or 0 if shift count == 0)                â•‘
â•‘     OF = (result[63] != original[63]) if shift == 1, else undefined     â•‘
â•‘     PF = parity(result[7:0])                                             â•‘
â•‘                                                                          â•‘
â•‘   SRL, SRA:                                                              â•‘
â•‘     ZF = (result == 0)                                                   â•‘
â•‘     SF = result[63]                                                      â•‘
â•‘     CF = last_bit_shifted_out (or 0 if shift count == 0)                â•‘
â•‘     OF = 0 (SRL) / original[63] (SRA, if shift == 1)                    â•‘
â•‘     PF = parity(result[7:0])                                             â•‘
â•‘                                                                          â•‘
â•‘   ROL, ROR:                                                              â•‘
â•‘     ZF = (result == 0)                                                   â•‘
â•‘     SF = result[63]                                                      â•‘
â•‘     CF = bit_rotated_into_CF                                             â•‘
â•‘     OF = result[63] XOR result[62] (if rotate count == 1)                â•‘
â•‘     PF = parity(result[7:0])                                             â•‘
â•‘                                                                          â•‘
â•‘ COMPARE OPERATIONS (CMP):                                                â•‘
â•‘   Same as SUB, but result is discarded (only flags updated)              â•‘
â•‘                                                                          â•‘
â•‘ SET OPERATIONS (SEQ, SNE, SLT, etc.):                                    â•‘
â•‘   Only update result register (0 or 1), flags unchanged                  â•‘
â•‘                                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ’¾ MEMORY SUBSYSTEM (Performance-Optimized)
Cache Hierarchy
dsconfig
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ L1 Instruction Cache                                                     â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  Size:              64 KB                                                â•‘
â•‘  Associativity:     8-way set-associative                                â•‘
â•‘  Line Size:         64 bytes                                             â•‘
â•‘  Latency:           3 cycles                                             â•‘
â•‘  Bandwidth:         16 bytes/cycle (1 instruction)                       â•‘
â•‘  Replacement:       Pseudo-LRU                                           â•‘
â•‘  Prefetch:          Next-line + stream prefetcher                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ L1 Data Cache                                                            â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  Size:              64 KB                                                â•‘
â•‘  Associativity:     8-way set-associative                                â•‘
â•‘  Line Size:         64 bytes                                             â•‘
â•‘  Latency:           4 cycles (load-to-use)                               â•‘
â•‘  Bandwidth:         2 loads + 1 store per cycle (3 ports)                â•‘
â•‘  Write Policy:      Write-back, write-allocate                           â•‘
â•‘  Replacement:       Pseudo-LRU                                           â•‘
â•‘  Prefetch:          Stride + stream prefetcher                           â•‘
â•‘  MSHR:              16 miss-status holding registers                     â•‘
â•‘  Store Buffer:      64 entries with coalescing                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ L2 Cache (Private per core)                                             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  Size:              512 KB                                               â•‘
â•‘  Associativity:     16-way set-associative                               â•‘
â•‘  Line Size:         64 bytes                                             â•‘
â•‘  Latency:           12 cycles                                            â•‘
â•‘  Bandwidth:         64 bytes/cycle                                       â•‘
â•‘  Write Policy:      Write-back, inclusive of L1                          â•‘
â•‘  Replacement:       Adaptive insertion (pseudo-LRU + bimodal)            â•‘
â•‘  Prefetch:          Multi-stride + region prefetcher                     â•‘
â•‘  MSHR:              32 entries                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ L3 Cache (Shared, distributed slices)                                   â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  Size:              32 MB (total, 2 MB per slice Ã— 16 slices)            â•‘
â•‘  Associativity:     16-way set-associative                               â•‘
â•‘  Line Size:         64 bytes                                             â•‘
â•‘  Latency:           35-50 cycles (depends on slice distance)             â•‘
â•‘  Bandwidth:         128 bytes/cycle (aggregate across slices)            â•‘
â•‘  Write Policy:      Write-back, non-inclusive                            â•‘
â•‘  Replacement:       RRIP (Re-Reference Interval Prediction)              â•‘
â•‘  Directory:         MESI coherence protocol (see below)                  â•‘
â•‘  Hashing:           XOR-based address hashing for slice distribution     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TLB Hierarchy
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ L1 ITLB (Instruction)                                                    â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  Entries:           128 (fully associative)                              â•‘
â•‘  Page Sizes:        4 KB, 2 MB, 1 GB                                     â•‘
â•‘  Latency:           0 cycles (parallel with I-Cache)                     â•‘
â•‘  Replacement:       LRU                                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ L1 DTLB (Data)                                                           â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  Entries:           128 (fully associative)                              â•‘
â•‘  Page Sizes:        4 KB, 2 MB, 1 GB                                     â•‘
â•‘  Latency:           0 cycles (parallel with D-Cache)                     â•‘
â•‘  Replacement:       LRU                                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ L2 TLB (Unified)                                                         â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  Entries:           2048 (8-way set-associative)                         â•‘
â•‘  Page Sizes:        4 KB, 2 MB, 1 GB                                     â•‘
â•‘  Latency:           8 cycles (on L1 TLB miss)                            â•‘
â•‘  Replacement:       Pseudo-LRU                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Page Walk Latency:    25-100 cycles (on L2 TLB miss)
Page Table Support:   Sv39, Sv48, Sv57 (3/4/5-level page tables)

Memory Ordering Model: Total Store Ordering (TSO)
sql_more
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ TOTAL STORE ORDERING (TSO) SPECIFICATION                                 â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                          â•‘
â•‘ Ordering Guarantees:                                                     â•‘
â•‘   Load  â†’ Load   : Ordered (cannot reorder)                              â•‘
â•‘   Load  â†’ Store  : Ordered                                               â•‘
â•‘   Store â†’ Store  : Ordered                                               â•‘
â•‘   Store â†’ Load   : MAY BE REORDERED (requires FENCE if dependent)        â•‘
â•‘                                                                          â•‘
â•‘ Atomic Operations:                                                       â•‘
â•‘   - All atomics (AMO, CAS, LL/SC) are sequentially consistent            â•‘
â•‘   - No reordering across atomic operations                               â•‘
â•‘   - Atomics act as implicit acquire/release barriers                     â•‘
â•‘                                                                          â•‘
â•‘ Store Buffer:                                                            â•‘
â•‘   - Stores posted to buffer, visible to same hart immediately            â•‘
â•‘   - Visible to other harts when buffer drains to cache                   â•‘
â•‘   - Store-to-load forwarding: 1 cycle penalty for local forwarding       â•‘
â•‘                                                                          â•‘
â•‘ FENCE Semantics:                                                         â•‘
â•‘   FENCE.R   - All prior loads complete before subsequent loads           â•‘
â•‘   FENCE.W   - All prior stores complete before subsequent stores         â•‘
â•‘   FENCE.RW  - Full barrier (all memory ops complete)                     â•‘
â•‘   FENCE.SYNC- Synchronize all harts (heavyweight, for IPIs)              â•‘
â•‘                                                                          â•‘
â•‘ Memory Ordering Annotations (LD/ST):                                     â•‘
â•‘   NORMAL    - TSO ordering                                               â•‘
â•‘   ACQUIRE   - No subsequent memory ops can move before this load         â•‘
â•‘   RELEASE   - No prior memory ops can move after this store              â•‘
â•‘   ACQ_REL   - Both acquire and release                                   â•‘
â•‘   SEQ_CST   - Sequentially consistent (implies full barrier)             â•‘
â•‘                                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Cache Coherence Protocol: MESI
sql_more
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ MESI CACHE COHERENCE PROTOCOL                                            â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                          â•‘
â•‘ States:                                                                  â•‘
â•‘   M (Modified)   - Dirty, exclusive, must write back before eviction     â•‘
â•‘   E (Exclusive)  - Clean, exclusive, can silently transition to M        â•‘
â•‘   S (Shared)     - Clean, shared with other caches, read-only            â•‘
â•‘   I (Invalid)    - Not present in cache                                  â•‘
â•‘                                                                          â•‘
â•‘ State Transitions:                                                       â•‘
â•‘                                                                          â•‘
â•‘   Local Read (Load):                                                     â•‘
â•‘     I â†’ E  (if no other cache has it)                                    â•‘
â•‘     I â†’ S  (if other caches have it)                                     â•‘
â•‘     E â†’ E  (hit)                                                         â•‘
â•‘     S â†’ S  (hit)                                                         â•‘
â•‘     M â†’ M  (hit)                                                         â•‘
â•‘                                                                          â•‘
â•‘   Local Write (Store):                                                   â•‘
â•‘     I â†’ M  (allocate, invalidate others)                                 â•‘
â•‘     E â†’ M  (silent transition, no bus traffic)                           â•‘
â•‘     S â†’ M  (invalidate all other copies)                                 â•‘
â•‘     M â†’ M  (hit, no state change)                                        â•‘
â•‘                                                                          â•‘
â•‘   Remote Read (Snoop):                                                   â•‘
â•‘     M â†’ S  (write back dirty data, downgrade to shared)                  â•‘
â•‘     E â†’ S  (downgrade to shared)                                         â•‘
â•‘     S â†’ S  (no change)                                                   â•‘
â•‘     I â†’ I  (no change)                                                   â•‘
â•‘                                                                          â•‘
â•‘   Remote Write (Snoop):                                                  â•‘
â•‘     M â†’ I  (write back dirty data, invalidate)                           â•‘
â•‘     E â†’ I  (invalidate)                                                  â•‘
â•‘     S â†’ I  (invalidate)                                                  â•‘
â•‘     I â†’ I  (no change)                                                   â•‘
â•‘                                                                          â•‘
â•‘ Atomic Operations:                                                       â•‘
â•‘   - AMO/CAS require cache line in 'M' (Modified) state                   â•‘
â•‘   - If in S/E/I state: upgrade to M (invalidate all other copies)        â•‘
â•‘   - Atomic op executes only when line is in exclusive M state            â•‘
â•‘   - Guarantees atomicity across all harts                                â•‘
â•‘                                                                          â•‘
â•‘ LL/SC Implementation:                                                    â•‘
â•‘   - LL marks cache line with exclusive monitor                           â•‘
â•‘   - Monitor granularity: full cache line (64 bytes)                      â•‘
â•‘   - Monitor invalidated by:                                              â•‘
â•‘       * Any store to same cache line (local or remote)                   â•‘
â•‘       * Context switch                                                   â•‘
â•‘       * Exception                                                        â•‘
â•‘       * FENCE instruction                                                â•‘
â•‘   - SC succeeds only if monitor still valid                              â•‘
â•‘                                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Unaligned Access Policy (Performance-Optimized)
pgsql
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ UNALIGNED MEMORY ACCESS HANDLING                                         â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                          â•‘
â•‘ Policy: Hardware-assisted unaligned access (best performance)            â•‘
â•‘                                                                          â•‘
â•‘ Behavior:                                                                â•‘
â•‘   - Unaligned accesses are ALLOWED (no trap)                             â•‘
â•‘   - Hardware automatically handles crossing cache line boundaries        â•‘
â•‘   - Performance penalty:                                                 â•‘
â•‘       * Same cache line:     No penalty (1 cycle load-to-use)            â•‘
â•‘       * Cross cache line:    +4 cycles (two L1 accesses)                 â•‘
â•‘       * Cross page boundary: +8 cycles (two TLB lookups)                 â•‘
â•‘                                                                          â•‘
â•‘ Implementation:                                                          â•‘
â•‘   - Address Generation Unit detects unaligned access                     â•‘
â•‘   - If crosses cache line:                                               â•‘
â•‘       1. Issue first access (lower address)                              â•‘
â•‘       2. Issue second access (upper address)                             â•‘
â•‘       3. Merge results in load buffer                                    â•‘
â•‘   - Stores split similarly (two store buffer entries)                    â•‘
â•‘                                                                          â•‘
â•‘ Atomic Operations:                                                       â•‘
â•‘   - AMO/CAS/LL/SC REQUIRE natural alignment                              â•‘
â•‘   - Trap on misalignment for atomic ops (precise exception)              â•‘
â•‘   - Exception code: 0x06 (Store/AMO address misaligned)                  â•‘
â•‘                                                                          â•‘
â•‘ Recommendation:                                                          â•‘
â•‘   - Compilers should align data to natural boundaries for best perf      â•‘
â•‘   - Unaligned access useful for packed structures, network packets       â•‘
â•‘                                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Store-to-Load Forwarding
sql_more
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ STORE-TO-LOAD FORWARDING                                                 â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                          â•‘
â•‘ Scenario:                                                                â•‘
â•‘   ST.64 r10 â†’ [r20]        ; Store value                                 â•‘
â•‘   LD.64 [r20] â†’ r11        ; Load from same address                      â•‘
â•‘                                                                          â•‘
â•‘ Forwarding Behavior:                                                     â•‘
â•‘   - Store buffer entry checked on every load                             â•‘
â•‘   - If address matches and size compatible:                              â•‘
â•‘       * Forward data directly from store buffer                          â•‘
â•‘       * Latency: 4 cycles (normal) + 1 cycle (forwarding penalty)        â•‘
â•‘       * Total: 5 cycles load-to-use                                      â•‘
â•‘                                                                          â•‘
â•‘ Partial Overlap Handling:                                                â•‘
â•‘   Address ranges:                                                        â•‘
â•‘     Store: [A, A+N)                                                      â•‘
â•‘     Load:  [B, B+M)                                                      â•‘
â•‘                                                                          â•‘
â•‘   Case 1: Exact match (A == B, N == M)                                   â•‘
â•‘     â†’ Full forwarding, 5 cycles                                          â•‘
â•‘                                                                          â•‘
â•‘   Case 2: Load subset of store (B >= A, B+M <= A+N)                      â•‘
â•‘     â†’ Partial forwarding, extract bytes, 5 cycles                        â•‘
â•‘                                                                          â•‘
â•‘   Case 3: Partial overlap (complex)                                      â•‘
â•‘     â†’ Stall until store commits to cache, 8-15 cycles                    â•‘
â•‘                                                                          â•‘
â•‘   Case 4: No overlap                                                     â•‘
â•‘     â†’ Normal load from cache, 4 cycles                                   â•‘
â•‘                                                                          â•‘
â•‘ Store Buffer Organization:                                               â•‘
â•‘   - 64 entries, FIFO with coalescing                                     â•‘
â•‘   - Each entry: {address, data, size, valid}                             â•‘
â•‘   - Drained to cache in program order                                    â•‘
â•‘                                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”€ PIPELINE ARCHITECTURE
Superscalar Out-of-Order Pipeline (Performance-Optimized)
apache
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ SUPRAX Pipeline Stages (High-Performance Implementation)                â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                          â•‘
â•‘ Stage 1-2: FETCH                                                         â•‘
â•‘   â€¢ 16-byte fetch per cycle (1 instruction)                             â•‘
â•‘   â€¢ I-Cache access (64 KB, 8-way)                                       â•‘
â•‘   â€¢ Branch prediction (hybrid predictor)                                â•‘
â•‘   â€¢ Return address stack (64 entries)                                   â•‘
â•‘   â€¢ Branch target buffer (2K entries)                                   â•‘
â•‘   â€¢ Fetch buffer: 32 instructions                                       â•‘
â•‘                                                                          â•‘
â•‘ Stage 3-4: DECODE                                                        â•‘
â•‘   â€¢ Instruction decode (1 instruction/cycle)                            â•‘
â•‘   â€¢ Parallel ALU detection (DUAL/TRIPLE/QUAD)                           â•‘
â•‘   â€¢ Micro-op explosion:                                                 â•‘
â•‘       - DUAL    â†’ 2 Î¼Ops                                                â•‘
â•‘       - TRIPLE  â†’ 3 Î¼Ops                                                â•‘
â•‘       - QUAD    â†’ 4 Î¼Ops                                                â•‘
â•‘       - LDQUAD  â†’ 4 Î¼Ops                                                â•‘
â•‘   â€¢ Micro-op queue: 64 entries                                          â•‘
â•‘   â€¢ Decode width: up to 4 Î¼Ops/cycle                                    â•‘
â•‘                                                                          â•‘
â•‘ Stage 5-6: RENAME                                                        â•‘
â•‘   â€¢ Register renaming (256 arch â†’ 3072 physical)                        â•‘
â•‘   â€¢ Move elimination (zero-cycle MOV)                                   â•‘
â•‘   â€¢ Dependency tracking via physical registers                          â•‘
â•‘   â€¢ Free list management (3072 entries)                                 â•‘
â•‘   â€¢ Register Alias Table (RAT): 256 entries                             â•‘
â•‘   â€¢ Reorder buffer allocation (512 entries ROB)                         â•‘
â•‘   â€¢ Rename width: 4 Î¼Ops/cycle                                          â•‘
â•‘                                                                          â•‘
â•‘ Stage 7-8: DISPATCH                                                      â•‘
â•‘   â€¢ Reservation stations (96 total):                                    â•‘
â•‘     - 32 for integer ALU                                                â•‘
â•‘     - 24 for load/store                                                 â•‘
â•‘     - 16 for FP/SIMD                                                    â•‘
â•‘     - 12 for branch                                                     â•‘
â•‘     - 12 for misc (bit ops, atomic)                                     â•‘
â•‘   â€¢ Out-of-order issue to execution units                               â•‘
â•‘   â€¢ Wakeup and select logic (age-based priority)                        â•‘
â•‘   â€¢ Dispatch width: 8 Î¼Ops/cycle                                        â•‘
â•‘                                                                          â•‘
â•‘ Stage 9-14: EXECUTE (Multiple Parallel Units, Distributed Layout)       â•‘
â•‘   Integer Cluster (scattered for heat spreading):                       â•‘
â•‘     â€¢ 8Ã— Simple ALU units (1 cycle)                                     â•‘
â•‘         - Distributed across die: NW, NE, SW, SE quadrants Ã— 2          â•‘
â•‘         - Supports DUAL/TRIPLE/QUAD dispatch                            â•‘
â•‘     â€¢ 2Ã— Complex ALU (3 cycle MUL, 18 cycle DIV)                        â•‘
â•‘         - Placed near L2 cache slices                                   â•‘
â•‘     â€¢ 2Ã— Branch units                                                   â•‘
â•‘         - Near fetch unit for fast misprediction recovery               â•‘
â•‘                                                                          â•‘
â•‘   Load/Store Cluster:                                                   â•‘
â•‘     â€¢ 3Ã— AGU (Address Generation Units)                                 â•‘
â•‘     â€¢ 2Ã— Load ports (L1D access)                                        â•‘
â•‘     â€¢ 1Ã— Store port                                                     â•‘
â•‘     â€¢ Load/Store queue: 128 load + 64 store                             â•‘
â•‘                                                                          â•‘
â•‘   FP/SIMD Cluster (separate power domain):                              â•‘
â•‘     â€¢ 4Ã— FP ALU (FADD/FMUL, 4-5 cycle)                                  â•‘
â•‘     â€¢ 2Ã— FP FMA units (5 cycle)                                         â•‘
â•‘     â€¢ 1Ã— FP DIV/SQRT unit (15-28 cycle, not pipelined)                  â•‘
â•‘     â€¢ 2Ã— SIMD units (VALU, 1-3 cycle)                                   â•‘
â•‘                                                                          â•‘
â•‘   Misc Units:                                                           â•‘
â•‘     â€¢ 1Ã— Bit manipulation unit (POPCNT/CLZ/PDEP/PEXT)                   â•‘
â•‘     â€¢ 1Ã— Atomic unit (AMO/CAS/LL/SC serialization)                      â•‘
â•‘                                                                          â•‘
â•‘ Stage 15-16: WRITEBACK                                                   â•‘
â•‘   â€¢ Result forwarding network (fully bypassed)                          â•‘
â•‘   â€¢ Physical register file update                                       â•‘
â•‘   â€¢ Reorder buffer update (mark complete)                               â•‘
â•‘   â€¢ Exception status tracking                                           â•‘
â•‘   â€¢ Writeback width: 12 results/cycle                                   â•‘
â•‘                                                                          â•‘
â•‘ Stage 17: COMMIT/RETIRE                                                  â•‘
â•‘   â€¢ In-order commit (maintains precise exceptions)                      â•‘
â•‘   â€¢ Architectural register file update (conceptual, via rename)         â•‘
â•‘   â€¢ Free old physical registers                                         â•‘
â•‘   â€¢ Branch resolution and checkpoint release                            â•‘
â•‘   â€¢ Exception handling (flush pipeline on exception)                    â•‘
â•‘   â€¢ Commit width: 8 Î¼Ops/cycle                                          â•‘
â•‘                                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Pipeline Width and Throughput
apache
Fetch Width:        1 instruction/cycle (16 bytes)
Decode Width:       1 instruction â†’ up to 4 Î¼Ops/cycle
Rename Width:       4 Î¼Ops/cycle
Dispatch Width:     8 Î¼Ops/cycle (out-of-order)
Execute Width:      Up to 18 operations/cycle
                    (8 ALU + 2 complex + 2 LD + 1 ST + 4 FP + 1 branch)
Commit Width:       8 Î¼Ops/cycle (in-order)

Reorder Buffer:     512 entries
Physical Registers: 3072 (integer + FP unified)
Reservation Stations: 96 total
Load Queue:         128 entries
Store Queue:        64 entries (with coalescing)

Branch Prediction (Performance-Optimized)
apache
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ HYBRID BRANCH PREDICTOR                                                  â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                          â•‘
â•‘ TAGE Predictor (Tagged Geometric History Length):                       â•‘
â•‘   â€¢ 8 tables with increasing history lengths                            â•‘
â•‘   â€¢ History Lengths: 0, 2, 4, 8, 16, 32, 64, 128 branches               â•‘
â•‘   â€¢ Entries/Table: 4K entries (total 32K)                               â•‘
â•‘   â€¢ Tag Width: 9-12 bits (depends on table)                             â•‘
â•‘   â€¢ Counter Width: 3 bits (signed, -4 to +3)                            â•‘
â•‘   â€¢ Prediction: Longest matching history table wins                     â•‘
â•‘   â€¢ Accuracy: ~96-98%                                                   â•‘
â•‘                                                                          â•‘
â•‘ Perceptron Predictor (Neural Network):                                  â•‘
â•‘   â€¢ Perceptrons: 2048 perceptrons                                       â•‘
â•‘   â€¢ Weights: 64 weights per perceptron (8-bit signed)                   â•‘
â•‘   â€¢ History: 64-bit global history register                             â•‘
â•‘   â€¢ Training: Online learning on misprediction                          â•‘
â•‘   â€¢ Accuracy: ~97-99% (excels at correlated branches)                   â•‘
â•‘                                                                          â•‘
â•‘ Meta-Predictor (Selector):                                              â•‘
â•‘   â€¢ Function: Choose between TAGE and Perceptron                        â•‘
â•‘   â€¢ Entries: 4096 entries                                               â•‘
â•‘   â€¢ Counter Width: 2 bits per entry                                     â•‘
â•‘   â€¢ Tracks which predictor is more accurate per branch                  â•‘
â•‘                                                                          â•‘
â•‘ Branch Target Buffer (BTB):                                             â•‘
â•‘   â€¢ Entries: 2048 entries                                               â•‘
â•‘   â€¢ Associativity: 4-way set-associative                                â•‘
â•‘   â€¢ Each Entry:                                                         â•‘
â•‘       - Branch PC (tag, 40 bits)                                        â•‘
â•‘       - Target address (64 bits)                                        â•‘
â•‘       - Branch type (2 bits: cond/uncond/call/return)                   â•‘
â•‘   â€¢ Hit Rate: >99%                                                      â•‘
â•‘                                                                          â•‘
â•‘ Return Address Stack (RAS):                                             â•‘
â•‘   â€¢ Depth: 64 entries (circular buffer)                                 â•‘
â•‘   â€¢ Push: On CALL/CALLR                                                 â•‘
â•‘   â€¢ Pop: On RET                                                         â•‘
â•‘   â€¢ Prediction: Top-of-stack for RET target                             â•‘
â•‘   â€¢ Accuracy: >99.9%                                                    â•‘
â•‘                                                                          â•‘
â•‘ Indirect Branch Predictor:                                              â•‘
â•‘   â€¢ Entries: 1024 entries                                               â•‘
â•‘   â€¢ Hashing: PC + global history                                        â•‘
â•‘   â€¢ 4-way set-associative                                               â•‘
â•‘   â€¢ For JMPR, CALLR instructions                                        â•‘
â•‘                                                                          â•‘
â•‘ Branch Misprediction Recovery:                                          â•‘
â•‘   â€¢ Penalty: 15-18 cycles                                               â•‘
â•‘       - 3 cycles: Detect misprediction                                  â•‘
â•‘       - 3 cycles: Flush pipeline                                        â•‘
â•‘       - 4 cycles: Rollback rename state                                 â•‘
â•‘       - 3 cycles: Restart fetch from correct target                     â•‘
â•‘       - 2-5 cycles: Refill pipeline                                     â•‘
â•‘   â€¢ Checkpoint mechanism: 32 simultaneous checkpoints                   â•‘
â•‘   â€¢ Instant rollback on misprediction                                   â•‘
â•‘                                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš¡ PARALLEL ALU DISPATCH ARCHITECTURE
Micro-Dispatcher Design (Performance-Critical)
pgsql
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ PARALLEL ALU MICRO-DISPATCHER                                            â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                          â•‘
â•‘ DUAL Instruction (2 operations):                                        â•‘
â•‘   Decode Stage:                                                         â•‘
â•‘     â€¢ Crack into 2 micro-ops                                            â•‘
â•‘     â€¢ Î¼Op A: {opcode_A, Rs1_A, Rs2_A, Rd_A}                             â•‘
â•‘     â€¢ Î¼Op B: {opcode_B, Rs1_B, Rs2_B, Rd_B}                             â•‘
â•‘                                                                          â•‘
â•‘   Hazard Detection:                                                     â•‘
â•‘     â€¢ Check if Rd_A == Rd_B (destination conflict)                      â•‘
â•‘     â€¢ If conflict: TRAP (illegal instruction exception)                 â•‘
â•‘     â€¢ Check RAW hazards between A and B                                 â•‘
â•‘       - If B depends on A: serialize (A â†’ rename â†’ B)                   â•‘
â•‘       - Else: dispatch both in parallel                                 â•‘
â•‘                                                                          â•‘
â•‘   Dispatch:                                                             â•‘
â•‘     â€¢ Î¼Op A â†’ Reservation Station 0-31 (integer ALU pool)               â•‘
â•‘     â€¢ Î¼Op B â†’ Reservation Station 0-31 (integer ALU pool)               â•‘
â•‘     â€¢ Can dispatch to same RS or different RS                           â•‘
â•‘                                                                          â•‘
â•‘ TRIPLE Instruction (3 operations):                                      â•‘
â•‘   Decode Stage:                                                         â•‘
â•‘     â€¢ Crack into 3 micro-ops                                            â•‘
â•‘     â€¢ Î¼Op A, B, C with different opcodes                                â•‘
â•‘                                                                          â•‘
â•‘   Hazard Detection:                                                     â•‘
â•‘     â€¢ Check all pairwise destination conflicts:                         â•‘
â•‘       - Rd_A vs Rd_B, Rd_A vs Rd_C, Rd_B vs Rd_C                        â•‘
â•‘     â€¢ If any conflict: TRAP                                             â•‘
â•‘     â€¢ Build dependency graph: A â†’ B, A â†’ C, B â†’ C                       â•‘
â•‘     â€¢ Identify independent operations                                   â•‘
â•‘                                                                          â•‘
â•‘   Dispatch:                                                             â•‘
â•‘     â€¢ Independent ops: dispatch simultaneously                          â•‘
â•‘     â€¢ Dependent ops: dispatch with proper sequencing                    â•‘
â•‘       - Use ROB entry numbers to track dependencies                     â•‘
â•‘                                                                          â•‘
â•‘ QUAD Instruction (4 operations):                                        â•‘
â•‘   Decode Stage:                                                         â•‘
â•‘     â€¢ Crack into 4 micro-ops                                            â•‘
â•‘     â€¢ All 4 can have different opcodes (any combination)                â•‘
â•‘     â€¢ Î¼Op A, B, C, D                                                    â•‘
â•‘                                                                          â•‘
â•‘   Hazard Detection:                                                     â•‘
â•‘     â€¢ Check all 6 pairwise destination conflicts                        â•‘
â•‘     â€¢ Build full dependency DAG                                         â•‘
â•‘     â€¢ Critical path analysis (longest dependency chain)                 â•‘
â•‘                                                                          â•‘
â•‘   Dispatch:                                                             â•‘
â•‘     â€¢ Best case: all 4 independent â†’ dispatch in 1 cycle                â•‘
â•‘     â€¢ Worst case: chain dependency Aâ†’Bâ†’Câ†’D â†’ serialize                  â•‘
â•‘     â€¢ Typical case: 2-3 independent groups                              â•‘
â•‘                                                                          â•‘
â•‘   Execution:                                                            â•‘
â•‘     â€¢ 8 ALU units available                                             â•‘
â•‘     â€¢ 4 operations consume 4 ALUs                                       â•‘
â•‘     â€¢ Remaining 4 ALUs available for other instructions                 â•‘
â•‘                                                                          â•‘
â•‘ Destination Conflict Handling:                                          â•‘
â•‘   Example (ILLEGAL):                                                    â•‘
â•‘     QUAD [ADD r1,r2â†’r10] [SUB r3,r4â†’r10] [MUL r5,r6â†’r11] [AND r7,r8â†’r12]â•‘
â•‘            â†‘_____________________________â†‘                               â•‘
â•‘            Both write r10 - CONFLICT!                                   â•‘
â•‘                                                                          â•‘
â•‘   Action:                                                               â•‘
â•‘     â€¢ Decoder detects conflict at decode stage                          â•‘
â•‘     â€¢ Raise illegal instruction exception                               â•‘
â•‘     â€¢ MCAUSE = 0x02 (illegal instruction)                               â•‘
â•‘     â€¢ MTVAL = PC of QUAD instruction                                    â•‘
â•‘     â€¢ Software must fix code (compiler error or hand-written asm bug)   â•‘
â•‘                                                                          â•‘
â•‘ Performance Benefits:                                                   â•‘
â•‘   â€¢ DUAL:   2Ã— instruction throughput (2 ops in 128 bits)               â•‘
â•‘   â€¢ TRIPLE: 3Ã— instruction throughput (3 ops in 128 bits)               â•‘
â•‘   â€¢ QUAD:   4Ã— instruction throughput (4 ops in 128 bits)               â•‘
â•‘   â€¢ Reduces fetch bandwidth pressure                                    â•‘
â•‘   â€¢ Reduces decode bandwidth pressure                                   â•‘
â•‘   â€¢ Better code density for parallel workloads                          â•‘
â•‘                                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ALU Physical Distribution (Heat Spreading)
apache
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ ALU PHYSICAL LAYOUT ON DIE (Thermal Optimization)                       â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                          â•‘
â•‘ Die Organization (conceptual quadrants):                                â•‘
â•‘                                                                          â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â•‘
â•‘   â”‚  NW Quadrant          â”‚          NE Quadrant            â”‚           â•‘
â•‘   â”‚                       â”‚                                 â”‚           â•‘
â•‘   â”‚  â€¢ ALU 0 (Simple)     â”‚  â€¢ ALU 2 (Simple)               â”‚           â•‘
â•‘   â”‚  â€¢ FP ALU 0           â”‚  â€¢ FP ALU 1                     â”‚           â•‘
â•‘   â”‚  â€¢ L2 Cache Slice 0-3 â”‚  â€¢ L2 Cache Slice 4-7           â”‚           â•‘
â•‘   â”‚  â€¢ Branch Unit 0      â”‚  â€¢ Load Port 0                  â”‚           â•‘
â•‘   â”‚                       â”‚                                 â”‚           â•‘
â•‘   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â•‘
â•‘   â”‚                       â”‚                                 â”‚           â•‘
â•‘   â”‚  SW Quadrant          â”‚          SE Quadrant            â”‚           â•‘
â•‘   â”‚                       â”‚                                 â”‚           â•‘
â•‘   â”‚  â€¢ ALU 1 (Simple)     â”‚  â€¢ ALU 3 (Simple)               â”‚           â•‘
â•‘   â”‚  â€¢ Complex ALU 0 (MUL)â”‚  â€¢ Complex ALU 1 (MUL)          â”‚           â•‘
â•‘   â”‚  â€¢ L2 Cache Slice 8-11â”‚  â€¢ L2 Cache Slice 12-15         â”‚           â•‘
â•‘   â”‚  â€¢ Store Port         â”‚  â€¢ Load Port 1                  â”‚           â•‘
â•‘   â”‚                       â”‚                                 â”‚           â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â•‘
â•‘                                                                          â•‘
â•‘ Center:                                                                  â•‘
â•‘   â€¢ ALU 4, 5, 6, 7 (Simple, distributed around center)                  â•‘
â•‘   â€¢ Rename/ROB logic (centralized)                                      â•‘
â•‘   â€¢ Reservation stations (distributed near execution units)             â•‘
â•‘   â€¢ L3 cache controller                                                 â•‘
â•‘                                                                          â•‘
â•‘ Benefits:                                                                â•‘
â•‘   â€¢ Heat generation distributed across die                              â•‘
â•‘   â€¢ Avoids hotspots (all ALUs in one area â†’ thermal throttling)         â•‘
â•‘   â€¢ Shorter wiring for result forwarding (local clustering)             â•‘
â•‘   â€¢ Better power delivery (spread VRM load)                             â•‘
â•‘   â€¢ Enables higher clock speeds (better thermal headroom)               â•‘
â•‘                                                                          â•‘
â•‘ Interconnect:                                                            â•‘
â•‘   â€¢ Result forwarding network: mesh topology                            â•‘
â•‘   â€¢ Latency: 1 cycle for adjacent quadrants, 2 cycles diagonal          â•‘
â•‘   â€¢ Bandwidth: 256 bytes/cycle (aggregate)                              â•‘
â•‘                                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”’ EXCEPTION AND INTERRUPT HANDLING
Exception Priority (Hardware Implementation)
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ EXCEPTION PRIORITY TABLE                                                 â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                          â•‘
â•‘ Priority 1 (Highest): Reset                                             â•‘
â•‘   - Synchronous, always taken                                           â•‘
â•‘   - Entire processor state reinitialized                                â•‘
â•‘                                                                          â•‘
â•‘ Priority 2: Debug/Breakpoint (if enabled)                               â•‘
â•‘   - BREAK instruction                                                   â•‘
â•‘   - Hardware breakpoint match                                           â•‘
â•‘                                                                          â•‘
â•‘ Priority 3: Machine Check / NMI                                         â•‘
â•‘   - Cache parity error                                                  â•‘
â•‘   - Memory parity error                                                 â•‘
â•‘   - Bus error                                                           â•‘
â•‘                                                                          â•‘
â•‘ Priority 4: Instruction Address Misaligned                              â•‘
â•‘   - PC not 16-byte aligned                                              â•‘
â•‘   - Checked at fetch stage                                              â•‘
â•‘                                                                          â•‘
â•‘ Priority 5: Instruction Access Fault                                    â•‘
â•‘   - TLB miss (after page walk fails)                                    â•‘
â•‘   - Protection violation                                                â•‘
â•‘   - I-Cache ECC error                                                   â•‘
â•‘                                                                          â•‘
â•‘ Priority 6: Illegal Instruction                                         â•‘
â•‘   - Invalid opcode                                                      â•‘
â•‘   - Reserved encoding                                                   â•‘
â•‘   - DUAL/TRIPLE/QUAD with destination conflicts                         â•‘
â•‘   - Unimplemented instruction                                           â•‘
â•‘                                                                          â•‘
â•‘ Priority 7: Instruction Page Fault                                      â•‘
â•‘   - Page not present                                                    â•‘
â•‘   - Access violation (execute permission)                               â•‘
â•‘                                                                          â•‘
â•‘ Priority 8: Load Address Misaligned                                     â•‘
â•‘   - Only for atomic operations (AMO/CAS/LL/SC)                          â•‘
â•‘   - Regular loads handle unaligned in hardware                          â•‘
â•‘                                                                          â•‘
â•‘ Priority 9: Load Access Fault                                           â•‘
â•‘   - TLB miss (after page walk fails)                                    â•‘
â•‘   - Protection violation                                                â•‘
â•‘   - D-Cache ECC error                                                   â•‘
â•‘                                                                          â•‘
â•‘ Priority 10: Load Page Fault                                            â•‘
â•‘   - Page not present                                                    â•‘
â•‘   - Access violation (read permission)                                  â•‘
â•‘                                                                          â•‘
â•‘ Priority 11: Store/AMO Address Misaligned                               â•‘
â•‘   - Only for atomic operations                                          â•‘
â•‘   - Regular stores handle unaligned in hardware                         â•‘
â•‘                                                                          â•‘
â•‘ Priority 12: Store/AMO Access Fault                                     â•‘
â•‘   - TLB miss (after page walk fails)                                    â•‘
â•‘   - Protection violation                                                â•‘
â•‘   - D-Cache ECC error                                                   â•‘
â•‘                                                                          â•‘
â•‘ Priority 13: Store/AMO Page Fault                                       â•‘
â•‘   - Page not present                                                    â•‘
â•‘   - Access violation (write permission)                                 â•‘
â•‘   - Copy-on-write page                                                  â•‘
â•‘                                                                          â•‘
â•‘ Priority 14: Environment Call                                           â•‘
â•‘   - SYSCALL instruction                                                 â•‘
â•‘   - Intentional trap                                                    â•‘
â•‘                                                                          â•‘
â•‘ Priority 15 (Lowest): Asynchronous Interrupts                           â•‘
â•‘   - Timer interrupt                                                     â•‘
â•‘   - External interrupt (devices)                                        â•‘
â•‘   - Software interrupt (IPI)                                            â•‘
â•‘   - Only taken at instruction boundaries                                â•‘
â•‘                                                                          â•‘
â•‘ Multiple Exceptions on Same Instruction:                                â•‘
â•‘   - Highest priority exception taken                                    â•‘
â•‘   - Example: LOAD with misaligned address AND page fault                â•‘
â•‘     â†’ Take priority 8 (Load Address Misaligned) first                   â•‘
â•‘     â†’ After fix, retry instruction, then take priority 10 (Page Fault)  â•‘
â•‘                                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Exception Handling Mechanism
sql_more
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ EXCEPTION HANDLING SEQUENCE                                              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                          â•‘
â•‘ 1. Exception Detection:                                                 â•‘
â•‘    - Fetch stage: instruction address misaligned, access fault          â•‘
â•‘    - Decode stage: illegal instruction                                  â•‘
â•‘    - Execute stage: page fault, arithmetic exceptions                   â•‘
â•‘    - Memory stage: load/store faults                                    â•‘
â•‘    - Asynchronous: interrupts (any time)                                â•‘
â•‘                                                                          â•‘
â•‘ 2. Pipeline Flush:                                                      â•‘
â•‘    - Squash all younger instructions (preserve precise state)           â•‘
â•‘    - Wait for older instructions to complete/commit                     â•‘
â•‘    - Drain store buffer (ensure memory state consistent)                â•‘
â•‘    - Flush TLB if page fault (SFENCE.VMA implicit)                      â•‘
â•‘                                                                          â•‘
â•‘ 3. Save Architectural State:                                            â•‘
â•‘    MEPC    = PC of faulting instruction                                 â•‘
â•‘    MCAUSE  = exception code | (interrupt ? 0x8000000000000000 : 0)      â•‘
â•‘    MTVAL   = exception-specific value:                                  â•‘
â•‘                - Faulting address (page fault, access fault)            â•‘
â•‘                - Instruction bits (illegal instruction)                 â•‘
â•‘                - 0 (other exceptions)                                   â•‘
â•‘    MSTATUS.MPIE = MSTATUS.MIE (save interrupt enable)                   â•‘
â•‘    MSTATUS.MIE  = 0 (disable interrupts)                                â•‘
â•‘    MSTATUS.MPP  = current_privilege (save privilege level)              â•‘
â•‘                                                                          â•‘
â•‘ 4. Enter Handler:                                                       â•‘
â•‘    privilege_mode = MACHINE (or delegated mode if MEDELEG set)          â•‘
â•‘    PC = MTVEC.BASE + (MTVEC.MODE==1 ? MCAUSE*4 : 0)                     â•‘
â•‘                                                                          â•‘
â•‘ 5. Handler Execution:                                                   â•‘
â•‘    - Read MCAUSE to determine exception type                            â•‘
â•‘    - Read MEPC for faulting PC                                          â•‘
â•‘    - Read MTVAL for additional info                                     â•‘
â•‘    - Handle exception (allocate page, emulate, kill process, etc.)      â•‘
â•‘    - Modify MEPC if needed (skip instruction, retry, etc.)              â•‘
â•‘                                                                          â•‘
â•‘ 6. Return (ERET instruction):                                           â•‘
â•‘    PC = MEPC                                                            â•‘
â•‘    privilege_mode = MSTATUS.MPP                                         â•‘
â•‘    MSTATUS.MIE = MSTATUS.MPIE                                           â•‘
â•‘    MSTATUS.MPIE = 1                                                     â•‘
â•‘    Resume execution                                                     â•‘
â•‘                                                                          â•‘
â•‘ Latency:                                                                â•‘
â•‘   - Exception detection to handler entry: 20-30 cycles                  â•‘
â•‘   - Handler execution: variable (OS-dependent)                          â•‘
â•‘   - ERET to resumed execution: 15-20 cycles                             â•‘
â•‘   - Total minimum: ~50-100 cycles + handler time                        â•‘
â•‘                                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Precise Exceptions for DUAL/TRIPLE/QUAD
armasm
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ PRECISE EXCEPTIONS IN PARALLEL ALU OPERATIONS                            â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                          â•‘
â•‘ Challenge:                                                               â•‘
â•‘   QUAD [ADD r1,r2â†’r10] [DIV r3,r4â†’r11] [MUL r5,r6â†’r12] [AND r7,r8â†’r13]  â•‘
â•‘          â†‘__________op A    â†‘__________op B     â†‘_________op C    â†‘__op Dâ•‘
â•‘                                                                          â•‘
â•‘   - Op A completes in 1 cycle                                           â•‘
â•‘   - Op C completes in 3 cycles                                          â•‘
â•‘   - Op B takes 18 cycles, may fault (divide by zero at cycle 18)        â•‘
â•‘   - Op D completes in 1 cycle                                           â•‘
â•‘                                                                          â•‘
â•‘ Problem:                                                                 â•‘
â•‘   - Which results should be committed if Op B faults?                   â•‘
â•‘   - Must maintain precise exception semantics                           â•‘
â•‘                                                                          â•‘
â•‘ Solution (Hardware Implementation):                                     â•‘
â•‘                                                                          â•‘
â•‘   1. ROB Entry Allocation:                                              â•‘
â•‘      - QUAD cracks into 4 Î¼Ops                                          â•‘
â•‘      - All 4 Î¼Ops get consecutive ROB entries                           â•‘
â•‘      - ROB[N]   = Î¼Op A (ADD)                                           â•‘
â•‘      - ROB[N+1] = Î¼Op B (DIV)                                           â•‘
â•‘      - ROB[N+2] = Î¼Op C (MUL)                                           â•‘
â•‘      - ROB[N+3] = Î¼Op D (AND)                                           â•‘
â•‘                                                                          â•‘
â•‘   2. Execution:                                                         â•‘
â•‘      - All 4 Î¼Ops execute independently, out-of-order                   â•‘
â•‘      - Results written to physical registers immediately                â•‘
â•‘      - ROB entries marked "complete" when execution finishes            â•‘
â•‘                                                                          â•‘
â•‘   3. Exception Detection:                                               â•‘
â•‘      - Op B (DIV) raises exception at cycle 18                          â•‘
â•‘      - Exception recorded in ROB[N+1]                                   â•‘
â•‘      - ROB[N+1].exception = 1                                           â•‘
â•‘      - ROB[N+1].cause = DIVIDE_BY_ZERO                                  â•‘
â•‘                                                                          â•‘
â•‘   4. Commit (In-Order):                                                 â•‘
â•‘      - Commit proceeds in ROB order                                     â•‘
â•‘      - ROB[N]   (ADD): Commit r10 â† physical register âœ“                 â•‘
â•‘      - ROB[N+1] (DIV): Exception detected! â†’ STOP                       â•‘
â•‘                                                                          â•‘
â•‘      - Take exception:                                                  â•‘
â•‘          * MEPC = PC of QUAD instruction                                â•‘
â•‘          * MCAUSE = DIVIDE_BY_ZERO                                      â•‘
â•‘          * MTVAL = 0 (or Rs2 value)                                     â•‘
â•‘                                                                          â•‘
â•‘      - Flush ROB[N+1] through ROB[N+3]:                                 â•‘
â•‘          * Discard Op B's result (r11 not updated)                      â•‘
â•‘          * Discard Op C's result (r12 not updated, even though complete)â•‘
â•‘          * Discard Op D's result (r13 not updated)                      â•‘
â•‘                                                                          â•‘
â•‘      - Free physical registers allocated to r11, r12, r13               â•‘
â•‘                                                                          â•‘
â•‘   5. Architectural State:                                               â•‘
â•‘      - r10 updated (Op A committed)                                     â•‘
â•‘      - r11, r12, r13 unchanged (Ops B, C, D squashed)                   â•‘
â•‘      - PC points to QUAD instruction (can retry or skip)                â•‘
â•‘                                                                          â•‘
â•‘   6. Handler Decision:                                                  â•‘
â•‘      - Option 1: Kill process (divide by zero is fatal)                 â•‘
â•‘      - Option 2: Emulate DIV (if r4==0, set r11=0, skip QUAD)           â•‘
â•‘      - Option 3: Signal (deliver SIGFPE to user process)                â•‘
â•‘                                                                          â•‘
â•‘ Result:                                                                  â•‘
â•‘   - Precise exception: architectural state exactly at fault point       â•‘
â•‘   - All earlier operations committed (Op A)                             â•‘
â•‘   - All later operations squashed (Op B, C, D)                          â•‘
â•‘   - Can retry or resume correctly                                       â•‘
â•‘                                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ” CONTROL AND STATUS REGISTERS (CSRs)
CSR Address Map
crmsh
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ SUPRAX CSR MAP (12-bit address space, 0x000-0xFFF)                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                          â•‘
â•‘ 0x000-0x0FF: User-Mode CSRs (Unprivileged)                              â•‘
â•‘   0x000  USTATUS    User status register                                â•‘
â•‘   0x001  UIE        User interrupt enable                               â•‘
â•‘   0x002  UTVEC      User trap vector base                               â•‘
â•‘   0x004  USCRATCH   User scratch register                               â•‘
â•‘   0x005  UEPC       User exception PC                                   â•‘
â•‘   0x006  UCAUSE     User exception cause                                â•‘
â•‘   0x007  UTVAL      User trap value                                     â•‘
â•‘   0x008  UIP        User interrupt pending                              â•‘
â•‘   0x040  UCYCLE     User cycle counter (read-only shadow)               â•‘
â•‘   0x041  UTIME      User time counter (read-only shadow)                â•‘
â•‘   0x042  UINSTRET   User instructions retired (read-only shadow)        â•‘
â•‘   0x043-0x05F       User performance counters (29 counters)             â•‘
â•‘                                                                          â•‘
â•‘ 0x100-0x1FF: Supervisor-Mode CSRs                                       â•‘
â•‘   0x100  SSTATUS    Supervisor status                                   â•‘
â•‘   0x101  SIE        Supervisor interrupt enable                         â•‘
â•‘   0x102  STVEC      Supervisor trap vector base                         â•‘
â•‘   0x103  SCOUNTEREN Supervisor counter enable                           â•‘
â•‘   0x104  SSCRATCH   Supervisor scratch register                         â•‘
â•‘   0x105  SEPC       Supervisor exception PC                             â•‘
â•‘   0x106  SCAUSE     Supervisor exception cause                          â•‘
â•‘   0x107  STVAL      Supervisor trap value                               â•‘
â•‘   0x108  SIP        Supervisor interrupt pending                        â•‘
â•‘   0x180  SATP       Supervisor address translation/protection           â•‘
â•‘                                                                          â•‘
â•‘ 0x300-0x3FF: Machine-Mode CSRs (Highest Privilege)                      â•‘
â•‘   0x300  MSTATUS    Machine status                                      â•‘
â•‘   0x301  MISA       Machine ISA and extensions                          â•‘
â•‘   0x302  MEDELEG    Machine exception delegation                        â•‘
â•‘   0x303  MIDELEG    Machine interrupt delegation                        â•‘
â•‘   0x304  MIE        Machine interrupt enable                            â•‘
â•‘   0x305  MTVEC      Machine trap vector base                            â•‘
â•‘   0x306  MCOUNTEREN Machine counter enable                              â•‘
â•‘   0x320  MCOUNTINHIBIT  Counter inhibit register                        â•‘
â•‘   0x340  MSCRATCH   Machine scratch register                            â•‘
â•‘   0x341  MEPC       Machine exception PC                                â•‘
â•‘   0x342  MCAUSE     Machine exception cause                             â•‘
â•‘   0x343  MTVAL      Machine trap value                                  â•‘
â•‘   0x344  MIP        Machine interrupt pending                           â•‘
â•‘                                                                          â•‘
â•‘ 0x3A0-0x3BF: Physical Memory Protection (PMP)                           â•‘
â•‘   0x3A0  PMPCFG0    PMP configuration register 0                        â•‘
â•‘   0x3A1  PMPCFG1    PMP configuration register 1                        â•‘
â•‘   0x3A2  PMPCFG2    PMP configuration register 2                        â•‘
â•‘   0x3A3  PMPCFG3    PMP configuration register 3                        â•‘
â•‘   0x3B0  PMPADDR0   PMP address register 0                              â•‘
â•‘   0x3B1  PMPADDR1   PMP address register 1                              â•‘
â•‘   ...               (up to PMPADDR15)                                   â•‘
â•‘   0x3BF  PMPADDR15  PMP address register 15                             â•‘
â•‘                                                                          â•‘
â•‘ 0x7A0-0x7AF: Debug/Trace Registers                                      â•‘
â•‘   0x7A0  TSELECT    Trigger select                                      â•‘
â•‘   0x7A1  TDATA1     Trigger data 1                                      â•‘
â•‘   0x7A2  TDATA2     Trigger data 2                                      â•‘
â•‘   0x7A3  TDATA3     Trigger data 3                                      â•‘
â•‘                                                                          â•‘
â•‘ 0xB00-0xB1F: Machine Performance Counters                               â•‘
â•‘   0xB00  MCYCLE     Machine cycle counter                               â•‘
â•‘   0xB01  MTIME      Machine time counter                                â•‘
â•‘   0xB02  MINSTRET   Machine instructions retired                        â•‘
â•‘   0xB03-0xB1F       Machine hardware performance counters (29)          â•‘
â•‘                                                                          â•‘
â•‘ 0xC00-0xC1F: User-Readable Performance Counters (Shadows)               â•‘
â•‘   0xC00  CYCLE      Cycle counter (user read-only)                      â•‘
â•‘   0xC01  TIME       Time counter (user read-only)                       â•‘
â•‘   0xC02  INSTRET    Instructions retired (user read-only)               â•‘
â•‘   0xC03-0xC1F       User-readable performance counters                  â•‘
â•‘                                                                          â•‘
â•‘ 0xF00-0xF0F: Vendor-Specific CSRs                                       â•‘
â•‘   0xF00  VENDORID   Vendor identification                               â•‘
â•‘   0xF01  ARCHID     Architecture identification                         â•‘
â•‘   0xF02  IMPID      Implementation identification                       â•‘
â•‘   0xF03  HARTID     Hardware thread ID                                  â•‘
â•‘                                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Key CSR Specifications
MSTATUS (0x300) - Machine Status Register
apache
 63   62-38  37  36  35  34  33-32  31    30-23  22    21    20    19    18
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚ SD â”‚ res  â”‚SBEâ”‚MBEâ”‚resâ”‚SXLâ”‚ UXL â”‚TSR â”‚  res   â”‚TVM â”‚TW  â”‚TSR â”‚res â”‚MXR â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

 17   16-15  14-13  12-11  10-9   8     7     6     5     4     3     2-0
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚SUM â”‚ res â”‚ FS   â”‚  XS  â”‚ res â”‚MPIEâ”‚UBE â”‚SPIEâ”‚res â”‚UPIEâ”‚MIE â”‚SIE  â”‚UIE â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Fields:
  SD [63]:       State dirty (FS/XS modified)
  SBE [37]:      Supervisor big-endian (0=little, 1=big)
  MBE [36]:      Machine big-endian
  SXL [35:34]:   Supervisor XLEN (reserved, always 64)
  UXL [33:32]:   User XLEN (00=32, 01=64, 10=128, 11=reserved)
  TSR [30]:      Trap SRET
  TVM [20]:      Trap virtual memory (trap SATP writes)
  TW [21]:       Timeout wait (trap WFI)
  MXR [19]:      Make executable readable
  SUM [18]:      Supervisor user memory access
  FS [14:13]:    Floating-point state (00=off, 01=initial, 10=clean, 11=dirty)
  XS [12:11]:    Extension state
  MPIE [7]:      Machine prior interrupt enable
  UBE [6]:       User big-endian
  SPIE [5]:      Supervisor prior interrupt enable
  UPIE [4]:      User prior interrupt enable
  MIE [3]:       Machine interrupt enable (global)
  SIE [1]:       Supervisor interrupt enable
  UIE [0]:       User interrupt enable

MTVEC (0x305) - Machine Trap Vector Base
excel
 63                                    2  1-0
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”
â”‚          BASE (62 bits)              â”‚MODEâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜

Fields:
  BASE [63:2]:  Trap vector base address (16-byte aligned)
  MODE [1:0]:   Trap vector mode
                00 = Direct mode (all traps to BASE)
                01 = Vectored mode (interrupts to BASE + 4Ã—cause)
                10-11 = Reserved

MCAUSE (0x342) - Machine Cause Register
 63    62                                  0
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚INT â”‚        EXCEPTION CODE (63 bits)      â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Fields:
  INT [63]:           1 = Interrupt, 0 = Exception
  EXCEPTION CODE:     Exception/interrupt type (see exception table)

SATP (0x180) - Supervisor Address Translation and Protection
ini
 63-60   59-44      43-0
â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MODE â”‚   ASID   â”‚            PPN (Physical Page Number)      â”‚
â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Fields:
  MODE [63:60]:     Translation mode
                    0000 = Bare (no translation)
                    1000 = Sv39 (3-level page table, 39-bit VA)
                    1001 = Sv48 (4-level page table, 48-bit VA)
                    1010 = Sv57 (5-level page table, 57-bit VA)
                    1011-1111 = Reserved
  ASID [59:44]:     Address space identifier (16 bits)
  PPN [43:0]:       Physical page number of root page table

CSR Side Effects (Performance-Critical)
sql_more
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ CSR WRITE SIDE EFFECTS                                                   â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                          â•‘
â•‘ SATP (Page Table Base):                                                 â•‘
â•‘   Side Effects:                                                         â•‘
â•‘     â€¢ TLB flush required (all entries invalidated)                      â•‘
â•‘     â€¢ Pipeline flush (instruction fetch must restart)                   â•‘
â•‘     â€¢ Store buffer drain (ensure memory consistency)                    â•‘
â•‘   Performance Cost:                                                     â•‘
â•‘     â€¢ 50-100 cycles (TLB flush + pipeline restart)                      â•‘
â•‘   Optimization:                                                         â•‘
â•‘     â€¢ ASID change only: selective TLB invalidation (cheaper)            â•‘
â•‘     â€¢ ASID-based filtering: don't flush entries with different ASID     â•‘
â•‘                                                                          â•‘
â•‘ MSTATUS (Status Register):                                              â•‘
â•‘   Side Effects:                                                         â•‘
â•‘     â€¢ Privilege mode change: pipeline flush                             â•‘
â•‘     â€¢ Interrupt enable change: immediate effect (no flush)              â•‘
â•‘     â€¢ FP state change (FS field): no flush                              â•‘
â•‘   Performance Cost:                                                     â•‘
â•‘     â€¢ 10-20 cycles (if privilege change)                                â•‘
â•‘     â€¢ 0 cycles (if only interrupt enable change)                        â•‘
â•‘                                                                          â•‘
â•‘ MTVEC (Trap Vector):                                                     â•‘
â•‘   Side Effects:                                                         â•‘
â•‘     â€¢ None (only affects future exceptions)                             â•‘
â•‘   Performance Cost:                                                     â•‘
â•‘     â€¢ 0 cycles                                                          â•‘
â•‘                                                                          â•‘
â•‘ MIE/SIE (Interrupt Enable):                                             â•‘
â•‘   Side Effects:                                                         â•‘
â•‘     â€¢ Immediate effect on interrupt pending logic                       â•‘
â•‘     â€¢ May cause interrupt to be taken immediately                       â•‘
â•‘   Performance Cost:                                                     â•‘
â•‘     â€¢ 0 cycles (combinational logic)                                    â•‘
â•‘                                                                          â•‘
â•‘ Performance Counters (MCYCLE, MINSTRET, etc.):                          â•‘
â•‘   Side Effects:                                                         â•‘
â•‘     â€¢ None                                                              â•‘
â•‘   Performance Cost:                                                     â•‘
â•‘     â€¢ 0 cycles (write updates counter)                                  â•‘
â•‘                                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š PERFORMANCE CHARACTERISTICS
Instruction Throughput Summary
apache
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ INSTRUCTION CLASS          LATENCY    THROUGHPUT      UNITS              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Integer ALU (ADD/SUB/LOG)  1 cycle    8/cycle         8Ã— ALU             â•‘
â•‘ Integer MUL                3 cycles   2/cycle         2Ã— Complex ALU     â•‘
â•‘ Integer DIV                18 cycles  1/18 cycles     2Ã— Complex ALU     â•‘
â•‘ Branch                     1 cycle    2/cycle         2Ã— Branch          â•‘
â•‘ Load (L1 hit)              4 cycles   2/cycle         2Ã— Load Port       â•‘
â•‘ Store                      1 cycle    1/cycle         1Ã— Store Port      â•‘
â•‘ FP ADD/SUB                 4 cycles   4/cycle         4Ã— FP ALU          â•‘
â•‘ FP MUL                     5 cycles   4/cycle         4Ã— FP ALU          â•‘
â•‘ FP FMA                     5 cycles   2/cycle         2Ã— FP FMA          â•‘
â•‘ FP DIV (SP/DP)             15/23 cyc  1/15-23 cyc     1Ã— FP DIV          â•‘
â•‘ FP SQRT (SP/DP)            18/28 cyc  1/18-28 cyc     1Ã— FP DIV          â•‘
â•‘ SIMD (VALU)                1-3 cycles 2-16 el/cycle   2Ã— SIMD            â•‘
â•‘ Atomic (AMO/CAS)           20-50 cyc  serialized      Memory Controller  â•‘
â•‘ BIT (POPCNT/CLZ)           2-3 cycles 1/cycle         1Ã— BIT             â•‘
â•‘ DUAL                       max(A,B)   2 ops/cycle     Multiple           â•‘
â•‘ TRIPLE                     max(A,B,C) 3 ops/cycle     Multiple           â•‘
â•‘ QUAD                       max(A,B,C,D) 4 ops/cycle   Multiple           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Peak Performance Metrics
apache
Assumptions: 4 GHz clock, perfect ILP, no cache misses

Integer Operations:
  Simple ALU:         32 GOPS (8 units Ã— 4 GHz)
  Multiply:           8 GMUL/s (2 units Ã— 4 GHz)
  DUAL Throughput:    8 GOPS (2 ops Ã— 4 GHz)
  TRIPLE Throughput:  12 GOPS (3 ops Ã— 4 GHz)
  QUAD Throughput:    16 GOPS (4 ops Ã— 4 GHz)

Floating-Point:
  FP ADD/SUB:         16 GFLOPS (4 units Ã— 4 GHz)
  FP MUL:             16 GFLOPS (4 units Ã— 4 GHz)
  FP FMA:             32 GFLOPS (2 units Ã— 2 ops Ã— 4 GHz)
  Combined FMA:       64 GFLOPS (32 mul + 32 add)

Memory:
  L1 Load Bandwidth:  64 GB/s (2 loads Ã— 8 bytes Ã— 4 GHz)
  L1 Store Bandwidth: 32 GB/s (1 store Ã— 8 bytes Ã— 4 GHz)
  Total L1 Bandwidth: 96 GB/s

Vector/SIMD (8-bit elements):
  VALU Throughput:    128 GOPS (2 units Ã— 8 elements Ã— 4 GHz)
